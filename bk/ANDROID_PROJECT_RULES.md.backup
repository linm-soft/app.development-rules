# Android Project Rules & Best Practices

> Quy táº¯c chung cho táº¥t cáº£ Android Native Java projects. DÃ¹ng lÃ m reference cho AI Assistant.

---

## ğŸ¤– Instructions for AI Assistant

### ğŸ“– Important Note for Users

> **ğŸ’¡ Best Practice:** TrÆ°á»›c khi yÃªu cáº§u review, hÃ£y má»Ÿ file review trÆ°á»›c Ä‘á»ƒ xem AI Ä‘ang lÃ m gÃ¬:
> 
> **CÃ¡c file cáº§n má»Ÿ:**
> - `docs/review/review-baseline.md` - Xem rules nÃ o Ä‘Ã£ PASS á»•n Ä‘á»‹nh
> - `docs/review/changes/review-YYYY-MM-DD.md` - Xem review session gáº§n nháº¥t
> - `.ai-progress/{app_id}_progress.md` - Xem progress tracking (náº¿u cÃ³)
> 
> **Lá»£i Ã­ch:**
> - âœ… Tháº¥y Ä‘Æ°á»£c AI Ä‘ang follow process hay khÃ´ng
> - âœ… Tháº¥y Ä‘Æ°á»£c TODO tasks vÃ  progress
> - âœ… Tháº¥y Ä‘Æ°á»£c comparison tables (Previous vs Current)
> - âœ… Tháº¥y Ä‘Æ°á»£c issues Ä‘Ã£ fix vÃ  chÆ°a fix
> - âœ… CÃ³ thá»ƒ scroll theo realtime khi AI Ä‘ang update
> 
> **CÃ¡ch má»Ÿ:**
> 1. Má»Ÿ VS Code Explorer (Ctrl+Shift+E)
> 2. Navigate Ä‘áº¿n folder `docs/review/`
> 3. Má»Ÿ file `review-baseline.md` vÃ  file má»›i nháº¥t trong `changes/`
> 4. Split editor (Ctrl+\\) Ä‘á»ƒ xem cáº£ 2 files cÃ¹ng lÃºc
> 5. Khi AI update, VS Code sáº½ auto-reload vÃ  báº¡n tháº¥y changes realtime

---

### ğŸ”„ AI Context Independence

âš ï¸ **CRITICAL: AI MUST be stateless and history-independent**

Khi user trigger review workflow, AI PHáº¢I:

**âœ… DO (LuÃ´n lÃ m):**
- Read review files (`docs/review/`) - ÄÃ¢y lÃ  source of truth
- Read progress files (`.ai-progress/`) - Current state tracking
- Read project files directly - Check actual code state
- Trust documentation over chat history
- Generate fresh TODO list based on current files

**âŒ DON'T (KhÃ´ng lÃ m):**
- Rely on chat history to know what was done before
- Assume issues still exist based on previous chat
- Skip reading review files because "I remember"
- Use cached knowledge from earlier in conversation
- Assume progress based on what user said earlier

**Why this matters:**
1. âœ… **Portable sessions** - User cÃ³ thá»ƒ copy project, má»Ÿ chat má»›i, váº«n work
2. âœ… **Team collaboration** - Developer A lÃ m xong, Developer B continue
3. âœ… **History independence** - KhÃ´ng cáº§n scroll chat cÅ© Ä‘á»ƒ hiá»ƒu context
4. âœ… **Fresh start** - Má»—i review session lÃ  independent, khÃ´ng bá»‹ bias
5. âœ… **File-based truth** - Files are source of truth, not conversation

**Example scenario:**
```
User: "review all"

AI WRONG âŒ:
  "I remember we fixed hardcoded strings yesterday, so I'll skip that check"

AI CORRECT âœ…:
  1. Read docs/review/review-baseline.md â†’ See "Hardcoded Strings: âœ… PASS"
  2. User said "review all" â†’ Re-check anyway (full re-review)
  3. Run detection â†’ Verify still PASS
  4. Generate comparison table showing â¡ï¸ UNCHANGED
```

**Implementation:**
- Every review starts with: Read baseline â†’ Read latest changes â†’ Fresh scan
- Never say "based on our previous conversation"
- Always say "based on review files" or "based on current code"
- Trust files, not memory

---

### ğŸ’¬ Recommended User Commands (for AI to recognize)

Khi user muá»‘n trigger review workflow, recommend cÃ¡c commands sau:

| User Command | AI Response | TODO Created? |
|--------------|-------------|---------------|
| `review` (alone) | Show VS Code Quick Pick menu with all rules, let user select from dropdown | âŒ NO (just showing menu) |
| `review app` | Full compliance review | âœ… YES |
| `review all` | Full re-review with comparison | âœ… YES |
| `check compliance` | Check against all rules | âœ… YES |
| `review rule file` / `review this rule` / `review rule` | **ALWAYS ask first (never assume):** "Báº¡n muá»‘n review file rules nhÆ° tháº¿ nÃ o? (structure/completeness/clarity/examples/formatting/consistency/etc.)" | âŒ NO (clarification only) |
| `add rule vÃ o file` / `add rule` / `add this rule to file` | Check chat history for context, if unclear â†’ ask user "Báº¡n muá»‘n add rule hay pháº§n gÃ¬ vÃ o?" | âš ï¸ Depends on complexity |
| `review [rule name]` | Review specific rule only | âš ï¸ If multi-step |
| `fix [issue]` | Fix specific issue | âš ï¸ If multi-step |
| `implement [feature]` | Implement new feature | âœ… YES |
| `check code quality` | Run quality checks | âœ… YES |

**Example user commands AI should recognize:**
- âœ… "review app theo ANDROID_PROJECT_RULES"
- âœ… "check compliance vá»›i rules"
- âœ… "review all vÃ  compare vá»›i baseline"
- âœ… "review hardcoded strings"
- âœ… "check xem cÃ³ issue gÃ¬ khÃ´ng"
- âœ… "implement MainProfile fragment"

**What AI should do when seeing these commands:**

| Command Pattern | AI Action | Behavior |
|-----------------|-----------|----------|
| `review app` / `check compliance` | Smart review | Skip baseline rules, check only pending/new rules |
| `review all` / `full review` / `re-review` | Full re-review | Check ALL rules, compare with previous, show improvements |
| `review [specific rule]` | Targeted review | Check only that specific rule |
| `fix [issue]` | Fix only | Fix specific issue, no full review |

**âš ï¸ FIRST RESPONSE - AI MUST Announce Review Mode:**

Khi user trigger báº¥t ká»³ review command nÃ o, AI PHáº¢I respond ngay:

```
ğŸ“‹ TÃ´i Ä‘ang sá»­ dá»¥ng file "ANDROID_PROJECT_RULES.md" review vá»›i mode:
   â€¢ User Command: [command user vá»«a gÃµ]
   â€¢ AI Response: [loáº¡i response tÆ°Æ¡ng á»©ng tá»« báº£ng trÃªn]
   â€¢ Workflow: [Step 1 â†’ Step N theo detailed actions]

Báº¯t Ä‘áº§u review...
```

**VÃ­ dá»¥:**
```
User: "review all"

AI Response:
ğŸ“‹ TÃ´i Ä‘ang sá»­ dá»¥ng file "ANDROID_PROJECT_RULES.md" review vá»›i mode:
   â€¢ User Command: review all
   â€¢ AI Response: Full re-review with comparison
   â€¢ Workflow: 10 steps (Create TODO â†’ Read baseline â†’ Execute full review â†’ Compare â†’ Confirm â†’ Fix â†’ Build â†’ Document)

Báº¯t Ä‘áº§u review...
[Tiáº¿p tá»¥c vá»›i Step 1]
```

---

**Detailed Actions:**

**1. For "review all" / "full review":**
```
Step 0: Announce review mode to user (see above)
Step 1: Create TODO list with full review tasks
Step 2: Read review-baseline.md (check ALL baseline rules again)
Step 3: Read latest changes/review-YYYY-MM-DD.md (get previous state)
Step 4: Execute FULL review (re-check even passed rules)
Step 5: Generate comparison table:
    | Rule | Previous | Current | Status | Change |
    |------|----------|---------|--------|--------|
    | Hardcoded Strings | âœ… PASS | âœ… PASS | â¡ï¸ UNCHANGED | - |
    | MainProfile | âŒ FAIL | âœ… PASS | âœ… IMPROVED | Implemented |
Step 6: Show all findings (even if no changes)
Step 7: Ask user confirmation
Step 8: Fix confirmed issues
Step 9: Build verification
Step 10: Create review documentation with comparison
        âš ï¸ FILE LOCATION RULES:
        âœ… ONLY create/update files in THE PROJECT BEING REVIEWED:
           - {project}/docs/review/review-baseline.md
           - {project}/docs/review/changes/review-YYYY-MM-DD.md
        âŒ NEVER create review files in:
           - development-rules/ (only contains ANDROID_PROJECT_RULES.md)
           - Other projects not being reviewed
           - Root workspace folder
```

**2. For "review app" / "check compliance":**
```
Step 0: Announce review mode to user (see above)
Step 1: Create TODO list
Step 2: Read review-baseline.md (SKIP these rules)
Step 3: Read latest changes/ file (check only pending/failed rules)
Step 4: Execute targeted review (skip passed rules)
Step 5: Show only new issues found
Step 6: Ask user confirmation
Step 7: Fix confirmed issues
Step 8: Build verification
Step 9: Update review documentation
        âš ï¸ FILE LOCATION: Same as Step 10 above - only in project being reviewed
```

**3. For "review [specific rule]":**
```
Step 0: Announce review mode to user (see above)
Step 1: Create TODO if multi-step
Step 2: Check only that specific rule
Step 3: Show findings
Step 4: Ask confirmation â†’ Fix â†’ Build â†’ Document
```

**âš ï¸ CRITICAL - After announcing mode (MUST DO IMMEDIATELY):**
1. âœ… **FIRST ACTION:** Create TODO list using `manage_todo_list` tool
2. âœ… Show TODO list to user (will appear in VS Code TODO panel)
3. âœ… Ask user to confirm before proceeding
4. âœ… Execute step by step, mark in-progress/completed as you work
5. âŒ **NEVER proceed without creating TODO first**

---

### Multi-step Work Management

âš ï¸ **CRITICAL: TODO Tasks are MANDATORY for review/fix workflows**

Khi lÃ m viá»‡c vá»›i file rules nÃ y, AI PHáº¢I:

1. **â­ Táº¡o TODO Tasks trÆ°á»›c khi báº¯t Ä‘áº§u (REQUIRED):**
   - âœ… **ALWAYS use `manage_todo_list` tool FIRST** khi user request:
     - "review app" / "check compliance" / "review all"
     - "fix [issue]" / "implement [feature]"
     - Any multi-step work (2+ steps)
   - âŒ **NEVER skip TODO creation** - Náº¿u skip, user khÃ´ng track Ä‘Æ°á»£c progress
   - Má»—i todo pháº£i rÃµ rÃ ng, cÃ³ thá»ƒ verify Ä‘Æ°á»£c
   - Mark todo as `in-progress` khi Ä‘ang lÃ m, `completed` ngay khi xong
   - GiÃºp AI vÃ  user track progress, Ä‘áº·c biá»‡t quan trá»ng khi cÃ³ rate limit

**TODO Format Template:**
```json
{
  "operation": "write",
  "todoList": [
    {"id": 1, "title": "Read existing progress/review files", "status": "not-started"},
    {"id": 2, "title": "Execute detection commands", "status": "not-started"},
    {"id": 3, "title": "Show findings to user for confirmation", "status": "not-started"},
    {"id": 4, "title": "Apply fixes after user confirms", "status": "not-started"},
    {"id": 5, "title": "Run build verification", "status": "not-started"},
    {"id": 6, "title": "Update review documentation", "status": "not-started"}
  ]
}
```

**Example TODO for Review Request:**
```
User: "review app"

AI MUST:
Step 1: Create TODO list immediately:
  â”œâ”€ 1. Read review baseline and last change file
  â”œâ”€ 2. Run compliance detection commands
  â”œâ”€ 3. Show all issues to user (wait for confirmation)
  â”œâ”€ 4. Fix confirmed issues
  â”œâ”€ 5. Run build verification (must pass)
  â””â”€ 6. Create/update review documentation

Step 2: Mark #1 as in-progress â†’ Read files
Step 3: Mark #1 as completed â†’ Update TODO
Step 4: Mark #2 as in-progress â†’ Run detection
...
```

2. **Táº¡o Progress Tracking File:**
   - Táº¡o file `progress-tracking/{app_id}_progress.md` Ä‘á»ƒ track implementation
   - File nÃ y lÆ°u:
     - App ID vÃ  tÃªn project
     - Danh sÃ¡ch rules Ä‘Ã£ implement
     - Danh sÃ¡ch rules Ä‘Ã£ review
     - Next steps khi tiáº¿p tá»¥c
   - Khi close/reopen session, AI cÃ³ thá»ƒ Ä‘á»c file nÃ y Ä‘á»ƒ biáº¿t Ä‘Ã£ lÃ m Ä‘áº¿n Ä‘Ã¢u

3. **Progress Tracking File Format:**
   ```markdown
   # Progress Tracking - {app_name}
   
   **App ID:** {app_id}
   **Project Path:** {project_path}
   **Last Updated:** {timestamp}
   **Session:** {session_description}
   
   ---
   
   ## Implementation Status
   
   ### âœ… Completed Rules
   - [x] Rule 1: App Profile - Developer info added
   - [x] Rule 5: Naming Conventions - All strings follow snake_case
   
   ### ğŸ”„ In Progress
   - [ ] Rule 9: Multi-language Support - Adding Vietnamese translations
   
   ### â³ Pending
   - [ ] Rule 13: Theme & Settings - Need to implement Dark mode
   - [ ] Rule 14: MainProfile Fragment - Need to create
   
   ---
   
   ## Review Status - Latest Session
   
   ### ğŸ“Š Review Summary Table
   
   | # | Rule/Check | Status | Previous | Current | Action Taken |
   |---|------------|--------|----------|---------|--------------|
   | 1 | Hardcoded Strings (Layout) | âœ… PASS | âŒ 8 issues | âœ… 0 issues | Fixed all 8 strings |
   | 2 | Hardcoded Strings (Java) | âœ… PASS | âŒ 1 issue | âœ… 0 issues | Fixed setText() |
   | 3 | Multi-language Support | âœ… PASS | - | âœ… EN + VI | No change needed |
   | 4 | Theme Support | âœ… PASS | - | âœ… Light/Dark | No change needed |
   | 5 | MainProfile Fragment | âŒ FAIL | âŒ Missing | âŒ Missing | Not yet implemented |
   | 6 | Hex Colors in Layouts | âœ… PASS | - | âœ… Clean | No change needed |
   
   ### ğŸ”§ Changes Made This Session
   
   | File | Type | Line | Before | After | Status |
   |------|------|------|--------|-------|--------|
   | `main_home.xml` | Layout | 30 | `android:text="Hello, User!"` | `android:text="@string/home_placeholder_hello"` | âœ… Fixed |
   | `main_home.xml` | Layout | 40 | `android:text="ğŸ”¥ 7 day streak"` | `android:text="@string/home_placeholder_streak"` | âœ… Fixed |
   | `PracticeHistoryAdapter.java` | Java | 84 | `setText("Practice Session")` | `setText(R.string.practice_session)` | âœ… Fixed |
   | `strings.xml` | Resource | - | - | Added 6 new strings | âœ… Added |
   | `strings.xml` (vi) | Resource | - | - | Added 6 translations | âœ… Added |
   
   ### âœ… Reviewed & Passed (No Changes Needed)
   
   | Check | Result | Details |
   |-------|--------|---------|
   | Multi-language | âœ… PASS | `values-vi/strings.xml` exists with full translations |
   | Theme Support | âœ… PASS | `values-night/` exists with themes.xml and colors.xml |
   | App Profile | âœ… PASS | BUILD_TIME field present in build.gradle |
   | Version Info | âœ… PASS | versionCode 1, versionName "1.0.0" |
   | Color Resources | âœ… PASS | All hex colors in color definition files (allowed) |
   | Dark Color Anti-pattern | âœ… PASS | No `*_dark` references in layouts |
   
   ### âš ï¸ Critical Issues Still Pending
   
   | # | Issue | Rule | Impact | Next Action |
   |---|-------|------|--------|-------------|
   | 1 | MainProfile Fragment Missing | Rule 14 (REQUIRED) | ğŸ”´ Critical | Need to implement using template |
   | 2 | Fragment Naming Pattern | Rule 5 (Naming) | ğŸŸ¡ Medium | Consider renaming or document exception |
   
   ---
   
   ## Compliance Score
   
   **Overall: 85% Compliant** (up from 70%)
   
   | Category | Previous | Current | Change |
   |----------|----------|---------|--------|
   | Code Quality | âŒ 60% | âœ… 100% | +40% â†‘ |
   | Multi-language | âœ… 100% | âœ… 100% | - |
   | Theme Support | âœ… 100% | âœ… 100% | - |
   | Required Screens | âŒ 0% | âŒ 0% | - (MainProfile still missing) |
   | Overall | 70% | 85% | +15% â†‘ |
   
   ---
   
   ## Next Steps (Priority Order)
   
   ### ğŸ”´ Critical - Must Fix
   1. **Create MainProfile Fragment**
      - Use template from Rule 14
      - Implement all required sections
      - Add to bottom navigation
   
   ### ğŸŸ¡ Medium Priority
   2. **Review Fragment Naming Convention**
      - Current: HomeFragment, LearnFragment
      - Expected: MainHome, MainLearn
      - Action: Rename or document exception
   ```

4. **Workflow khi báº¯t Ä‘áº§u lÃ m viá»‡c:**
   ```
   Step 1: Check if progress file exists
       â”œâ”€ YES â†’ Read progress file
       â”‚        â”œâ”€ Kiá»ƒm tra "Review Status" section
       â”‚        â”œâ”€ Náº¿u cÃ³ "âš ï¸ Issues Found" â†’ CHá»ˆ review/fix nhá»¯ng issues Ä‘Ã³
       â”‚        â”œâ”€ Náº¿u cÃ³ "â³ Pending" rules â†’ Review nhá»¯ng rules Ä‘Ã³
       â”‚        â””â”€ KHÃ”NG cáº§n review láº¡i rules Ä‘Ã£ PASS (âœ… Reviewed & Passed)
       â”‚
       â””â”€ NO  â†’ Create new progress file
                â”œâ”€ Add .ai-progress/ to .gitignore
                â””â”€ Start full review tá»« Ä‘áº§u
   
   Step 2: Create/Update TODO list vá»›i tasks cáº§n lÃ m
       â”œâ”€ Náº¿u cÃ³ progress file â†’ TODO = Pending items + Issues to fix
       â””â”€ Náº¿u má»›i â†’ TODO = Full review checklist
   
   Step 3: Execute review/detection tasks
       â”œâ”€ Run detection commands
       â”œâ”€ Collect all issues found
       â””â”€ Generate comparison report (if re-review)
   
   Step 4: âš ï¸ ALWAYS ASK USER CONFIRMATION (CRITICAL)
       â”œâ”€ Show ALL issues found (numbered list)
       â”œâ”€ Show comparison table (Previous vs Current if applicable)
       â”œâ”€ Ask user: "Would you like me to fix these issues?"
       â”œâ”€ Wait for user response:
       â”‚   â”œâ”€ "yes" / "fix all" â†’ Fix all issues
       â”‚   â”œâ”€ "skip X,Y" â†’ Fix all except issues X and Y
       â”‚   â”œâ”€ "fix X" â†’ Only fix issue X
       â”‚   â””â”€ "no" / "cancel" â†’ Don't fix anything
       â””â”€ âŒ NEVER auto-fix without user confirmation
   
   Step 5: Execute fixes (after user confirms)
       â”œâ”€ Fix confirmed issues only
       â”œâ”€ Mark as completed
       â””â”€ Re-verify fixes
   
   Step 6: âš ï¸ BUILD VERIFICATION (REQUIRED - MUST PASS)
       â”œâ”€ Run build command: `.\gradlew assembleDebug` or `.\build-apk.bat`
       â”œâ”€ Check for compilation errors
       â”œâ”€ If build FAILS:
       â”‚   â”œâ”€ Analyze error messages
       â”‚   â”œâ”€ Fix compilation errors (missing imports, syntax errors, etc.)
       â”‚   â”œâ”€ Re-run build until SUCCESS
       â”‚   â””â”€ âŒ DO NOT proceed to Step 7 if build fails
       â””â”€ If build SUCCESS:
           â”œâ”€ âœ… Mark as "Build Verified"
           â””â”€ Proceed to Step 7
   
   Step 7: âš ï¸ CREATE REVIEW DOCUMENTATION (REQUIRED)
       â”œâ”€ âœ… MUST create `docs/review/` folder structure:
       â”‚   â”œâ”€ docs/review/review-baseline.md (if not exists)
       â”‚   â””â”€ docs/review/changes/review-YYYY-MM-DD.md (always)
       â”œâ”€ Update review-baseline.md with stable rules
       â”œâ”€ Create/Update today's review-YYYY-MM-DD.md with:
       â”‚   â”œâ”€ Review Reference Tracking table
       â”‚   â”œâ”€ Comparison table (Previous vs Current)
       â”‚   â”œâ”€ Issues Summary Table
       â”‚   â”œâ”€ Files Modified Table
       â”‚   â”œâ”€ Expandable Issue Details
       â”‚   â””â”€ End of Day Summary
       â”œâ”€ Add "Build Status: âœ… PASSED" to documentation
       â”œâ”€ Update progress file (.ai-progress/)
       â””â”€ âŒ NEVER skip review documentation creation
   ```

5. **Smart Review Strategy (Quan trá»ng Ä‘á»ƒ tiáº¿t kiá»‡m thá»i gian):**
   
   | TÃ¬nh huá»‘ng | HÃ nh Ä‘á»™ng | LÃ½ do |
   |------------|-----------|-------|
   | Progress file cÃ³ âœ… "No hardcoded strings" | âŒ KHÃ”NG re-scan | ÄÃ£ verify rá»“i |
   | Progress file cÃ³ âš ï¸ "MainProfile missing" | âœ… CHá»ˆ check MainProfile | Focus vÃ o issue cá»¥ thá»ƒ |
   | Progress file cÃ³ â³ "Theme not checked" | âœ… CHá»ˆ review Theme rules | ChÆ°a review |
   | User request "review all" explicitly | âœ… Full review + Show comparison | User yÃªu cáº§u |
   | User request "fix X" | âœ… CHá»ˆ fix X | Targeted fix |
   
   **NguyÃªn táº¯c:** 
   - âœ… **TIN TÆ¯á»NG progress file** - Náº¿u Ä‘Ã£ PASS thÃ¬ khÃ´ng cáº§n check láº¡i
   - âš ï¸ **CHá»ˆ focus vÃ o issues** - Tiáº¿t kiá»‡m thá»i gian vÃ  token
   - ğŸ”„ **Full review chá»‰ khi:** User yÃªu cáº§u hoáº·c khÃ´ng cÃ³ progress file

6. **Full Re-review Protocol (Khi user request "review all"):**
   
   **Khi user yÃªu cáº§u review láº¡i toÃ n bá»™:**
   
   ```
   Step 1: Read existing progress file (if exists)
       â”œâ”€ Ghi nhá»› previous review results
       â””â”€ LÆ°u compliance score cÅ©
   
   Step 2: Execute full review again
       â”œâ”€ Scan táº¥t cáº£ rules tá»« Ä‘áº§u
       â”œâ”€ Detect issues hiá»‡n táº¡i
       â””â”€ Compare vá»›i previous results
   
   Step 3: Generate comparison report
       â”œâ”€ Show Previous vs Current state
       â”œâ”€ Highlight improvements (âœ… Fixed)
       â”œâ”€ Highlight regressions (âŒ New issues)
       â””â”€ Show unchanged items (â¡ï¸ Same)
   
   Step 4: Update progress file with comparison tables
   ```
   
   **Report Format cho Full Re-review:**
   
   ```markdown
   ## ğŸ”„ Full Re-review Results
   
   **Previous Review:** {date}
   **Current Review:** {date}
   
   ### ğŸ“Š Comparison Summary
   
   | Check | Previous Result | Current Result | Status | Change |
   |-------|-----------------|----------------|--------|--------|
   | Hardcoded Strings (Layout) | âŒ 8 issues | âœ… 0 issues | âœ… IMPROVED | Fixed all 8 |
   | Hardcoded Strings (Java) | âŒ 1 issue | âœ… 0 issues | âœ… IMPROVED | Fixed 1 |
   | Multi-language Support | âœ… PASS | âœ… PASS | â¡ï¸ UNCHANGED | Still good |
   | Theme Support | âœ… PASS | âœ… PASS | â¡ï¸ UNCHANGED | Still good |
   | MainProfile Fragment | âŒ Missing | âŒ Missing | â¡ï¸ UNCHANGED | Still missing |
   | Hex Colors in Layouts | âœ… Clean | âœ… Clean | â¡ï¸ UNCHANGED | Still clean |
   
   ### âœ… Improvements Made
   
   | Item | Before | After | Impact |
   |------|--------|-------|--------|
   | Hardcoded strings | 9 total | 0 total | +100% compliance |
   | Code quality score | 60% | 100% | +40% |
   
   ### â¡ï¸ No Changes
   
   | Item | Status | Note |
   |------|--------|------|
   | Multi-language | âœ… PASS | EN + VI still present |
   | Theme support | âœ… PASS | Light/Dark still working |
   
   ### âš ï¸ Still Pending
   
   | Item | Status | Note |
   |------|--------|------|
   | MainProfile Fragment | âŒ FAIL | Still not implemented |
   
   ### ğŸ“ˆ Compliance Score Trend
   
   | Date | Score | Change |
   |------|-------|--------|
   | 2025-12-10 | 70% | - |
   | 2025-12-11 | 85% | +15% â†‘ |
   
   **Conclusion:** Code quality improved significantly. MainProfile still needs implementation.
   ```
   
   **Icons for Status:**
   - âœ… IMPROVED - Issue fixed, thay Ä‘á»•i tÃ­ch cá»±c
   - âŒ REGRESSION - CÃ³ issue má»›i, thay Ä‘á»•i tiÃªu cá»±c
   - â¡ï¸ UNCHANGED - KhÃ´ng thay Ä‘á»•i (PASS váº«n PASS, FAIL váº«n FAIL)
   - ğŸ”„ PARTIAL - Má»™t pháº§n Ä‘Ã£ fix, má»™t pháº§n chÆ°a

7. **Khi gáº·p Rate Limit:**
   - Ngay láº­p tá»©c update progress file vá»›i status hiá»‡n táº¡i
   - Ghi rÃµ next step Ä‘á»ƒ AI session tiáº¿p theo biáº¿t lÃ m gÃ¬
   - Commit/save progress file trÆ°á»›c khi káº¿t thÃºc

6. **Progress File Location:**
   - Path: `{project_root}/.ai-progress/{app_id}_progress.md`
   - VÃ­ dá»¥: `d:\MyRepo\AI-App\Android.App\daily-speak\.ai-progress\dailyspeak_progress.md`
   - **QUAN TRá»ŒNG:** File nÃ y PHáº¢I Ä‘Æ°á»£c git ignore Ä‘á»ƒ khÃ´ng bá»‹ track bá»Ÿi Git
   
   **âš ï¸ BÆ¯á»šC Báº®T BUá»˜C khi táº¡o progress file:**
   ```
   Step 1: Check if .gitignore exists in project root
       â””â”€ If not â†’ Create new .gitignore file
   
   Step 2: Read .gitignore content
       â””â”€ Check if ".ai-progress/" pattern exists
   
   Step 3: If NOT found â†’ Add to .gitignore
       â””â”€ Append these lines:
           
           # AI Progress Tracking (local only, not for version control)
           .ai-progress/
   
   Step 4: Create .ai-progress directory
   
   Step 5: Create progress file
   ```
   
   **Why this is CRITICAL:**
   - âœ… Progress files stay local only (not committed to Git)
   - âœ… No Git conflicts between team members
   - âœ… AI can update freely without user "keep/undo" prompts
   - âœ… Clean repository (no internal AI tracking files)
   - âœ… Each developer has their own progress tracking
   
   **Pattern to use in .gitignore:**
   - âœ… Correct: `.ai-progress/` (with trailing slash)
   - âŒ Wrong: `.ai-progress` (without slash - might match files)
   - âŒ Wrong: `*/.ai-progress/` (too specific)

7. **âš ï¸ Review Documentation (REQUIRED - History-Based Reference System):**
   
   > âœ… **MANDATORY:** ALWAYS create `docs/review/` structure after any review session
   > âŒ **NEVER SKIP:** Review documentation is NOT optional
   
   **File Structure (REQUIRED):**
   ```
   docs/review/
   â”œâ”€â”€ review-baseline.md          # âš ï¸ REQUIRED - Common rules that ALWAYS PASS
   â””â”€â”€ changes/                    # âš ï¸ REQUIRED - Daily change logs folder
       â”œâ”€â”€ review-2024-12-11.md    # Changes on Dec 11 (consolidated)
       â”œâ”€â”€ review-2024-12-12.md    # Changes on Dec 12
       â””â”€â”€ review-2024-12-25.md    # Changes on Dec 25
   ```
   
   **File Roles:**
   
   **A. `review-baseline.md` (Master Reference - Always at Root)**
   - Contains ALL rules that consistently PASS
   - Updated when new rules become stable (pass in multiple reviews)
   - Always read FIRST to know what's already compliant
   - Prevents re-checking same passed rules
   
   **B. `changes/review-YYYY-MM-DD.md` (Daily Change Log)**
   - Contains ONLY changes/issues found on that specific date
   - Multiple reviews same day â†’ MERGE into single file (keep latest)
   - Each review session adds timestamp section within same file
   - Compare against LAST review file + baseline
   
   **Workflow for Review Session (MUST FOLLOW):**
   ```
   Step 1: Read review-baseline.md (if exists)
       â””â”€ Know which rules already PASS (skip these)
   
   Step 2: Find latest review file in changes/ (if exists)
       â””â”€ Sort by date: review-2024-12-11.md < review-2024-12-25.md
       â””â”€ This is "Previous State" for comparison
   
   Step 3: Perform new review
       â””â”€ Check ONLY rules NOT in baseline
       â””â”€ Find issues/changes
   
   Step 4: Compare with Previous State
       â””â”€ Show table: Previous vs Current (âœ… IMPROVED, âŒ REGRESSION, â¡ï¸ UNCHANGED)
   
   Step 5: User confirms â†’ Fix issues
   
   Step 6: âš ï¸ CREATE/UPDATE REVIEW FILES (REQUIRED - NEVER SKIP)
       â”œâ”€ âœ… MUST create docs/review/ folder if not exists
       â”œâ”€ âœ… MUST create changes/ subfolder if not exists
       â”œâ”€ Create/Update review file for TODAY:
       â”‚   â””â”€ File: docs/review/changes/review-{TODAY}.md
       â”‚   â””â”€ If already exists today â†’ ADD new section with timestamp
       â”‚   â””â”€ If first review today â†’ CREATE new file
       â”œâ”€ Create review-baseline.md if not exists (first review)
       â””â”€ âŒ NEVER skip this step - Documentation is MANDATORY
   
   Step 7: Update baseline if rules stabilize
       â””â”€ If rule PASSED in last 3+ reviews â†’ Move to baseline
   ```
   
   **File Format: `review-baseline.md`**
   ```markdown
   # Review Baseline - {App Name}
   
   > ğŸ’¡ **Tip:** Press `Ctrl+Shift+V` in VS Code to view this file in Preview Mode for better readability.
   
   **Last Updated:** YYYY-MM-DD
   **Compliance Score:** XX%
   
   > This file contains rules that CONSISTENTLY PASS.
   > Only check these rules if modifying related code.
   
   ## âœ… Stable Compliant Rules - Table View
   
   | # | Rule Category | Status | Key Files | Last Verified | Pass Count | Notes |
   |---|---------------|--------|-----------|---------------|------------|-------|
   | 1 | App Profile | âœ… PASS | MainProfile.java, main_profile.xml | 2024-12-11 | 3 | Fragment complete with all sections |
   | 2 | Bottom Navigation | âœ… PASS | MainActivity.java, bottom_navigation_menu.xml | 2024-12-11 | 3 | 5 tabs configured |
   | 3 | Theme System | âœ… PASS | themes.xml, themes.xml (night), colors.xml | 2024-12-11 | 3 | Light & Dark modes |
   | 4 | Multi-language | âœ… PASS | strings.xml, strings.xml (vi) | 2024-12-11 | 3 | EN + VI complete |
   | 5 | Naming Conventions | âœ… PASS | Main*.java files | 2024-12-11 | 3 | All fragments follow Main* pattern |
   | 6 | Project Structure | âœ… PASS | build.gradle, .gitignore | 2024-12-11 | 3 | Gradle config compliant |
   
   ## ğŸ“‹ Rules to Check in Next Review
   
   | # | Rule Category | Reason to Check | Priority |
   |---|---------------|-----------------|----------|
   | 1 | Permissions Handling | New permissions may be added | Medium |
   | 2 | Dialog Implementation | New dialogs may be created | Low |
   | 3 | Hardcoded Strings | New code may introduce hardcoded text | High |
   | 4 | Resource Organization | New drawables/layouts added | Medium |
   
   ## ğŸ“Š Compliance History Tracking
   
   | Date | Compliance Score | Rules Passed | Rules Failed | Notes |
   |------|------------------|--------------|--------------|-------|
   | 2024-12-11 | 100% | 6 | 0 | First review - all baseline established |
   
   ```
   
   **File Format: `changes/review-YYYY-MM-DD.md`**
   ```markdown
   # Review Changes - {App Name}
   
   > ğŸ’¡ **Tip:** Press `Ctrl+Shift+V` in VS Code to view this file in Preview Mode for better readability.
   
   **Date:** YYYY-MM-DD
   **Previous Review:** review-2024-12-10.md (or "None - First Review")
   
   ---
   
   ## ğŸ“‹ Review Reference Tracking
   
   | Item | Reference | Last Updated | Notes |
   |------|-----------|--------------|-------|
   | **Baseline File** | review-baseline.md | YYYY-MM-DD | Current baseline version used |
   | **Previous Change File** | review-2024-12-10.md (or "None") | YYYY-MM-DD | Last change file compared against |
   | **Comparison Source** | Baseline + Last Change | - | Combined comparison for accuracy |
   
   ---
   
   ## ğŸ• Review Session 1 - 14:30
   **Triggered by:** User request "review app"
   **Compliance Score:** 85% â†’ 90% (+5%)
   
   ### Comparison with Baseline & Previous Review
   
   | Rule Category | Baseline Status | Previous Review | Current Review | Status | Action Taken | Files Modified |
   |---------------|-----------------|-----------------|----------------|--------|--------------|----------------|
   | Hardcoded Strings | âœ… In baseline | âœ… PASS | âŒ FAIL | âŒ REGRESSION | Fixed | MainActivity.java, strings.xml |
   | Resource Naming | Not in baseline | âš ï¸ PARTIAL | âœ… PASS | âœ… IMPROVED | Renamed files | 3 layout files |
   | MainProfile | âœ… In baseline | âœ… PASS | âœ… PASS | â¡ï¸ UNCHANGED | - | - |
   | Theme System | âœ… In baseline | âœ… PASS | âœ… PASS | â¡ï¸ UNCHANGED | - | - |
   
   ### Issues Found & Fixed (Summary Table)
   
   | # | Issue Title | Severity | Category | Location | Status | Files Modified Count |
   |---|-------------|----------|----------|----------|--------|---------------------|
   | 1 | Hardcoded "Hello World" string | Medium | Multi-language | MainActivity.java:45 | âœ… FIXED | 2 files |
   | 2 | Missing string resource | Low | Multi-language | LoginActivity.java:89 | âœ… FIXED | 2 files |
   
   ### Files Modified in This Session
   
   | File Path | Type | Change Description | Lines Changed | Related Issue |
   |-----------|------|-------------------|---------------|---------------|
   | app/src/main/java/.../MainActivity.java | Java | Fixed hardcoded string | 1 | Issue #1 |
   | app/src/main/res/values/strings.xml | Resource | Added hello_world string | 1 | Issue #1 |
   | app/src/main/java/.../LoginActivity.java | Java | Fixed hardcoded string | 1 | Issue #2 |
   | app/src/main/res/values-vi/strings.xml | Resource | Added VI translation | 1 | Issue #2 |
   
   ### Issue Details (Expandable)
   
   <details>
   <summary><b>Issue #1: Hardcoded "Hello World" string</b> - âœ… FIXED</summary>
   
   **Problem:**
   - Hardcoded string "Hello World" found in MainActivity.java line 45
   - Violates multi-language support rule
   
   **Solution:**
   - Created string resource `hello_world` in strings.xml
   - Replaced hardcoded text with `getString(R.string.hello_world)`
   - Added Vietnamese translation
   
   **Files Modified:**
   - `MainActivity.java` - Line 45
   - `strings.xml` - Added new string
   - `strings-vi.xml` - Added translation
   
   **Verification:**
   - âœ… No compilation errors
   - âœ… String appears in both EN and VI
   
   </details>
   
   <details>
   <summary><b>Issue #2: Missing string resource</b> - âœ… FIXED</summary>
   
   **Problem:**
   - Guest user name hardcoded in LoginActivity
   
   **Solution:**
   - Added string resource and used getString()
   
   </details>
   
   ---
   
   ## ğŸ• Review Session 2 - 16:45
   **Triggered by:** User request "check themes"
   **Compliance Score:** 90% â†’ 95% (+5%)
   
   ### Comparison with Session 1 (Same Day)
   
   | Rule Category | Session 1 | Current | Status | Action Taken | Files Modified |
   |---------------|-----------|---------|--------|--------------|----------------|
   | Theme Colors | âŒ FAIL | âœ… PASS | âœ… IMPROVED | Fixed attr usage | activity_main.xml |
   
   ### Issues Found & Fixed (Summary Table)
   
   | # | Issue Title | Severity | Category | Location | Status | Files Modified Count |
   |---|-------------|----------|----------|----------|--------|---------------------|
   | 1 | Hardcoded color in Button | Low | Theme System | activity_main.xml:23 | âœ… FIXED | 1 file |
   
   ### Files Modified in This Session
   
   | File Path | Type | Change Description | Lines Changed | Related Issue |
   |-----------|------|-------------------|---------------|---------------|
   | app/src/main/res/layout/activity_main.xml | Layout | Changed to theme attribute | 1 | Issue #1 |
   
   ### Issue Details (Expandable)
   
   <details>
   <summary><b>Issue #1: Hardcoded color in Button</b> - âœ… FIXED</summary>
   
   **Problem:**
   - Button using hardcoded color #FF6200EE instead of theme attribute
   - Will not adapt to dark mode
   
   **Solution:**
   - Changed to `?attr/colorPrimary`
   - Now respects theme colors
   
   **Files Modified:**
   - `activity_main.xml` - Line 23
   
   **Verification:**
   - âœ… Button color changes with theme
   
   </details>
   
   ---
   
   ## ğŸ“Š End of Day Summary
   
   **Performance Metrics:**
   | Metric | Value |
   |--------|-------|
   | Final Compliance Score | 95% |
   | Initial Score | 85% |
   | Improvement | +10% |
   | Total Sessions Today | 2 |
   | Total Issues Found | 3 |
   | Total Issues Fixed | 3 |
   | Total Time Spent | ~10 min |
   
   **Rules Ready for Baseline:**
   | Rule Category | Current Status | Pass Count | Ready? |
   |---------------|----------------|------------|--------|
   | Hardcoded Strings | âœ… PASS | 3 | âœ… YES |
   | Resource Naming | âœ… PASS | 2 | âš ï¸ Need 1 more |
   
   **Files Modified Today:**
   | File | Type | Changes | Lines Changed |
   |------|------|---------|---------------|
   | MainActivity.java | Code | Fixed hardcoded string | 1 |
   | strings.xml | Resource | Added 2 strings | 2 |
   | strings.xml (vi) | Resource | Added 2 translations | 2 |
   | activity_main.xml | Layout | Fixed color attribute | 1 |
   
   ```
   
   **Daily Merge Logic (Same Day):**
   - First review: Create `review-2024-12-11.md`
   - Second review same day: APPEND to `review-2024-12-11.md` with new timestamp section
   - Third review same day: APPEND again
   - End result: One file per day with multiple timestamped sections
   
   **Benefits:**
   - ğŸ“Š Historical tracking: See all changes over time
   - ğŸ¯ Baseline stability: Skip re-checking stable rules
   - ğŸ” Daily consolidation: All reviews in one file per day
   - âš¡ Fast comparison: Compare with last review only
   - ğŸ“ Timestamp precision: Know when each issue was found/fixed
   - âœ… Progressive compliance: Move stable rules to baseline

### Example Session Flow

```
==== Session 1: First Review Ever ====
User: "Review app compliance vá»›i ANDROID_PROJECT_RULES"

AI Actions:
1. Check docs/review/review-baseline.md â†’ NOT FOUND (first review)
2. Check docs/review/changes/ â†’ EMPTY
3. Add .ai-progress/ to .gitignore
4. Create progress file: .ai-progress/dailyspeak_progress.md
5. Perform FULL review of all rules
6. Find 3 issues:
   - âŒ MainProfile missing
   - âŒ 5 hardcoded strings
   - âœ… Theme OK
7. Show issues â†’ User confirms "fix all"
8. Fix all issues
9. CREATE review files:
   - docs/review/review-baseline.md (with Theme, Multi-language)
   - docs/review/changes/review-2024-12-11.md (with fixed issues)

==== Session 2: Same Day - Second Review ====
User: "check láº¡i xem cÃ³ issue gÃ¬ khÃ´ng"

AI Actions:
1. Read review-baseline.md â†’ Skip Theme, Multi-language (already PASS)
2. Read changes/review-2024-12-11.md â†’ Previous: MainProfile âœ…, Strings âœ…
3. Current time: 16:30 (same day: 2024-12-11)
4. Perform targeted review (skip baseline rules)
5. Find 1 new issue:
   - âŒ New hardcoded string in LoginActivity
6. Show issue â†’ User confirms
7. Fix issue
8. UPDATE same file: changes/review-2024-12-11.md
   - ADD new section "Review Session 2 - 16:30"
   - Keep Session 1 history
   - Update End of Day Summary

==== Session 3: Next Day Review ====
User: "review app" (2024-12-12)

AI Actions:
1. Read review-baseline.md â†’ Skip stable rules
2. Find latest review: changes/review-2024-12-11.md (yesterday)
3. Use 2024-12-11 as "Previous State"
4. Perform review
5. Compare: Current vs 2024-12-11
   | Rule | Previous | Current | Status |
   |------|----------|---------|--------|
   | Strings | âœ… | âŒ | âŒ REGRESSION |
   | MainProfile | âœ… | âœ… | â¡ï¸ UNCHANGED |
6. Show regression â†’ User confirms fix
7. Fix regression
8. CREATE NEW file: changes/review-2024-12-12.md
9. Check if rules ready for baseline:
   - Strings passed 3 times â†’ Move to baseline

==== Session 4: Weekly Review ====
User: "full review" (2024-12-18)

AI Actions:
1. Read review-baseline.md â†’ Now has 10 stable rules
2. Find latest: changes/review-2024-12-15.md
3. Skip all baseline rules (save time)
4. Check only non-baseline rules
5. All PASS â†’ No issues
6. CREATE changes/review-2024-12-18.md:
   - "No issues found"
   - "All non-baseline rules PASS"
   - Suggest: "Consider moving Rule X to baseline (passed 5 times)"
```

---

## ğŸ“‘ Má»¥c lá»¥c

1. [App Profile](#-app-profile)
2. [Project Structure](#-project-structure)
3. [Gradle Configuration](#-gradle-configuration)
4. [Build Setup & Debug](#-build-setup--debug)
5. [Naming Conventions](#-naming-conventions)
6. [Java Code Organization](#-java-code-organization)
7. [Resources Organization](#-resources-organization)
8. [File Splitting Rules](#-file-splitting-rules-nguyÃªn-táº¯c-tÃ¡ch-file)
9. [Multi-language Support](#-multi-language-support) âš ï¸ REQUIRED
10. [Dialog Rules](#-dialog-rules) âš ï¸ REQUIRED
11. [Permissions Handling](#-permissions-handling-rules)
12. [Bottom Navigation](#-bottom-navigation-rules) âš ï¸ REQUIRED
13. [Theme & Settings](#-theme--settings) âš ï¸ REQUIRED
14. [MainProfile Fragment - Complete Implementation](#-mainprofile-fragment---complete-implementation) âš ï¸ REQUIRED
15. [Code Review & Detection Guide](#-code-review--detection-guide) âš ï¸ REQUIRED
16. [Checklist cho AI](#-checklist-cho-ai)
17. [Quick Reference](#-quick-reference)
18. [LÆ°u Ã½ quan trá»ng cho AI](#ï¸-lÆ°u-Ã½-quan-trá»ng-cho-ai)

---

## ğŸ‘¤ App Profile

### Developer Information

| Field | Value |
|-------|-------|
| **Developer** | Linh.BoDinh |
| **Contact** | support@soft-linm.com |
| **Website** | [soft-linm.com](https://soft-linm.com) |

### Build Information

| Field | Source |
|-------|--------|
| **Version Name** | `versionName` in `app/build.gradle` |
| **Version Code** | `versionCode` in `app/build.gradle` |
| **Release Date** | Auto-generated from build time |

### Implementation trong Profile/About Screen

**1. ThÃªm vÃ o `build.gradle` (app level):**

```groovy
android {
    defaultConfig {
        // Add build time as config field
        buildConfigField "long", "BUILD_TIME", System.currentTimeMillis() + "L"
    }
}
```

**2. Strings resources:**

```xml
<!-- values/strings.xml -->
<string name="profile_developer">Developed by Linh.BoDinh</string>
<string name="profile_contact">Contact: support@soft-linm.com</string>
<string name="profile_website">Website: soft-linm.com</string>
<string name="profile_version">Version %s</string>
<string name="profile_release_date">Released: %s</string>

<!-- values-vi/strings.xml -->
<string name="profile_developer">PhÃ¡t triá»ƒn bá»Ÿi Linh.BoDinh</string>
<string name="profile_contact">LiÃªn há»‡: support@soft-linm.com</string>
<string name="profile_website">Website: soft-linm.com</string>
<string name="profile_version">PhiÃªn báº£n %s</string>
<string name="profile_release_date">NgÃ y phÃ¡t hÃ nh: %s</string>
```

**3. Java code Ä‘á»ƒ láº¥y thÃ´ng tin:**

```java
// Get version name
String versionName = BuildConfig.VERSION_NAME;

// Get build/release date
long buildTime = BuildConfig.BUILD_TIME;
String releaseDate = new SimpleDateFormat("dd/MM/yyyy", Locale.getDefault())
    .format(new Date(buildTime));

// Display
tvVersion.setText(getString(R.string.profile_version, versionName));
tvReleaseDate.setText(getString(R.string.profile_release_date, releaseDate));
tvDeveloper.setText(R.string.profile_developer);
tvContact.setText(R.string.profile_contact);
tvWebsite.setText(R.string.profile_website);

// Open website
tvWebsite.setOnClickListener(v -> {
    Intent intent = new Intent(Intent.ACTION_VIEW, 
        Uri.parse("https://soft-linm.com"));
    startActivity(intent);
});

// Send email
tvContact.setOnClickListener(v -> {
    Intent intent = new Intent(Intent.ACTION_SENDTO,
        Uri.parse("mailto:support@soft-linm.com"));
    startActivity(intent);
});
```

---

## ğŸ“ Project Structure

### Standard Layout

```
app-name/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ build.gradle                 # App-level dependencies
â”‚   â”œâ”€â”€ proguard-rules.pro           # ProGuard config
â”‚   â””â”€â”€ src/main/
â”‚       â”œâ”€â”€ AndroidManifest.xml      # App manifest
â”‚       â”œâ”€â”€ java/com/appname/        # Java source code
â”‚       â””â”€â”€ res/                     # Resources
â”œâ”€â”€ docs/                            # Documentation
â”‚   â””â”€â”€ dev/                         # Development guides
â”œâ”€â”€ gradle/                          # Gradle wrapper
â”œâ”€â”€ build.gradle                     # Project-level build
â”œâ”€â”€ settings.gradle                  # Project settings
â””â”€â”€ local.properties                 # Local SDK path
```

### Java Source Structure

```
app/src/main/java/com/appname/
â”‚
â”œâ”€â”€ ğŸ“± Activities (root folder)
â”‚   â”œâ”€â”€ MainActivity.java            # Main entry point
â”‚   â”œâ”€â”€ SettingsActivity.java        # Full-screen settings
â”‚   â””â”€â”€ [Feature]Activity.java       # Feature-specific screens
â”‚
â”œâ”€â”€ ğŸ§© Fragments (root folder) âš ï¸ REQUIRED
â”‚   â”œâ”€â”€ MainHome.java                # Home/Dashboard
â”‚   â”œâ”€â”€ MainProfile.java             # â­ REQUIRED - Profile/Settings/About screen
â”‚   â””â”€â”€ Main[Feature].java           # Feature-specific
â”‚
â”œâ”€â”€ ğŸ“Š Models (root or models/)
â”‚   â”œâ”€â”€ User.java                    # User model
â”‚   â””â”€â”€ [Entity].java                # Data models
â”‚
â”œâ”€â”€ ğŸ”Œ Adapters (root or adapters/)
â”‚   â”œâ”€â”€ [Entity]Adapter.java         # RecyclerView adapters
â”‚   â””â”€â”€ [Entity]ListAdapter.java     # List adapters
â”‚
â”œâ”€â”€ ğŸ› ï¸ Services (root folder)
â”‚   â”œâ”€â”€ [Feature]Service.java        # Background services
â”‚   â””â”€â”€ [Feature]Receiver.java       # Broadcast receivers
â”‚
â”œâ”€â”€ ğŸ’¾ Database (root folder)
â”‚   â””â”€â”€ DatabaseHelper.java          # SQLite helper
â”‚
â”œâ”€â”€ ğŸ”§ Utils (utils/)
â”‚   â”œâ”€â”€ DialogUtils.java             # Dialog utilities
â”‚   â”œâ”€â”€ DateUtils.java               # Date formatting
â”‚   â””â”€â”€ [Feature]Utils.java          # Feature utilities
â”‚
â””â”€â”€ ğŸ“¦ Helpers (root folder)
    â”œâ”€â”€ [Feature]Helper.java         # Feature helpers
    â””â”€â”€ NotificationHelper.java      # Notification management
```

### Resources Structure

```
res/
â”œâ”€â”€ drawable/                        # Vector drawables, shapes
â”‚   â”œâ”€â”€ ic_*.xml                     # Icons (24dp)
â”‚   â”œâ”€â”€ bg_*.xml                     # Backgrounds
â”‚   â””â”€â”€ selector_*.xml               # State selectors
â”‚
â”œâ”€â”€ layout/                          # Layout files
â”‚   â”œâ”€â”€ activity_*.xml               # Activity layouts
â”‚   â”œâ”€â”€ main_*.xml                   # Fragment layouts (main tabs)
â”‚   â”œâ”€â”€ dialog_*.xml                 # Dialog layouts
â”‚   â”œâ”€â”€ item_*.xml                   # List item layouts
â”‚   â””â”€â”€ view_*.xml                   # Custom view layouts
â”‚
â”œâ”€â”€ mipmap-*/                        # App icons
â”‚
â”œâ”€â”€ values/                          # Default resources
â”‚   â”œâ”€â”€ colors.xml                   # Color definitions
â”‚   â”œâ”€â”€ dimens.xml                   # Dimensions
â”‚   â”œâ”€â”€ strings.xml                  # Strings
â”‚   â”œâ”€â”€ styles.xml                   # Styles
â”‚   â””â”€â”€ themes.xml                   # App themes
â”‚
â””â”€â”€ values-vi/                       # Vietnamese translations
    â””â”€â”€ strings.xml
```

---

## ğŸ“‹ Naming Conventions

### File Naming

| Type | Pattern | Example |
|------|---------|---------|
| Activity | `[Feature]Activity.java` | `AlarmRingActivity.java` |
| Fragment | `Main[Feature].java` | `MainSchedule.java` |
| Adapter | `[Entity]Adapter.java` | `AlarmAdapter.java` |
| Service | `[Feature]Service.java` | `AlarmService.java` |
| Receiver | `[Feature]Receiver.java` | `BootReceiver.java` |
| Helper | `[Feature]Helper.java` | `AlarmHelper.java` |
| Model | `[Entity].java` | `Alarm.java` |
| Utils | `[Feature]Utils.java` | `DialogUtils.java` |

### Layout File Naming

| Type | Pattern | Example |
|------|---------|---------|
| Activity | `activity_[feature].xml` | `activity_alarm_ring.xml` |
| Fragment | `main_[feature].xml` | `main_schedule.xml` |
| Dialog | `dialog_[action].xml` | `dialog_add_alarm.xml` |
| List Item | `item_[entity].xml` | `item_alarm.xml` |
| Custom View | `view_[name].xml` | `view_time_picker.xml` |
| Include/Shared | `layout_[name].xml` | `layout_header.xml` |

### Resource Naming

| Type | Pattern | Example |
|------|---------|---------|
| Icons | `ic_[name]` | `ic_alarm`, `ic_settings` |
| Backgrounds | `bg_[name]` | `bg_button`, `bg_card` |
| Selectors | `selector_[name]` | `selector_day_toggle` |
| Colors | `[category]_[variant]` | `text_primary`, `button_danger` |
| Dimensions | `[type]_[size]` | `spacing_normal`, `text_size_large` |
| Strings | `[screen]_[element]` | `alarm_title`, `dialog_confirm` |
| Styles | `[Component].[Variant]` | `Button.Primary`, `Text.Title` |

### View ID Naming

| Component | Prefix | Example |
|-----------|--------|---------|
| Button | `btn` | `btnSave`, `btnCancel` |
| TextView | `tv` | `tvTitle`, `tvMessage` |
| EditText | `et` | `etName`, `etPhone` |
| ImageView | `iv` | `ivIcon`, `ivAvatar` |
| ImageButton | `btn` | `btnBack`, `btnDelete` |
| RecyclerView | `recycler` | `recyclerAlarms` |
| LinearLayout | `layout` | `layoutHeader` |
| CardView | `card` | `cardAlarm` |
| Switch/Toggle | `switch` / `toggle` | `switchEnabled`, `toggleMon` |
| CheckBox | `cb` | `cbVibrate` |
| SeekBar | `seek` | `seekVolume` |
| ProgressBar | `progress` | `progressLoading` |
| FloatingActionButton | `fab` | `fabAdd` |
| View (divider) | `divider` / `view` | `dividerTop` |
| Row/Container | `row` | `rowAlarmSound` |

---

## ğŸ”§ Build Setup & Debug

### Initial Project Build Setup

Khi setup build system cho project Android má»›i, thá»±c hiá»‡n theo thá»© tá»±:

#### 1. Gradle Configuration

**Copy build templates tá»« `development-rules/build/`:**

```bash
# Copy build scripts
cp development-rules/build/build-apk.bat project-name/
cp development-rules/build/build-release.bat project-name/
cp development-rules/build/build-bundle.bat project-name/
cp development-rules/build/export-source.ps1 project-name/
cp development-rules/build/get-version.ps1 project-name/
```

**Cáº­p nháº­t app name trong scripts:**

- `build-apk.bat`: Äá»•i "Smart Call Block" â†’ "Your App Name"
- `build-release.bat`: Äá»•i package/app name references
- `export-source.ps1`: Cáº­p nháº­t app name trong output filename

#### 2. Gradle Wrapper Setup

**Táº¡o/Copy Gradle wrapper tá»« shared-lib:**

```bash
# Copy wrapper files
cp -r shared-lib/gradle project-name/
```

**Táº¡o `gradlew.bat` vÃ  `gradlew`:**

Sá»­ dá»¥ng template Gradle wrapper standard hoáº·c copy tá»« project khÃ¡c.

**Cáº¥u hÃ¬nh `gradle-wrapper.properties`:**

```properties
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=file\:///C:/Users/<username>/AppData/Local/Temp/gradle-8.0-bin.zip
networkTimeout=10000
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
```

#### 3. Project Configuration Files

**Táº¡o `local.properties`:**

```properties
# Android SDK location
sdk.dir=C\:\\Android\\Sdk

# API Keys (náº¿u cáº§n)
GOOGLE_CLOUD_API_KEY=your_key_here
BILLING_PUBLIC_KEY=your_key_here
```

**Kiá»ƒm tra `gradle.properties`:**

```properties
# Optimize build
org.gradle.jvmargs=-Xmx4096m -Dfile.encoding=UTF-8
org.gradle.parallel=true
org.gradle.caching=true

# Android settings
android.useAndroidX=true
android.enableJetifier=true
android.nonTransitiveRClass=true
android.enableR8.fullMode=true

# KHÃ”NG dÃ¹ng deprecated options:
# android.enableBuildCache=true  âŒ Removed in AGP 7.0+
# org.gradle.jvmargs=-XX:MaxPermSize=1024m  âŒ Removed in Java 8+
```

#### 4. Build Configuration

**`build.gradle` (root level):**

```groovy
buildscript {
    repositories {
        google()
        mavenCentral()
    }
    dependencies {
        classpath 'com.android.tools.build:gradle:8.0.2'
        classpath 'com.google.gms:google-services:4.4.0'
    }
}

plugins {
    id 'com.android.application' version '8.0.2' apply false
}

task clean(type: Delete) {
    delete rootProject.buildDir
}
```

**`settings.gradle`:**

```groovy
pluginManagement {
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}

dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven { url 'https://jitpack.io' }
    }
}

rootProject.name = "YourAppName"
include ':app'
```

**âš ï¸ QUAN TRá»ŒNG:** Vá»›i `FAIL_ON_PROJECT_REPOS`, KHÃ”NG khai bÃ¡o repositories trong `build.gradle` (root), chá»‰ trong `settings.gradle`.

#### 5. Dependency Resolution

**Common conflicts cáº§n fix trong `app/build.gradle`:**

```groovy
configurations.all {
    resolutionStrategy {
        // Force Guava version for Android
        force 'com.google.guava:guava:32.1.1-android'
        
        // Force protobuf-javalite (not protobuf-java)
        force 'com.google.protobuf:protobuf-javalite:3.23.2'
    }
    
    // Exclude conflicting dependencies
    exclude group: 'com.google.guava', module: 'listenablefuture'
    exclude group: 'com.google.protobuf', module: 'protobuf-java'
}
```

**Exclude proto-common khi dÃ¹ng Firebase + Google Cloud:**

```groovy
implementation ('com.google.cloud:google-cloud-speech:4.14.0') {
    exclude group: 'com.google.api.grpc', module: 'proto-google-common-protos'
}
implementation ('com.google.cloud:google-cloud-texttospeech:2.22.0') {
    exclude group: 'com.google.api.grpc', module: 'proto-google-common-protos'
}
```

### Build Debugging Checklist

Khi build fail, debug theo thá»© tá»±:

#### 1. Gradle Version Issues

**Error:** `Minimum supported Gradle version is 8.2. Current version is 8.0`

**Fix:**
- Downgrade AGP to match Gradle: `classpath 'com.android.tools.build:gradle:8.0.2'`
- Hoáº·c upgrade Gradle: Edit `gradle-wrapper.properties` â†’ `gradle-8.2-bin.zip`

**Version compatibility:**
- Gradle 8.0 â†’ AGP 8.0.x
- Gradle 8.2 â†’ AGP 8.2.x
- Gradle 8.4+ â†’ AGP 8.3.x+

#### 2. Deprecated Options

**Error:** `The option 'android.enableBuildCache' is deprecated`

**Fix:** Remove from `gradle.properties`:
```properties
# âŒ Remove these:
android.enableBuildCache=true
org.gradle.jvmargs=-XX:MaxPermSize=1024m
```

#### 3. Repository Configuration

**Error:** `repository 'Google' was added by build file but repositoriesMode is set to FAIL_ON_PROJECT_REPOS`

**Fix:** Move repositories tá»« `build.gradle` sang `settings.gradle`:

```groovy
// âŒ WRONG - Trong build.gradle:
allprojects {
    repositories {
        google()
        mavenCentral()
    }
}

// âœ… CORRECT - Trong settings.gradle:
dependencyResolutionManagement {
    repositories {
        google()
        mavenCentral()
    }
}
```

#### 4. Dependency Conflicts

**Error:** `Duplicate class com.google.protobuf.*`

**Cause:** Conflict giá»¯a `protobuf-java` vÃ  `protobuf-javalite`

**Fix:**
```groovy
configurations.all {
    exclude group: 'com.google.protobuf', module: 'protobuf-java'
    resolutionStrategy.force 'com.google.protobuf:protobuf-javalite:3.23.2'
}
```

**Error:** `Cannot select module with conflict on capability 'com.google.guava:listenablefuture'`

**Fix:**
```groovy
configurations.all {
    exclude group: 'com.google.guava', module: 'listenablefuture'
    resolutionStrategy.force 'com.google.guava:guava:32.1.1-android'
}
```

**Error:** `2 files found with path 'META-INF/DEPENDENCIES'` hoáº·c `META-INF/INDEX.LIST`

**Cause:** Duplicate META-INF files tá»« nhiá»u dependencies (httpclient, httpcore, google-cloud libs)

**Fix:** ThÃªm packagingOptions trong `app/build.gradle`:
```groovy
android {
    // ... other configs
    
    packagingOptions {
        resources {
            excludes += [
                'META-INF/INDEX.LIST',
                'META-INF/DEPENDENCIES',
                'META-INF/LICENSE',
                'META-INF/LICENSE.txt',
                'META-INF/NOTICE',
                'META-INF/NOTICE.txt',
                'META-INF/*.SF',
                'META-INF/*.DSA',
                'META-INF/*.RSA'
            ]
        }
    }
}
```

#### 5. Missing Resources

**Error:** `resource xml/data_extraction_rules not found`

**Fix:** Remove tá»« AndroidManifest.xml náº¿u khÃ´ng dÃ¹ng:
```xml
<!-- Remove these if not needed: -->
android:dataExtractionRules="@xml/data_extraction_rules"
android:fullBackupContent="@xml/backup_rules"
```

**Error:** `resource mipmap/ic_launcher not found`

**Fix:** Táº¡o basic launcher icon:
```xml
<!-- res/mipmap-anydpi-v26/ic_launcher.xml -->
<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="108dp"
    android:height="108dp"
    android:viewportWidth="108"
    android:viewportHeight="108">
    <path
        android:fillColor="#3DDC84"
        android:pathData="M0,0h108v108h-108z" />
</vector>
```

#### 6. Missing SDK/Tools

**Error:** `SDK location not found`

**Fix:** Táº¡o `local.properties`:
```properties
sdk.dir=C\:\\Android\\Sdk
```

**Error:** `Android SDK Build-Tools 34 not found`

**Fix:** Gradle sáº½ tá»± Ä‘á»™ng download khi build láº§n Ä‘áº§u, hoáº·c cÃ i manual qua SDK Manager.

#### 7. Java Compilation Errors

**Error:** `cannot find symbol: method setDifficultyLevel(String)`

**Cause:** Code gá»i method khÃ´ng tá»“n táº¡i trong model class

**Fix:** Verify method names trong model vs usage:
```java
// Model has:
public void setDifficulty(String difficulty)

// Code calls: âŒ
topic.setDifficultyLevel("Beginner");

// Fix: âœ…
topic.setDifficulty("beginner");
```

**Common model mismatches:**
- `setDifficultyLevel()` â†’ `setDifficulty()`
- `setLessonCount()` â†’ `setTotalLessons()`
- `setDisplayOrder()` â†’ `setOrderIndex()`
- `setActive()` â†’ khÃ´ng cáº§n (field private/removed)
- `getScore()` â†’ `getOverallScore()`
- `getDifficultyLevel()` â†’ `getDifficulty()`
- `getLessonCount()` â†’ `getTotalLessons()`

**Error:** `exception IOException is never thrown in body of corresponding try statement`

**Cause:** Catch IOException nhÆ°ng method khÃ´ng throw IOException

**Fix:**
```java
// âŒ Wrong:
try {
    audioBuffer.write(buffer, 0, bytesRead);
} catch (IOException e) {
    Log.e(TAG, "Error", e);
}

// âœ… Correct:
try {
    audioBuffer.write(buffer, 0, bytesRead);
} catch (Exception e) {
    Log.e(TAG, "Error", e);
}
```

#### 8. Missing Strings

**Error:** `cannot find symbol: variable onboarding_1_title`

**Fix:** ThÃªm string resources:
```xml
<!-- values/strings.xml -->
<string name="onboarding_1_title">Title</string>
<string name="onboarding_1_description">Description</string>

<!-- values-vi/strings.xml -->
<string name="onboarding_1_title">TiÃªu Ä‘á»</string>
<string name="onboarding_1_description">MÃ´ táº£</string>
```

#### 9. Firebase/Google Services

**Error:** `File google-services.json is missing`

**Fix:** Táº¡o placeholder file:
```json
{
  "project_info": {
    "project_number": "000000000000",
    "project_id": "app-placeholder"
  },
  "client": [
    {
      "client_info": {
        "mobilesdk_app_id": "1:000000000000:android:0000000000000000",
        "android_client_info": {
          "package_name": "com.your.package"
        }
      },
      "oauth_client": [],
      "api_key": [{"current_key": "placeholder"}],
      "services": {"appinvite_service": {}}
    },
    {
      "client_info": {
        "mobilesdk_app_id": "1:000000000000:android:0000000000000001",
        "android_client_info": {
          "package_name": "com.your.package.debug"
        }
      },
      "oauth_client": [],
      "api_key": [{"current_key": "placeholder"}],
      "services": {"appinvite_service": {}}
    }
  ],
  "configuration_version": "1"
}
```

**âš ï¸ QUAN TRá»ŒNG:** Cáº§n 2 clients - má»™t cho release package, má»™t cho debug package (cÃ³ suffix `.debug`)

### Build Commands

```bash
# Debug build
./gradlew assembleDebug

# Release build (cáº§n keystore)
./gradlew assembleRelease

# Clean build
./gradlew clean assembleDebug

# Bundle for Play Store
./gradlew bundleRelease

# Check dependencies
./gradlew app:dependencies

# Verbose build
./gradlew assembleDebug --info

# Build with stacktrace
./gradlew assembleDebug --stacktrace
```

### Build Output Location

```
app/build/outputs/apk/
â”œâ”€â”€ debug/
â”‚   â””â”€â”€ app-debug.apk
â””â”€â”€ release/
    â””â”€â”€ app-release.apk

app/build/outputs/bundle/release/
â””â”€â”€ app-release.aab
```

---

## ğŸ”§ Gradle Configuration

### Gradle Wrapper - Sá»­ dá»¥ng Local Distribution

> âš ï¸ **QUAN TRá»ŒNG:** LuÃ´n sá»­ dá»¥ng local Gradle distribution Ä‘á»ƒ trÃ¡nh lá»—i SSL certificate khi build trÃªn máº¡ng cÃ´ng ty/proxy.

#### Váº¥n Ä‘á» vá»›i HTTPS Distribution

Khi sá»­ dá»¥ng URL HTTPS máº·c Ä‘á»‹nh, Gradle wrapper cÃ³ thá»ƒ gáº·p lá»—i SSL:

```
javax.net.ssl.SSLHandshakeException: PKIX path building failed
```

Äiá»u nÃ y thÆ°á»ng xáº£y ra do:
- Proxy/firewall cÃ´ng ty cháº·n SSL
- Certificate khÃ´ng Ä‘Æ°á»£c trust
- Máº¡ng cÃ³ SSL inspection

#### Giáº£i phÃ¡p: Sá»­ dá»¥ng Local File

**1. Download Gradle má»™t láº§n:**

Download file `gradle-8.0-bin.zip` tá»« [https://services.gradle.org/distributions/](https://services.gradle.org/distributions/) vÃ  lÆ°u vÃ o thÆ° má»¥c local:

```
C:\Users\<username>\AppData\Local\Temp\gradle-8.0-bin.zip
```

**2. Cáº¥u hÃ¬nh `gradle-wrapper.properties`:**

```properties
# gradle/wrapper/gradle-wrapper.properties

distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=file\:///C:/Users/<username>/AppData/Local/Temp/gradle-8.0-bin.zip
networkTimeout=10000
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
```

> **LÆ°u Ã½:** Thay `<username>` báº±ng username thá»±c táº¿.

**3. Kiá»ƒm tra hoáº¡t Ä‘á»™ng:**

```bash
./gradlew --version
```

#### Template cho Project Má»›i

Khi táº¡o project má»›i, luÃ´n cáº¥u hÃ¬nh `gradle-wrapper.properties` vá»›i local file:

```properties
distributionBase=GRADLE_USER_HOME
distributionPath=wrapper/dists
distributionUrl=file\:///C:/Users/<username>/AppData/Local/Temp/gradle-8.0-bin.zip
networkTimeout=10000
zipStoreBase=GRADLE_USER_HOME
zipStorePath=wrapper/dists
```

#### LÆ°u Ã½ khi Copy Project

Khi copy project sang mÃ¡y khÃ¡c:
1. Äáº£m báº£o file Gradle zip tá»“n táº¡i trÃªn mÃ¡y Ä‘Ã­ch
2. Cáº­p nháº­t Ä‘Æ°á»ng dáº«n username trong `gradle-wrapper.properties`
3. Hoáº·c sá»­ dá»¥ng biáº¿n mÃ´i trÆ°á»ng: `file\:///${GRADLE_LOCAL_PATH}/gradle-8.0-bin.zip`

---

## â˜• Java Code Organization

### Class Structure Order

```java
public class ExampleActivity extends AppCompatActivity {
    
    // 1. Constants
    private static final String TAG = "ExampleActivity";
    private static final int REQUEST_CODE = 100;
    
    // 2. Static fields
    
    // 3. Instance fields - UI components
    private TextView tvTitle;
    private Button btnSave;
    private RecyclerView recyclerList;
    
    // 4. Instance fields - Data
    private DatabaseHelper databaseHelper;
    private List<Item> items;
    
    // 5. Instance fields - Launchers/Callbacks
    private ActivityResultLauncher<Intent> pickerLauncher;
    
    // 6. Lifecycle methods (in order)
    @Override
    protected void onCreate(Bundle savedInstanceState) { }
    
    @Override
    protected void onStart() { }
    
    @Override
    protected void onResume() { }
    
    @Override
    protected void onPause() { }
    
    @Override
    protected void onStop() { }
    
    @Override
    protected void onDestroy() { }
    
    // 7. Override methods
    @Override
    public void onBackPressed() { }
    
    // 8. Public methods
    public void refreshData() { }
    
    // 9. Private methods - Setup/Init
    private void initViews() { }
    private void setupListeners() { }
    
    // 10. Private methods - Business logic
    private void loadData() { }
    private void saveData() { }
    
    // 11. Private methods - UI updates
    private void updateUI() { }
    private void showLoading() { }
    
    // 12. Inner classes/interfaces
    private class ItemAdapter extends RecyclerView.Adapter { }
}
```

### Model Class Structure

```java
public class Alarm {
    
    // 1. Constants
    public static final int REPEAT_ONCE = 0;
    public static final int REPEAT_DAILY = 1;
    
    // 2. Private fields
    private long id;
    private String name;
    private int hour;
    private int minute;
    private boolean enabled;
    
    // 3. Constructors
    public Alarm() { }
    
    public Alarm(String name, int hour, int minute) {
        this.name = name;
        this.hour = hour;
        this.minute = minute;
        this.enabled = true;
    }
    
    // 4. Getters & Setters (grouped by field)
    public long getId() { return id; }
    public void setId(long id) { this.id = id; }
    
    public String getName() { return name; }
    public void setName(String name) { this.name = name; }
    
    // 5. Helper/Utility methods
    public String getTimeFormatted() {
        return String.format(Locale.getDefault(), "%02d:%02d", hour, minute);
    }
    
    public boolean isDoubleTapEnabled() {
        return (dismissGesture & GESTURE_DOUBLE_TAP) != 0;
    }
    
    // 6. Object methods
    @Override
    public String toString() { }
    
    @Override
    public boolean equals(Object o) { }
    
    @Override
    public int hashCode() { }
}
```

### Database Helper Structure

```java
public class DatabaseHelper extends SQLiteOpenHelper {
    
    // 1. Constants
    private static final String DATABASE_NAME = "app.db";
    private static final int DATABASE_VERSION = 1;
    
    // Table names
    private static final String TABLE_ALARMS = "alarms";
    
    // Column names
    private static final String COL_ID = "id";
    private static final String COL_NAME = "name";
    
    // 2. Singleton instance
    private static DatabaseHelper instance;
    
    // 3. Constructor (private for singleton)
    private DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }
    
    public static synchronized DatabaseHelper getInstance(Context context) {
        if (instance == null) {
            instance = new DatabaseHelper(context.getApplicationContext());
        }
        return instance;
    }
    
    // 4. Override methods
    @Override
    public void onCreate(SQLiteDatabase db) { }
    
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) { }
    
    // 5. CRUD methods - Create
    public long insertAlarm(Alarm alarm) { }
    
    // 6. CRUD methods - Read
    public Alarm getAlarmById(long id) { }
    public List<Alarm> getAllAlarms() { }
    
    // 7. CRUD methods - Update
    public int updateAlarm(Alarm alarm) { }
    
    // 8. CRUD methods - Delete
    public int deleteAlarm(long id) { }
    
    // 9. Helper methods
    private Alarm cursorToAlarm(Cursor cursor) { }
}
```

---

## ğŸ¨ Resources Organization

### Colors - Semantic Naming

```xml
<!-- colors.xml -->
<resources>
    <!-- Brand Colors -->
    <color name="primary">#09A3E3</color>
    <color name="primary_dark">#0891CC</color>
    <color name="primary_light">#ACDEF2</color>
    <color name="accent">#FF5722</color>
    
    <!-- Background Colors -->
    <color name="background">#F5F5F5</color>
    <color name="background_dark">#1A1A1A</color>
    <color name="card_background">#FFFFFF</color>
    <color name="card_background_dark">#2D2D2D</color>
    
    <!-- Text Colors -->
    <color name="text_primary">#212121</color>
    <color name="text_secondary">#757575</color>
    <color name="text_hint">#9E9E9E</color>
    <color name="text_disabled">#BDBDBD</color>
    
    <!-- Status Colors -->
    <color name="success">#4CAF50</color>
    <color name="warning">#FF9800</color>
    <color name="error">#F44336</color>
    
    <!-- UI Element Colors -->
    <color name="divider">#E0E0E0</color>
    <color name="button_danger">#F44336</color>
    <color name="button_disabled">#E0E0E0</color>
</resources>
```

### Dimensions - Consistent Spacing

```xml
<!-- dimens.xml -->
<resources>
    <!-- Spacing (use multiples of 4dp or 8dp) -->
    <dimen name="spacing_tiny">4dp</dimen>
    <dimen name="spacing_small">8dp</dimen>
    <dimen name="spacing_medium">12dp</dimen>
    <dimen name="spacing_normal">16dp</dimen>
    <dimen name="spacing_large">24dp</dimen>
    <dimen name="spacing_xlarge">32dp</dimen>
    
    <!-- Text Sizes -->
    <dimen name="text_size_tiny">10sp</dimen>
    <dimen name="text_size_small">12sp</dimen>
    <dimen name="text_size_normal">14sp</dimen>
    <dimen name="text_size_medium">16sp</dimen>
    <dimen name="text_size_large">18sp</dimen>
    <dimen name="text_size_xlarge">20sp</dimen>
    <dimen name="text_size_title">24sp</dimen>
    <dimen name="text_size_headline">32sp</dimen>
    
    <!-- Component Sizes -->
    <dimen name="button_height">48dp</dimen>
    <dimen name="button_min_width">88dp</dimen>
    <dimen name="icon_size_small">16dp</dimen>
    <dimen name="icon_size_normal">24dp</dimen>
    <dimen name="icon_size_large">32dp</dimen>
    <dimen name="card_corner_radius">8dp</dimen>
    <dimen name="card_elevation">2dp</dimen>
</resources>
```

### Styles - Component-Based

```xml
<!-- styles.xml -->
<resources>
    <!-- Text Styles -->
    <style name="Text" />
    
    <style name="Text.Title">
        <item name="android:textSize">@dimen/text_size_title</item>
        <item name="android:textColor">@color/text_primary</item>
        <item name="android:textStyle">bold</item>
    </style>
    
    <style name="Text.Body">
        <item name="android:textSize">@dimen/text_size_normal</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Text.Caption">
        <item name="android:textSize">@dimen/text_size_small</item>
        <item name="android:textColor">@color/text_secondary</item>
    </style>
    
    <!-- Button Styles -->
    <style name="Button" parent="Widget.MaterialComponents.Button">
        <item name="android:minHeight">@dimen/button_height</item>
        <item name="cornerRadius">@dimen/card_corner_radius</item>
    </style>
    
    <style name="Button.Primary">
        <item name="backgroundTint">@color/primary</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <style name="Button.Secondary">
        <item name="backgroundTint">@color/card_background</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Button.Danger">
        <item name="backgroundTint">@color/button_danger</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <!-- Card Styles -->
    <style name="Card" parent="Widget.MaterialComponents.CardView">
        <item name="cardCornerRadius">@dimen/card_corner_radius</item>
        <item name="cardElevation">@dimen/card_elevation</item>
        <item name="cardBackgroundColor">@color/card_background</item>
    </style>
</resources>
```

---

## ğŸ“‚ File Splitting Rules (NguyÃªn táº¯c tÃ¡ch file)

### âš ï¸ HÆ°á»›ng dáº«n cho AI - LUÃ”N SPLIT Ä‘á»ƒ Clean Architecture

**LUÃ”N split resources theo category** - khÃ´ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng items. Äiá»u nÃ y giÃºp:
- Code dá»… maintain, dá»… tÃ¬m kiáº¿m
- Chuáº©n bá»‹ cho scale up
- Consistent across all projects
- Dá»… review vÃ  merge code

**NguyÃªn táº¯c: 1 file = 1 purpose**

| Resource | Split thÃ nh | LuÃ´n tÃ¡ch |
|----------|-------------|-----------|
| `colors.xml` | `colors_brand.xml`, `colors_text.xml`, `colors_ui.xml` | âœ… |
| `dimens.xml` | `dimens_text.xml`, `dimens_spacing.xml`, `dimens_component.xml` | âœ… |
| `strings.xml` | `strings_[feature].xml` theo mÃ n hÃ¬nh/feature | âœ… |
| `styles.xml` | `styles_shared.xml`, `styles_button.xml`, `styles_dialog.xml` | âœ… |

### ğŸ¤– AI Workflow khi Ä‘Æ°á»£c yÃªu cáº§u Split

```
1. Äá»c file hiá»‡n táº¡i, xÃ¡c Ä‘á»‹nh cÃ¡c nhÃ³m theo prefix/semantic
2. Táº¡o file má»›i vá»›i naming: [type]_[category].xml
3. Di chuyá»ƒn items vÃ o file má»›i (giá»¯ nguyÃªn format)
4. File gá»‘c giá»¯ lÃ m reference hoáº·c chá»©a items chung/misc
5. Build verify
6. Náº¿u lÃ  strings: cáº­p nháº­t cáº£ values-vi/
```

### ğŸ“Š VÃ­ dá»¥ phÃ¢n tÃ­ch trÆ°á»›c khi split

```xml
<!-- PhÃ¢n tÃ­ch strings.xml -->
<!-- NhÃ³m theo prefix: -->
<!-- nav_* : 5 items â†’ strings_navigation.xml -->
<!-- alarm_* : 25 items â†’ strings_alarm.xml -->
<!-- dialog_* : 18 items â†’ strings_dialog.xml -->
<!-- toast_* : 8 items â†’ strings_toast.xml -->
<!-- profile_* : 12 items â†’ strings_profile.xml -->
<!-- misc (khÃ´ng prefix) â†’ giá»¯ trong strings.xml -->
```

---

### Khi nÃ o nÃªn tÃ¡ch file má»›i?

| TÃ¬nh huá»‘ng | HÃ nh Ä‘á»™ng |
|------------|-----------|
| Code duplicate â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh Utils class |
| Layout dÃ¹ng â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh `layout_[name].xml` Ä‘á»ƒ include |
| File > 300 lines | CÃ¢n nháº¯c tÃ¡ch thÃ nh helper classes |
| NhÃ³m constants > 10 | TÃ¡ch thÃ nh Constants class |
| Feature má»›i Ä‘á»™c láº­p | Táº¡o Activity/Fragment riÃªng |

### 1. Java Files - TÃ¡ch theo chá»©c nÄƒng

```
NguyÃªn táº¯c: 1 class = 1 file, tÃ¡ch theo Single Responsibility
```

| Category | MÃ´ táº£ | Äáº·t á»Ÿ |
|----------|-------|-------|
| **Activities** | MÃ n hÃ¬nh chÃ­nh, lifecycle | `com/package/` |
| **Fragments** | UI components trong Activity | `com/package/` |
| **Models** | Data classes (POJO) | `com/package/` hoáº·c `models/` |
| **Adapters** | RecyclerView/ListView adapters | `com/package/` |
| **Services** | Background services | `com/package/` |
| **Utils** | Helper/Utility classes | `com/package/utils/` |
| **Database** | DB helper, DAO | `com/package/` |

**VÃ­ dá»¥ tÃ¡ch Utils:**
```java
// TrÆ°á»›c: Code láº·p láº¡i trong nhiá»u file
// MainList.java, MainAdd.java Ä‘á»u cÃ³ setDialogWidth()

// Sau: TÃ¡ch thÃ nh utility class
// utils/DialogUtils.java
public class DialogUtils {
    public static void setDialogWidth(Dialog dialog, Context context) {
        // Centralized logic
    }
}
```

### 2. Layout Files - TÃ¡ch theo prefix

```
NguyÃªn táº¯c: Prefix cho biáº¿t loáº¡i vÃ  scope sá»­ dá»¥ng
```

| Prefix | DÃ¹ng cho | VÃ­ dá»¥ |
|--------|----------|-------|
| `activity_` | Activity layouts | `activity_main.xml` |
| `main_` | Fragment layouts (main tabs) | `main_schedule.xml` |
| `dialog_` | Dialog layouts | `dialog_add_alarm.xml` |
| `shared_` | Reusable components | `shared_item_alarm.xml` |
| `item_` | List item layouts | `item_sound.xml` |

**Khi nÃ o táº¡o shared layout:**
- Component Ä‘Æ°á»£c dÃ¹ng â‰¥ 2 nÆ¡i
- List item layouts dÃ¹ng chung
- Common headers, footers

### 2.1. Layout Sections - TÃ¡ch layout lá»›n thÃ nh sections

```
NguyÃªn táº¯c: Khi layout file > 200 lines hoáº·c cÃ³ nhiá»u sections rÃµ rÃ ng, tÃ¡ch thÃ nh cÃ¡c file nhá» vÃ  dÃ¹ng <include>
```

**Naming Pattern:**

| Layout Type | Section Pattern | VÃ­ dá»¥ |
|-------------|-----------------|-------|
| Fragment | `[fragment_name]_section_[name].xml` | `main_profile_section_header.xml`, `main_schedule_section_list.xml` |
| Activity | `[activity_name]_section_[name].xml` | `activity_settings_section_toolbar.xml` |
| Dialog | `[dialog_name]_section_[name].xml` | `dialog_alarm_section_time_picker.xml` |

> **LÆ°u Ã½:** Section file pháº£i cÃ³ prefix lÃ  tÃªn file parent Ä‘á»ƒ dá»… dÃ ng biáº¿t thuá»™c vá» layout nÃ o.

**VÃ­ dá»¥ tÃ¡ch `main_profile.xml`:**

```
TrÆ°á»›c: main_profile.xml (500+ lines)
â”œâ”€â”€ Header section
â”œâ”€â”€ App Settings section  
â”œâ”€â”€ Permissions section
â”œâ”€â”€ About section
â””â”€â”€ Footer section

Sau:
â”œâ”€â”€ main_profile.xml (container + includes)
â”œâ”€â”€ main_profile_section_header.xml
â”œâ”€â”€ main_profile_section_app_settings.xml
â”œâ”€â”€ main_profile_section_permissions.xml
â”œâ”€â”€ main_profile_section_about.xml
â””â”€â”€ main_profile_section_footer.xml
```

**1. Main layout (container):**

```xml
<!-- main_profile.xml -->
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="?attr/contentBackground">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Header -->
        <include layout="@layout/main_profile_section_header" />

        <!-- App Settings -->
        <include layout="@layout/main_profile_section_app_settings" />

        <!-- Permissions -->
        <include layout="@layout/main_profile_section_permissions" />

        <!-- About -->
        <include layout="@layout/main_profile_section_about" />

    </LinearLayout>
</ScrollView>
```

**2. Section layout:**

```xml
<!-- main_profile_section_app_settings.xml -->
<?xml version="1.0" encoding="utf-8"?>
<androidx.cardview.widget.CardView 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="@dimen/spacing_normal"
    app:cardBackgroundColor="?attr/cardBackground"
    app:cardCornerRadius="@dimen/card_corner_radius"
    app:cardElevation="@dimen/card_elevation">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Section Title -->
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/app_settings"
            android:textAppearance="@style/TextAppearance.Heading"
            android:layout_marginBottom="@dimen/spacing_medium" />

        <!-- Dark Mode Toggle -->
        <include layout="@layout/main_section_setting_dark_mode" />

        <!-- Language Selection -->
        <include layout="@layout/main_section_setting_language" />

    </LinearLayout>
</androidx.cardview.widget.CardView>
```

**3. Access views tá»« included layouts trong Java:**

```java
// Views trong included layout váº«n access bÃ¬nh thÆ°á»ng báº±ng ID
@Override
public View onCreateView(...) {
    View view = inflater.inflate(R.layout.main_profile, container, false);
    
    // IDs tá»« main_section_app_settings.xml
    switchDarkMode = view.findViewById(R.id.switchDarkMode);
    layoutLanguage = view.findViewById(R.id.layoutLanguage);
    
    // IDs tá»« main_section_about.xml
    tvVersion = view.findViewById(R.id.tvVersion);
    tvContact = view.findViewById(R.id.tvContact);
    
    return view;
}
```

**Khi nÃ o tÃ¡ch layout thÃ nh sections:**

| Layout Type | Äiá»u kiá»‡n | HÃ nh Ä‘á»™ng |
|-------------|-----------|-----------|
| `main_*.xml` (Fragment chÃ­nh) | LuÃ´n luÃ´n | **Báº¯t buá»™c tÃ¡ch** - Clean Architecture |
| `dialog_*.xml` | CÃ³ â‰¥ 3 sections hoáº·c > 300 lines | NÃªn tÃ¡ch |
| `activity_*.xml` | > 200 lines hoáº·c cÃ³ sections rÃµ rÃ ng | CÃ¢n nháº¯c tÃ¡ch |
| Báº¥t ká»³ layout | Section Ä‘Æ°á»£c dÃ¹ng láº¡i á»Ÿ nÆ¡i khÃ¡c | Báº¯t buá»™c tÃ¡ch |

**Lá»£i Ã­ch:**
- Dá»… Ä‘á»c vÃ  navigate trong tá»«ng section
- Dá»… maintain - sá»­a 1 section khÃ´ng áº£nh hÆ°á»Ÿng file khÃ¡c
- Reuse sections náº¿u cáº§n (chuyá»ƒn thÃ nh `shared_section_*.xml`)
- Git diff dá»… Ä‘á»c hÆ¡n khi cÃ³ thay Ä‘á»•i
- Team cÃ³ thá»ƒ lÃ m viá»‡c song song trÃªn cÃ¡c sections

**âš ï¸ LÆ°u Ã½:**
- Äáº£m báº£o IDs unique across táº¥t cáº£ included layouts
- Prefix IDs theo section náº¿u cÃ³ nguy cÆ¡ trÃ¹ng: `settingsSwitchDarkMode`, `aboutTvVersion`
- KhÃ´ng láº¡m dá»¥ng - chá»‰ tÃ¡ch khi thá»±c sá»± cáº§n thiáº¿t

### 2.2. Custom Header/Action Bar Pattern

```
NguyÃªn táº¯c: Sá»­ dá»¥ng Custom Header thay vÃ¬ ActionBar há»‡ thá»‘ng Ä‘á»ƒ cÃ³ full control over styling
```

**Theme Configuration - Táº¯t ActionBar há»‡ thá»‘ng:**

```xml
<!-- styles_theme.xml -->
<style name="Theme.App" parent="Theme.MaterialComponents.Light.NoActionBar">
    <!-- App khÃ´ng sá»­ dá»¥ng ActionBar máº·c Ä‘á»‹nh -->
</style>
```

**Custom Header Layout Pattern:**

```xml
<!-- Header section trong activity layout -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="56dp"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:paddingStart="8dp"
    android:paddingEnd="16dp"
    android:background="@color/background_light">
    
    <!-- Back button -->
    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_arrow_back"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/back"
        android:tint="@color/text_primary"/>

    <!-- Title -->
    <TextView
        android:id="@+id/tvTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/screen_title"
        android:textSize="20sp"
        android:textColor="@color/text_primary"
        android:layout_marginStart="8dp"/>
    
    <!-- Optional: Action buttons -->
    <ImageButton
        android:id="@+id/btnSave"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_check"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/save"
        android:tint="@color/primary"
        android:visibility="gone"/>
        
</LinearLayout>
```

**Java Implementation:**

```java
public class DetailActivity extends AppCompatActivity {
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_detail);
        
        // Setup back button
        ImageButton btnBack = findViewById(R.id.btnBack);
        btnBack.setOnClickListener(v -> finish());
        
        // Optional: Setup action buttons
        ImageButton btnSave = findViewById(R.id.btnSave);
        btnSave.setVisibility(View.VISIBLE);
        btnSave.setOnClickListener(v -> saveAndFinish());
    }
}
```

**Khi nÃ o cáº§n Custom Header:**

| MÃ n hÃ¬nh | Header Type | MÃ´ táº£ |
|----------|-------------|-------|
| Sub-activities | âœ… Back + Title | `AlarmSoundActivity`, `VibrationActivity` |
| Detail/Edit screens | âœ… Back + Title + Save | Edit screens vá»›i action button |
| Main fragments (tabs) | âŒ KhÃ´ng cáº§n | Root screens trong BottomNav |
| Fullscreen (Alarm Ring) | âŒ KhÃ´ng cáº§n | KhÃ´ng cÃ³ navigation |

**Æ¯u Ä‘iá»ƒm Custom Header:**
- Full control over styling (colors, fonts, spacing)
- KhÃ´ng bá»‹ giá»›i háº¡n bá»Ÿi ActionBar API
- Dá»… customize (thÃªm buttons, badges, progress)
- Consistent vá»›i Material Design guidelines
- Há»— trá»£ dark mode tá»‘t hÆ¡n

**Header Section File (Optional):**

Náº¿u header phá»©c táº¡p hoáº·c reused, tÃ¡ch ra file riÃªng:

```xml
<!-- activity_section_header.xml -->
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="56dp"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:paddingStart="8dp"
    android:paddingEnd="16dp">
    
    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_arrow_back"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/back"
        android:tint="@color/text_primary" />

    <TextView
        android:id="@+id/tvTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/screen_title"
        android:textSize="20sp"
        android:textColor="@color/text_primary"
        android:layout_marginStart="8dp"/>
        
</LinearLayout>
```

```xml
<!-- activity_detail.xml -->
<LinearLayout ...>
    <include layout="@layout/activity_section_header" />
    
    <!-- Content -->
    <ScrollView ... />
</LinearLayout>
```

### 3. Colors - TÃ¡ch theo má»¥c Ä‘Ã­ch sá»­ dá»¥ng

```xml
<!-- colors.xml -->
<resources>
    <!-- Brand Colors -->
    <color name="primary">#09A3E3</color>
    <color name="primary_dark">#0891CC</color>
    <color name="primary_light">#ACDEF2</color>
    <color name="accent">#FF5722</color>
    
    <!-- Background Colors -->
    <color name="background">#F5F5F5</color>
    <color name="background_dark">#1A1A1A</color>
    <color name="card_background">#FFFFFF</color>
    <color name="card_background_dark">#2D2D2D</color>
    
    <!-- Text Colors -->
    <color name="text_primary">#212121</color>
    <color name="text_secondary">#757575</color>
    <color name="text_hint">#9E9E9E</color>
    <color name="text_disabled">#BDBDBD</color>
    
    <!-- Status Colors -->
    <color name="success">#4CAF50</color>
    <color name="warning">#FF9800</color>
    <color name="error">#F44336</color>
    
    <!-- UI Element Colors -->
    <color name="divider">#E0E0E0</color>
    <color name="button_danger">#F44336</color>
    <color name="button_disabled">#E0E0E0</color>
</resources>
```

### Dimensions - Consistent Spacing

```xml
<!-- dimens.xml -->
<resources>
    <!-- Spacing (use multiples of 4dp or 8dp) -->
    <dimen name="spacing_tiny">4dp</dimen>
    <dimen name="spacing_small">8dp</dimen>
    <dimen name="spacing_medium">12dp</dimen>
    <dimen name="spacing_normal">16dp</dimen>
    <dimen name="spacing_large">24dp</dimen>
    <dimen name="spacing_xlarge">32dp</dimen>
    
    <!-- Text Sizes -->
    <dimen name="text_size_tiny">10sp</dimen>
    <dimen name="text_size_small">12sp</dimen>
    <dimen name="text_size_normal">14sp</dimen>
    <dimen name="text_size_medium">16sp</dimen>
    <dimen name="text_size_large">18sp</dimen>
    <dimen name="text_size_xlarge">20sp</dimen>
    <dimen name="text_size_title">24sp</dimen>
    <dimen name="text_size_headline">32sp</dimen>
    
    <!-- Component Sizes -->
    <dimen name="button_height">48dp</dimen>
    <dimen name="button_min_width">88dp</dimen>
    <dimen name="icon_size_small">16dp</dimen>
    <dimen name="icon_size_normal">24dp</dimen>
    <dimen name="icon_size_large">32dp</dimen>
    <dimen name="card_corner_radius">8dp</dimen>
    <dimen name="card_elevation">2dp</dimen>
</resources>
```

### Styles - Component-Based

```xml
<!-- styles.xml -->
<resources>
    <!-- Text Styles -->
    <style name="Text" />
    
    <style name="Text.Title">
        <item name="android:textSize">@dimen/text_size_title</item>
        <item name="android:textColor">@color/text_primary</item>
        <item name="android:textStyle">bold</item>
    </style>
    
    <style name="Text.Body">
        <item name="android:textSize">@dimen/text_size_normal</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Text.Caption">
        <item name="android:textSize">@dimen/text_size_small</item>
        <item name="android:textColor">@color/text_secondary</item>
    </style>
    
    <!-- Button Styles -->
    <style name="Button" parent="Widget.MaterialComponents.Button">
        <item name="android:minHeight">@dimen/button_height</item>
        <item name="cornerRadius">@dimen/card_corner_radius</item>
    </style>
    
    <style name="Button.Primary">
        <item name="backgroundTint">@color/primary</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <style name="Button.Secondary">
        <item name="backgroundTint">@color/card_background</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Button.Danger">
        <item name="backgroundTint">@color/button_danger</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <!-- Card Styles -->
    <style name="Card" parent="Widget.MaterialComponents.CardView">
        <item name="cardCornerRadius">@dimen/card_corner_radius</item>
        <item name="cardElevation">@dimen/card_elevation</item>
        <item name="cardBackgroundColor">@color/card_background</item>
    </style>
</resources>
```

---

## ğŸ“‚ File Splitting Rules (NguyÃªn táº¯c tÃ¡ch file)

### âš ï¸ HÆ°á»›ng dáº«n cho AI - LUÃ”N SPLIT Ä‘á»ƒ Clean Architecture

**LUÃ”N split resources theo category** - khÃ´ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng items. Äiá»u nÃ y giÃºp:
- Code dá»… maintain, dá»… tÃ¬m kiáº¿m
- Chuáº©n bá»‹ cho scale up
- Consistent across all projects
- Dá»… review vÃ  merge code

**NguyÃªn táº¯c: 1 file = 1 purpose**

| Resource | Split thÃ nh | LuÃ´n tÃ¡ch |
|----------|-------------|-----------|
| `colors.xml` | `colors_brand.xml`, `colors_text.xml`, `colors_ui.xml` | âœ… |
| `dimens.xml` | `dimens_text.xml`, `dimens_spacing.xml`, `dimens_component.xml` | âœ… |
| `strings.xml` | `strings_[feature].xml` theo mÃ n hÃ¬nh/feature | âœ… |
| `styles.xml` | `styles_shared.xml`, `styles_button.xml`, `styles_dialog.xml` | âœ… |

### ğŸ¤– AI Workflow khi Ä‘Æ°á»£c yÃªu cáº§u Split

```
1. Äá»c file hiá»‡n táº¡i, xÃ¡c Ä‘á»‹nh cÃ¡c nhÃ³m theo prefix/semantic
2. Táº¡o file má»›i vá»›i naming: [type]_[category].xml
3. Di chuyá»ƒn items vÃ o file má»›i (giá»¯ nguyÃªn format)
4. File gá»‘c giá»¯ lÃ m reference hoáº·c chá»©a items chung/misc
5. Build verify
6. Náº¿u lÃ  strings: cáº­p nháº­t cáº£ values-vi/
```

### ğŸ“Š VÃ­ dá»¥ phÃ¢n tÃ­ch trÆ°á»›c khi split

```xml
<!-- PhÃ¢n tÃ­ch strings.xml -->
<!-- NhÃ³m theo prefix: -->
<!-- nav_* : 5 items â†’ strings_navigation.xml -->
<!-- alarm_* : 25 items â†’ strings_alarm.xml -->
<!-- dialog_* : 18 items â†’ strings_dialog.xml -->
<!-- toast_* : 8 items â†’ strings_toast.xml -->
<!-- profile_* : 12 items â†’ strings_profile.xml -->
<!-- misc (khÃ´ng prefix) â†’ giá»¯ trong strings.xml -->
```

---

### Khi nÃ o nÃªn tÃ¡ch file má»›i?

| TÃ¬nh huá»‘ng | HÃ nh Ä‘á»™ng |
|------------|-----------|
| Code duplicate â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh Utils class |
| Layout dÃ¹ng â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh `layout_[name].xml` Ä‘á»ƒ include |
| File > 300 lines | CÃ¢n nháº¯c tÃ¡ch thÃ nh helper classes |
| NhÃ³m constants > 10 | TÃ¡ch thÃ nh Constants class |
| Feature má»›i Ä‘á»™c láº­p | Táº¡o Activity/Fragment riÃªng |

### 1. Java Files - TÃ¡ch theo chá»©c nÄƒng

```
NguyÃªn táº¯c: 1 class = 1 file, tÃ¡ch theo Single Responsibility
```

| Category | MÃ´ táº£ | Äáº·t á»Ÿ |
|----------|-------|-------|
| **Activities** | MÃ n hÃ¬nh chÃ­nh, lifecycle | `com/package/` |
| **Fragments** | UI components trong Activity | `com/package/` |
| **Models** | Data classes (POJO) | `com/package/` hoáº·c `models/` |
| **Adapters** | RecyclerView/ListView adapters | `com/package/` |
| **Services** | Background services | `com/package/` |
| **Utils** | Helper/Utility classes | `com/package/utils/` |
| **Database** | DB helper, DAO | `com/package/` |

**VÃ­ dá»¥ tÃ¡ch Utils:**
```java
// TrÆ°á»›c: Code láº·p láº¡i trong nhiá»u file
// MainList.java, MainAdd.java Ä‘á»u cÃ³ setDialogWidth()

// Sau: TÃ¡ch thÃ nh utility class
// utils/DialogUtils.java
public class DialogUtils {
    public static void setDialogWidth(Dialog dialog, Context context) {
        // Centralized logic
    }
}
```

### 2. Layout Files - TÃ¡ch theo prefix

```
NguyÃªn táº¯c: Prefix cho biáº¿t loáº¡i vÃ  scope sá»­ dá»¥ng
```

| Prefix | DÃ¹ng cho | VÃ­ dá»¥ |
|--------|----------|-------|
| `activity_` | Activity layouts | `activity_main.xml` |
| `main_` | Fragment layouts (main tabs) | `main_schedule.xml` |
| `dialog_` | Dialog layouts | `dialog_add_alarm.xml` |
| `shared_` | Reusable components | `shared_item_alarm.xml` |
| `item_` | List item layouts | `item_sound.xml` |

**Khi nÃ o táº¡o shared layout:**
- Component Ä‘Æ°á»£c dÃ¹ng â‰¥ 2 nÆ¡i
- List item layouts dÃ¹ng chung
- Common headers, footers

### 2.1. Layout Sections - TÃ¡ch layout lá»›n thÃ nh sections

```
NguyÃªn táº¯c: Khi layout file > 200 lines hoáº·c cÃ³ nhiá»u sections rÃµ rÃ ng, tÃ¡ch thÃ nh cÃ¡c file nhá» vÃ  dÃ¹ng <include>
```

**Naming Pattern:**

| Layout Type | Section Pattern | VÃ­ dá»¥ |
|-------------|-----------------|-------|
| Fragment | `[fragment_name]_section_[name].xml` | `main_profile_section_header.xml`, `main_schedule_section_list.xml` |
| Activity | `[activity_name]_section_[name].xml` | `activity_settings_section_toolbar.xml` |
| Dialog | `[dialog_name]_section_[name].xml` | `dialog_alarm_section_time_picker.xml` |

> **LÆ°u Ã½:** Section file pháº£i cÃ³ prefix lÃ  tÃªn file parent Ä‘á»ƒ dá»… dÃ ng biáº¿t thuá»™c vá» layout nÃ o.

**VÃ­ dá»¥ tÃ¡ch `main_profile.xml`:**

```
TrÆ°á»›c: main_profile.xml (500+ lines)
â”œâ”€â”€ Header section
â”œâ”€â”€ App Settings section  
â”œâ”€â”€ Permissions section
â”œâ”€â”€ About section
â””â”€â”€ Footer section

Sau:
â”œâ”€â”€ main_profile.xml (container + includes)
â”œâ”€â”€ main_profile_section_header.xml
â”œâ”€â”€ main_profile_section_app_settings.xml
â”œâ”€â”€ main_profile_section_permissions.xml
â”œâ”€â”€ main_profile_section_about.xml
â””â”€â”€ main_profile_section_footer.xml
```

**1. Main layout (container):**

```xml
<!-- main_profile.xml -->
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="?attr/contentBackground">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Header -->
        <include layout="@layout/main_profile_section_header" />

        <!-- App Settings -->
        <include layout="@layout/main_profile_section_app_settings" />

        <!-- Permissions -->
        <include layout="@layout/main_profile_section_permissions" />

        <!-- About -->
        <include layout="@layout/main_profile_section_about" />

    </LinearLayout>
</ScrollView>
```

**2. Section layout:**

```xml
<!-- main_profile_section_app_settings.xml -->
<?xml version="1.0" encoding="utf-8"?>
<androidx.cardview.widget.CardView 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="@dimen/spacing_normal"
    app:cardBackgroundColor="?attr/cardBackground"
    app:cardCornerRadius="@dimen/card_corner_radius"
    app:cardElevation="@dimen/card_elevation">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Section Title -->
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/app_settings"
            android:textAppearance="@style/TextAppearance.Heading"
            android:layout_marginBottom="@dimen/spacing_medium" />

        <!-- Dark Mode Toggle -->
        <include layout="@layout/main_section_setting_dark_mode" />

        <!-- Language Selection -->
        <include layout="@layout/main_section_setting_language" />

    </LinearLayout>
</androidx.cardview.widget.CardView>
```

**3. Access views tá»« included layouts trong Java:**

```java
// Views trong included layout váº«n access bÃ¬nh thÆ°á»ng báº±ng ID
@Override
public View onCreateView(...) {
    View view = inflater.inflate(R.layout.main_profile, container, false);
    
    // IDs tá»« main_section_app_settings.xml
    switchDarkMode = view.findViewById(R.id.switchDarkMode);
    layoutLanguage = view.findViewById(R.id.layoutLanguage);
    
    // IDs tá»« main_section_about.xml
    tvVersion = view.findViewById(R.id.tvVersion);
    tvContact = view.findViewById(R.id.tvContact);
    
    return view;
}
```

**Khi nÃ o tÃ¡ch layout thÃ nh sections:**

| Layout Type | Äiá»u kiá»‡n | HÃ nh Ä‘á»™ng |
|-------------|-----------|-----------|
| `main_*.xml` (Fragment chÃ­nh) | LuÃ´n luÃ´n | **Báº¯t buá»™c tÃ¡ch** - Clean Architecture |
| `dialog_*.xml` | CÃ³ â‰¥ 3 sections hoáº·c > 300 lines | NÃªn tÃ¡ch |
| `activity_*.xml` | > 200 lines hoáº·c cÃ³ sections rÃµ rÃ ng | CÃ¢n nháº¯c tÃ¡ch |
| Báº¥t ká»³ layout | Section Ä‘Æ°á»£c dÃ¹ng láº¡i á»Ÿ nÆ¡i khÃ¡c | Báº¯t buá»™c tÃ¡ch |

**Lá»£i Ã­ch:**
- Dá»… Ä‘á»c vÃ  navigate trong tá»«ng section
- Dá»… maintain - sá»­a 1 section khÃ´ng áº£nh hÆ°á»Ÿng file khÃ¡c
- Reuse sections náº¿u cáº§n (chuyá»ƒn thÃ nh `shared_section_*.xml`)
- Git diff dá»… Ä‘á»c hÆ¡n khi cÃ³ thay Ä‘á»•i
- Team cÃ³ thá»ƒ lÃ m viá»‡c song song trÃªn cÃ¡c sections

**âš ï¸ LÆ°u Ã½:**
- Äáº£m báº£o IDs unique across táº¥t cáº£ included layouts
- Prefix IDs theo section náº¿u cÃ³ nguy cÆ¡ trÃ¹ng: `settingsSwitchDarkMode`, `aboutTvVersion`
- KhÃ´ng láº¡m dá»¥ng - chá»‰ tÃ¡ch khi thá»±c sá»± cáº§n thiáº¿t

### 2.2. Custom Header/Action Bar Pattern

```
NguyÃªn táº¯c: Sá»­ dá»¥ng Custom Header thay vÃ¬ ActionBar há»‡ thá»‘ng Ä‘á»ƒ cÃ³ full control over styling
```

**Theme Configuration - Táº¯t ActionBar há»‡ thá»‘ng:**

```xml
<!-- styles_theme.xml -->
<style name="Theme.App" parent="Theme.MaterialComponents.Light.NoActionBar">
    <!-- App khÃ´ng sá»­ dá»¥ng ActionBar máº·c Ä‘á»‹nh -->
</style>
```

**Custom Header Layout Pattern:**

```xml
<!-- Header section trong activity layout -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="56dp"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:paddingStart="8dp"
    android:paddingEnd="16dp"
    android:background="@color/background_light">
    
    <!-- Back button -->
    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_arrow_back"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/back"
        android:tint="@color/text_primary"/>

    <!-- Title -->
    <TextView
        android:id="@+id/tvTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/screen_title"
        android:textSize="20sp"
        android:textColor="@color/text_primary"
        android:layout_marginStart="8dp"/>
    
    <!-- Optional: Action buttons -->
    <ImageButton
        android:id="@+id/btnSave"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_check"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/save"
        android:tint="@color/primary"
        android:visibility="gone"/>
        
</LinearLayout>
```

**Java Implementation:**

```java
public class DetailActivity extends AppCompatActivity {
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_detail);
        
        // Setup back button
        ImageButton btnBack = findViewById(R.id.btnBack);
        btnBack.setOnClickListener(v -> finish());
        
        // Optional: Setup action buttons
        ImageButton btnSave = findViewById(R.id.btnSave);
        btnSave.setVisibility(View.VISIBLE);
        btnSave.setOnClickListener(v -> saveAndFinish());
    }
}
```

**Khi nÃ o cáº§n Custom Header:**

| MÃ n hÃ¬nh | Header Type | MÃ´ táº£ |
|----------|-------------|-------|
| Sub-activities | âœ… Back + Title | `AlarmSoundActivity`, `VibrationActivity` |
| Detail/Edit screens | âœ… Back + Title + Save | Edit screens vá»›i action button |
| Main fragments (tabs) | âŒ KhÃ´ng cáº§n | Root screens trong BottomNav |
| Fullscreen (Alarm Ring) | âŒ KhÃ´ng cáº§n | KhÃ´ng cÃ³ navigation |

**Æ¯u Ä‘iá»ƒm Custom Header:**
- Full control over styling (colors, fonts, spacing)
- KhÃ´ng bá»‹ giá»›i háº¡n bá»Ÿi ActionBar API
- Dá»… customize (thÃªm buttons, badges, progress)
- Consistent vá»›i Material Design guidelines
- Há»— trá»£ dark mode tá»‘t hÆ¡n

**Header Section File (Optional):**

Náº¿u header phá»©c táº¡p hoáº·c reused, tÃ¡ch ra file riÃªng:

```xml
<!-- activity_section_header.xml -->
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="56dp"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:paddingStart="8dp"
    android:paddingEnd="16dp">
    
    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_arrow_back"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/back"
        android:tint="@color/text_primary" />

    <TextView
        android:id="@+id/tvTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/screen_title"
        android:textSize="20sp"
        android:textColor="@color/text_primary"
        android:layout_marginStart="8dp"/>
        
</LinearLayout>
```

```xml
<!-- activity_detail.xml -->
<LinearLayout ...>
    <include layout="@layout/activity_section_header" />
    
    <!-- Content -->
    <ScrollView ... />
</LinearLayout>
```

### 3. Colors - TÃ¡ch theo má»¥c Ä‘Ã­ch sá»­ dá»¥ng

```xml
<!-- colors.xml -->
<resources>
    <!-- Brand Colors -->
    <color name="primary">#09A3E3</color>
    <color name="primary_dark">#0891CC</color>
    <color name="primary_light">#ACDEF2</color>
    <color name="accent">#FF5722</color>
    
    <!-- Background Colors -->
    <color name="background">#F5F5F5</color>
    <color name="background_dark">#1A1A1A</color>
    <color name="card_background">#FFFFFF</color>
    <color name="card_background_dark">#2D2D2D</color>
    
    <!-- Text Colors -->
    <color name="text_primary">#212121</color>
    <color name="text_secondary">#757575</color>
    <color name="text_hint">#9E9E9E</color>
    <color name="text_disabled">#BDBDBD</color>
    
    <!-- Status Colors -->
    <color name="success">#4CAF50</color>
    <color name="warning">#FF9800</color>
    <color name="error">#F44336</color>
    
    <!-- UI Element Colors -->
    <color name="divider">#E0E0E0</color>
    <color name="button_danger">#F44336</color>
    <color name="button_disabled">#E0E0E0</color>
</resources>
```

### Dimensions - Consistent Spacing

```xml
<!-- dimens.xml -->
<resources>
    <!-- Spacing (use multiples of 4dp or 8dp) -->
    <dimen name="spacing_tiny">4dp</dimen>
    <dimen name="spacing_small">8dp</dimen>
    <dimen name="spacing_medium">12dp</dimen>
    <dimen name="spacing_normal">16dp</dimen>
    <dimen name="spacing_large">24dp</dimen>
    <dimen name="spacing_xlarge">32dp</dimen>
    
    <!-- Text Sizes -->
    <dimen name="text_size_tiny">10sp</dimen>
    <dimen name="text_size_small">12sp</dimen>
    <dimen name="text_size_normal">14sp</dimen>
    <dimen name="text_size_medium">16sp</dimen>
    <dimen name="text_size_large">18sp</dimen>
    <dimen name="text_size_xlarge">20sp</dimen>
    <dimen name="text_size_title">24sp</dimen>
    <dimen name="text_size_headline">32sp</dimen>
    
    <!-- Component Sizes -->
    <dimen name="button_height">48dp</dimen>
    <dimen name="button_min_width">88dp</dimen>
    <dimen name="icon_size_small">16dp</dimen>
    <dimen name="icon_size_normal">24dp</dimen>
    <dimen name="icon_size_large">32dp</dimen>
    <dimen name="card_corner_radius">8dp</dimen>
    <dimen name="card_elevation">2dp</dimen>
</resources>
```

### Styles - Component-Based

```xml
<!-- styles.xml -->
<resources>
    <!-- Text Styles -->
    <style name="Text" />
    
    <style name="Text.Title">
        <item name="android:textSize">@dimen/text_size_title</item>
        <item name="android:textColor">@color/text_primary</item>
        <item name="android:textStyle">bold</item>
    </style>
    
    <style name="Text.Body">
        <item name="android:textSize">@dimen/text_size_normal</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Text.Caption">
        <item name="android:textSize">@dimen/text_size_small</item>
        <item name="android:textColor">@color/text_secondary</item>
    </style>
    
    <!-- Button Styles -->
    <style name="Button" parent="Widget.MaterialComponents.Button">
        <item name="android:minHeight">@dimen/button_height</item>
        <item name="cornerRadius">@dimen/card_corner_radius</item>
    </style>
    
    <style name="Button.Primary">
        <item name="backgroundTint">@color/primary</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <style name="Button.Secondary">
        <item name="backgroundTint">@color/card_background</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Button.Danger">
        <item name="backgroundTint">@color/button_danger</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <!-- Card Styles -->
    <style name="Card" parent="Widget.MaterialComponents.CardView">
        <item name="cardCornerRadius">@dimen/card_corner_radius</item>
        <item name="cardElevation">@dimen/card_elevation</item>
        <item name="cardBackgroundColor">@color/card_background</item>
    </style>
</resources>
```

---

## ğŸ“‚ File Splitting Rules (NguyÃªn táº¯c tÃ¡ch file)

### âš ï¸ HÆ°á»›ng dáº«n cho AI - LUÃ”N SPLIT Ä‘á»ƒ Clean Architecture

**LUÃ”N split resources theo category** - khÃ´ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng items. Äiá»u nÃ y giÃºp:
- Code dá»… maintain, dá»… tÃ¬m kiáº¿m
- Chuáº©n bá»‹ cho scale up
- Consistent across all projects
- Dá»… review vÃ  merge code

**NguyÃªn táº¯c: 1 file = 1 purpose**

| Resource | Split thÃ nh | LuÃ´n tÃ¡ch |
|----------|-------------|-----------|
| `colors.xml` | `colors_brand.xml`, `colors_text.xml`, `colors_ui.xml` | âœ… |
| `dimens.xml` | `dimens_text.xml`, `dimens_spacing.xml`, `dimens_component.xml` | âœ… |
| `strings.xml` | `strings_[feature].xml` theo mÃ n hÃ¬nh/feature | âœ… |
| `styles.xml` | `styles_shared.xml`, `styles_button.xml`, `styles_dialog.xml` | âœ… |

### ğŸ¤– AI Workflow khi Ä‘Æ°á»£c yÃªu cáº§u Split

```
1. Äá»c file hiá»‡n táº¡i, xÃ¡c Ä‘á»‹nh cÃ¡c nhÃ³m theo prefix/semantic
2. Táº¡o file má»›i vá»›i naming: [type]_[category].xml
3. Di chuyá»ƒn items vÃ o file má»›i (giá»¯ nguyÃªn format)
4. File gá»‘c giá»¯ lÃ m reference hoáº·c chá»©a items chung/misc
5. Build verify
6. Náº¿u lÃ  strings: cáº­p nháº­t cáº£ values-vi/
```

### ğŸ“Š VÃ­ dá»¥ phÃ¢n tÃ­ch trÆ°á»›c khi split

```xml
<!-- PhÃ¢n tÃ­ch strings.xml -->
<!-- NhÃ³m theo prefix: -->
<!-- nav_* : 5 items â†’ strings_navigation.xml -->
<!-- alarm_* : 25 items â†’ strings_alarm.xml -->
<!-- dialog_* : 18 items â†’ strings_dialog.xml -->
<!-- toast_* : 8 items â†’ strings_toast.xml -->
<!-- profile_* : 12 items â†’ strings_profile.xml -->
<!-- misc (khÃ´ng prefix) â†’ giá»¯ trong strings.xml -->
```

---

### Khi nÃ o nÃªn tÃ¡ch file má»›i?

| TÃ¬nh huá»‘ng | HÃ nh Ä‘á»™ng |
|------------|-----------|
| Code duplicate â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh Utils class |
| Layout dÃ¹ng â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh `layout_[name].xml` Ä‘á»ƒ include |
| File > 300 lines | CÃ¢n nháº¯c tÃ¡ch thÃ nh helper classes |
| NhÃ³m constants > 10 | TÃ¡ch thÃ nh Constants class |
| Feature má»›i Ä‘á»™c láº­p | Táº¡o Activity/Fragment riÃªng |

### 1. Java Files - TÃ¡ch theo chá»©c nÄƒng

```
NguyÃªn táº¯c: 1 class = 1 file, tÃ¡ch theo Single Responsibility
```

| Category | MÃ´ táº£ | Äáº·t á»Ÿ |
|----------|-------|-------|
| **Activities** | MÃ n hÃ¬nh chÃ­nh, lifecycle | `com/package/` |
| **Fragments** | UI components trong Activity | `com/package/` |
| **Models** | Data classes (POJO) | `com/package/` hoáº·c `models/` |
| **Adapters** | RecyclerView/ListView adapters | `com/package/` |
| **Services** | Background services | `com/package/` |
| **Utils** | Helper/Utility classes | `com/package/utils/` |
| **Database** | DB helper, DAO | `com/package/` |

**VÃ­ dá»¥ tÃ¡ch Utils:**
```java
// TrÆ°á»›c: Code láº·p láº¡i trong nhiá»u file
// MainList.java, MainAdd.java Ä‘á»u cÃ³ setDialogWidth()

// Sau: TÃ¡ch thÃ nh utility class
// utils/DialogUtils.java
public class DialogUtils {
    public static void setDialogWidth(Dialog dialog, Context context) {
        // Centralized logic
    }
}
```

### 2. Layout Files - TÃ¡ch theo prefix

```
NguyÃªn táº¯c: Prefix cho biáº¿t loáº¡i vÃ  scope sá»­ dá»¥ng
```

| Prefix | DÃ¹ng cho | VÃ­ dá»¥ |
|--------|----------|-------|
| `activity_` | Activity layouts | `activity_main.xml` |
| `main_` | Fragment layouts (main tabs) | `main_schedule.xml` |
| `dialog_` | Dialog layouts | `dialog_add_alarm.xml` |
| `shared_` | Reusable components | `shared_item_alarm.xml` |
| `item_` | List item layouts | `item_sound.xml` |

**Khi nÃ o táº¡o shared layout:**
- Component Ä‘Æ°á»£c dÃ¹ng â‰¥ 2 nÆ¡i
- List item layouts dÃ¹ng chung
- Common headers, footers

### 2.1. Layout Sections - TÃ¡ch layout lá»›n thÃ nh sections

```
NguyÃªn táº¯c: Khi layout file > 200 lines hoáº·c cÃ³ nhiá»u sections rÃµ rÃ ng, tÃ¡ch thÃ nh cÃ¡c file nhá» vÃ  dÃ¹ng <include>
```

**Naming Pattern:**

| Layout Type | Section Pattern | VÃ­ dá»¥ |
|-------------|-----------------|-------|
| Fragment | `[fragment_name]_section_[name].xml` | `main_profile_section_header.xml`, `main_schedule_section_list.xml` |
| Activity | `[activity_name]_section_[name].xml` | `activity_settings_section_toolbar.xml` |
| Dialog | `[dialog_name]_section_[name].xml` | `dialog_alarm_section_time_picker.xml` |

> **LÆ°u Ã½:** Section file pháº£i cÃ³ prefix lÃ  tÃªn file parent Ä‘á»ƒ dá»… dÃ ng biáº¿t thuá»™c vá» layout nÃ o.

**VÃ­ dá»¥ tÃ¡ch `main_profile.xml`:**

```
TrÆ°á»›c: main_profile.xml (500+ lines)
â”œâ”€â”€ Header section
â”œâ”€â”€ App Settings section  
â”œâ”€â”€ Permissions section
â”œâ”€â”€ About section
â””â”€â”€ Footer section

Sau:
â”œâ”€â”€ main_profile.xml (container + includes)
â”œâ”€â”€ main_profile_section_header.xml
â”œâ”€â”€ main_profile_section_app_settings.xml
â”œâ”€â”€ main_profile_section_permissions.xml
â”œâ”€â”€ main_profile_section_about.xml
â””â”€â”€ main_profile_section_footer.xml
```

**1. Main layout (container):**

```xml
<!-- main_profile.xml -->
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="?attr/contentBackground">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Header -->
        <include layout="@layout/main_profile_section_header" />

        <!-- App Settings -->
        <include layout="@layout/main_profile_section_app_settings" />

        <!-- Permissions -->
        <include layout="@layout/main_profile_section_permissions" />

        <!-- About -->
        <include layout="@layout/main_profile_section_about" />

    </LinearLayout>
</ScrollView>
```

**2. Section layout:**

```xml
<!-- main_profile_section_app_settings.xml -->
<?xml version="1.0" encoding="utf-8"?>
<androidx.cardview.widget.CardView 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="@dimen/spacing_normal"
    app:cardBackgroundColor="?attr/cardBackground"
    app:cardCornerRadius="@dimen/card_corner_radius"
    app:cardElevation="@dimen/card_elevation">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Section Title -->
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/app_settings"
            android:textAppearance="@style/TextAppearance.Heading"
            android:layout_marginBottom="@dimen/spacing_medium" />

        <!-- Dark Mode Toggle -->
        <include layout="@layout/main_section_setting_dark_mode" />

        <!-- Language Selection -->
        <include layout="@layout/main_section_setting_language" />

    </LinearLayout>
</androidx.cardview.widget.CardView>
```

**3. Access views tá»« included layouts trong Java:**

```java
// Views trong included layout váº«n access bÃ¬nh thÆ°á»ng báº±ng ID
@Override
public View onCreateView(...) {
    View view = inflater.inflate(R.layout.main_profile, container, false);
    
    // IDs tá»« main_section_app_settings.xml
    switchDarkMode = view.findViewById(R.id.switchDarkMode);
    layoutLanguage = view.findViewById(R.id.layoutLanguage);
    
    // IDs tá»« main_section_about.xml
    tvVersion = view.findViewById(R.id.tvVersion);
    tvContact = view.findViewById(R.id.tvContact);
    
    return view;
}
```

**Khi nÃ o tÃ¡ch layout thÃ nh sections:**

| Layout Type | Äiá»u kiá»‡n | HÃ nh Ä‘á»™ng |
|-------------|-----------|-----------|
| `main_*.xml` (Fragment chÃ­nh) | LuÃ´n luÃ´n | **Báº¯t buá»™c tÃ¡ch** - Clean Architecture |
| `dialog_*.xml` | CÃ³ â‰¥ 3 sections hoáº·c > 300 lines | NÃªn tÃ¡ch |
| `activity_*.xml` | > 200 lines hoáº·c cÃ³ sections rÃµ rÃ ng | CÃ¢n nháº¯c tÃ¡ch |
| Báº¥t ká»³ layout | Section Ä‘Æ°á»£c dÃ¹ng láº¡i á»Ÿ nÆ¡i khÃ¡c | Báº¯t buá»™c tÃ¡ch |

**Lá»£i Ã­ch:**
- Dá»… Ä‘á»c vÃ  navigate trong tá»«ng section
- Dá»… maintain - sá»­a 1 section khÃ´ng áº£nh hÆ°á»Ÿng file khÃ¡c
- Reuse sections náº¿u cáº§n (chuyá»ƒn thÃ nh `shared_section_*.xml`)
- Git diff dá»… Ä‘á»c hÆ¡n khi cÃ³ thay Ä‘á»•i
- Team cÃ³ thá»ƒ lÃ m viá»‡c song song trÃªn cÃ¡c sections

**âš ï¸ LÆ°u Ã½:**
- Äáº£m báº£o IDs unique across táº¥t cáº£ included layouts
- Prefix IDs theo section náº¿u cÃ³ nguy cÆ¡ trÃ¹ng: `settingsSwitchDarkMode`, `aboutTvVersion`
- KhÃ´ng láº¡m dá»¥ng - chá»‰ tÃ¡ch khi thá»±c sá»± cáº§n thiáº¿t

### 2.2. Custom Header/Action Bar Pattern

```
NguyÃªn táº¯c: Sá»­ dá»¥ng Custom Header thay vÃ¬ ActionBar há»‡ thá»‘ng Ä‘á»ƒ cÃ³ full control over styling
```

**Theme Configuration - Táº¯t ActionBar há»‡ thá»‘ng:**

```xml
<!-- styles_theme.xml -->
<style name="Theme.App" parent="Theme.MaterialComponents.Light.NoActionBar">
    <!-- App khÃ´ng sá»­ dá»¥ng ActionBar máº·c Ä‘á»‹nh -->
</style>
```

**Custom Header Layout Pattern:**

```xml
<!-- Header section trong activity layout -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="56dp"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:paddingStart="8dp"
    android:paddingEnd="16dp"
    android:background="@color/background_light">
    
    <!-- Back button -->
    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_arrow_back"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/back"
        android:tint="@color/text_primary"/>

    <!-- Title -->
    <TextView
        android:id="@+id/tvTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/screen_title"
        android:textSize="20sp"
        android:textColor="@color/text_primary"
        android:layout_marginStart="8dp"/>
    
    <!-- Optional: Action buttons -->
    <ImageButton
        android:id="@+id/btnSave"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_check"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/save"
        android:tint="@color/primary"
        android:visibility="gone"/>
        
</LinearLayout>
```

**Java Implementation:**

```java
public class DetailActivity extends AppCompatActivity {
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_detail);
        
        // Setup back button
        ImageButton btnBack = findViewById(R.id.btnBack);
        btnBack.setOnClickListener(v -> finish());
        
        // Optional: Setup action buttons
        ImageButton btnSave = findViewById(R.id.btnSave);
        btnSave.setVisibility(View.VISIBLE);
        btnSave.setOnClickListener(v -> saveAndFinish());
    }
}
```

**Khi nÃ o cáº§n Custom Header:**

| MÃ n hÃ¬nh | Header Type | MÃ´ táº£ |
|----------|-------------|-------|
| Sub-activities | âœ… Back + Title | `AlarmSoundActivity`, `VibrationActivity` |
| Detail/Edit screens | âœ… Back + Title + Save | Edit screens vá»›i action button |
| Main fragments (tabs) | âŒ KhÃ´ng cáº§n | Root screens trong BottomNav |
| Fullscreen (Alarm Ring) | âŒ KhÃ´ng cáº§n | KhÃ´ng cÃ³ navigation |

**Æ¯u Ä‘iá»ƒm Custom Header:**
- Full control over styling (colors, fonts, spacing)
- KhÃ´ng bá»‹ giá»›i háº¡n bá»Ÿi ActionBar API
- Dá»… customize (thÃªm buttons, badges, progress)
- Consistent vá»›i Material Design guidelines
- Há»— trá»£ dark mode tá»‘t hÆ¡n

**Header Section File (Optional):**

Náº¿u header phá»©c táº¡p hoáº·c reused, tÃ¡ch ra file riÃªng:

```xml
<!-- activity_section_header.xml -->
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="56dp"
    android:orientation="horizontal"
    android:gravity="center_vertical"
    android:paddingStart="8dp"
    android:paddingEnd="16dp">
    
    <ImageButton
        android:id="@+id/btnBack"
        android:layout_width="48dp"
        android:layout_height="48dp"
        android:src="@drawable/ic_arrow_back"
        android:background="?android:attr/selectableItemBackgroundBorderless"
        android:contentDescription="@string/back"
        android:tint="@color/text_primary" />

    <TextView
        android:id="@+id/tvTitle"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/screen_title"
        android:textSize="20sp"
        android:textColor="@color/text_primary"
        android:layout_marginStart="8dp"/>
        
</LinearLayout>
```

```xml
<!-- activity_detail.xml -->
<LinearLayout ...>
    <include layout="@layout/activity_section_header" />
    
    <!-- Content -->
    <ScrollView ... />
</LinearLayout>
```

### 3. Colors - TÃ¡ch theo má»¥c Ä‘Ã­ch sá»­ dá»¥ng

```xml
<!-- colors.xml -->
<resources>
    <!-- Brand Colors -->
    <color name="primary">#09A3E3</color>
    <color name="primary_dark">#0891CC</color>
    <color name="primary_light">#ACDEF2</color>
    <color name="accent">#FF5722</color>
    
    <!-- Background Colors -->
    <color name="background">#F5F5F5</color>
    <color name="background_dark">#1A1A1A</color>
    <color name="card_background">#FFFFFF</color>
    <color name="card_background_dark">#2D2D2D</color>
    
    <!-- Text Colors -->
    <color name="text_primary">#212121</color>
    <color name="text_secondary">#757575</color>
    <color name="text_hint">#9E9E9E</color>
    <color name="text_disabled">#BDBDBD</color>
    
    <!-- Status Colors -->
    <color name="success">#4CAF50</color>
    <color name="warning">#FF9800</color>
    <color name="error">#F44336</color>
    
    <!-- UI Element Colors -->
    <color name="divider">#E0E0E0</color>
    <color name="button_danger">#F44336</color>
    <color name="button_disabled">#E0E0E0</color>
</resources>
```

### Dimensions - Consistent Spacing

```xml
<!-- dimens.xml -->
<resources>
    <!-- Spacing (use multiples of 4dp or 8dp) -->
    <dimen name="spacing_tiny">4dp</dimen>
    <dimen name="spacing_small">8dp</dimen>
    <dimen name="spacing_medium">12dp</dimen>
    <dimen name="spacing_normal">16dp</dimen>
    <dimen name="spacing_large">24dp</dimen>
    <dimen name="spacing_xlarge">32dp</dimen>
    
    <!-- Text Sizes -->
    <dimen name="text_size_tiny">10sp</dimen>
    <dimen name="text_size_small">12sp</dimen>
    <dimen name="text_size_normal">14sp</dimen>
    <dimen name="text_size_medium">16sp</dimen>
    <dimen name="text_size_large">18sp</dimen>
    <dimen name="text_size_xlarge">20sp</dimen>
    <dimen name="text_size_title">24sp</dimen>
    <dimen name="text_size_headline">32sp</dimen>
    
    <!-- Component Sizes -->
    <dimen name="button_height">48dp</dimen>
    <dimen name="button_min_width">88dp</dimen>
    <dimen name="icon_size_small">16dp</dimen>
    <dimen name="icon_size_normal">24dp</dimen>
    <dimen name="icon_size_large">32dp</dimen>
    <dimen name="card_corner_radius">8dp</dimen>
    <dimen name="card_elevation">2dp</dimen>
</resources>
```

### Styles - Component-Based

```xml
<!-- styles.xml -->
<resources>
    <!-- Text Styles -->
    <style name="Text" />
    
    <style name="Text.Title">
        <item name="android:textSize">@dimen/text_size_title</item>
        <item name="android:textColor">@color/text_primary</item>
        <item name="android:textStyle">bold</item>
    </style>
    
    <style name="Text.Body">
        <item name="android:textSize">@dimen/text_size_normal</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Text.Caption">
        <item name="android:textSize">@dimen/text_size_small</item>
        <item name="android:textColor">@color/text_secondary</item>
    </style>
    
    <!-- Button Styles -->
    <style name="Button" parent="Widget.MaterialComponents.Button">
        <item name="android:minHeight">@dimen/button_height</item>
        <item name="cornerRadius">@dimen/card_corner_radius</item>
    </style>
    
    <style name="Button.Primary">
        <item name="backgroundTint">@color/primary</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <style name="Button.Secondary">
        <item name="backgroundTint">@color/card_background</item>
        <item name="android:textColor">@color/text_primary</item>
    </style>
    
    <style name="Button.Danger">
        <item name="backgroundTint">@color/button_danger</item>
        <item name="android:textColor">@android:color/white</item>
    </style>
    
    <!-- Card Styles -->
    <style name="Card" parent="Widget.MaterialComponents.CardView">
        <item name="cardCornerRadius">@dimen/card_corner_radius</item>
        <item name="cardElevation">@dimen/card_elevation</item>
        <item name="cardBackgroundColor">@color/card_background</item>
    </style>
</resources>
```

---

## ğŸ“‚ File Splitting Rules (NguyÃªn táº¯c tÃ¡ch file)

### âš ï¸ HÆ°á»›ng dáº«n cho AI - LUÃ”N SPLIT Ä‘á»ƒ Clean Architecture

**LUÃ”N split resources theo category** - khÃ´ng phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng items. Äiá»u nÃ y giÃºp:
- Code dá»… maintain, dá»… tÃ¬m kiáº¿m
- Chuáº©n bá»‹ cho scale up
- Consistent across all projects
- Dá»… review vÃ  merge code

**NguyÃªn táº¯c: 1 file = 1 purpose**

| Resource | Split thÃ nh | LuÃ´n tÃ¡ch |
|----------|-------------|-----------|
| `colors.xml` | `colors_brand.xml`, `colors_text.xml`, `colors_ui.xml` | âœ… |
| `dimens.xml` | `dimens_text.xml`, `dimens_spacing.xml`, `dimens_component.xml` | âœ… |
| `strings.xml` | `strings_[feature].xml` theo mÃ n hÃ¬nh/feature | âœ… |
| `styles.xml` | `styles_shared.xml`, `styles_button.xml`, `styles_dialog.xml` | âœ… |

### ğŸ¤– AI Workflow khi Ä‘Æ°á»£c yÃªu cáº§u Split

```
1. Äá»c file hiá»‡n táº¡i, xÃ¡c Ä‘á»‹nh cÃ¡c nhÃ³m theo prefix/semantic
2. Táº¡o file má»›i vá»›i naming: [type]_[category].xml
3. Di chuyá»ƒn items vÃ o file má»›i (giá»¯ nguyÃªn format)
4. File gá»‘c giá»¯ lÃ m reference hoáº·c chá»©a items chung/misc
5. Build verify
6. Náº¿u lÃ  strings: cáº­p nháº­t cáº£ values-vi/
```

### ğŸ“Š VÃ­ dá»¥ phÃ¢n tÃ­ch trÆ°á»›c khi split

```xml
<!-- PhÃ¢n tÃ­ch strings.xml -->
<!-- NhÃ³m theo prefix: -->
<!-- nav_* : 5 items â†’ strings_navigation.xml -->
<!-- alarm_* : 25 items â†’ strings_alarm.xml -->
<!-- dialog_* : 18 items â†’ strings_dialog.xml -->
<!-- toast_* : 8 items â†’ strings_toast.xml -->
<!-- profile_* : 12 items â†’ strings_profile.xml -->
<!-- misc (khÃ´ng prefix) â†’ giá»¯ trong strings.xml -->
```

---

### Khi nÃ o nÃªn tÃ¡ch file má»›i?

| TÃ¬nh huá»‘ng | HÃ nh Ä‘á»™ng |
|------------|-----------|
| Code duplicate â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh Utils class |
| Layout dÃ¹ng â‰¥ 2 nÆ¡i | TÃ¡ch thÃ nh `layout_[name].xml` Ä‘á»ƒ include |
| File > 300 lines | CÃ¢n nháº¯c tÃ¡ch thÃ nh helper classes |
| NhÃ³m constants > 10 | TÃ¡ch thÃ nh Constants class |
| Feature má»›i Ä‘á»™c láº­p | Táº¡o Activity/Fragment riÃªng |

### 1. Java Files - TÃ¡ch theo chá»©c nÄƒng

```
NguyÃªn táº¯c: 1 class = 1 file, tÃ¡ch theo Single Responsibility
```

| Category | MÃ´ táº£ | Äáº·t á»Ÿ |
|----------|-------|-------|
| **Activities** | MÃ n hÃ¬nh chÃ­nh, lifecycle | `com/package/` |
| **Fragments** | UI components trong Activity | `com/package/` |
| **Models** | Data classes (POJO) | `com/package/` hoáº·c `models/` |
| **Adapters** | RecyclerView/ListView adapters | `com/package/` |
| **Services** | Background services | `com/package/` |
| **Utils** | Helper/Utility classes | `com/package/utils/` |
| **Database** | DB helper, DAO | `com/package/` |

**VÃ­ dá»¥ tÃ¡ch Utils:**
```java
// TrÆ°á»›c: Code láº·p láº¡i trong nhiá»u file
// MainList.java, MainAdd.java Ä‘á»u cÃ³ setDialogWidth()

// Sau: TÃ¡ch thÃ nh utility class
// utils/DialogUtils.java
public class DialogUtils {
    public static void setDialogWidth(Dialog dialog, Context context) {
        // Centralized logic
    }
}
```

### 2. Layout Files - TÃ¡ch theo prefix

```
NguyÃªn táº¯c: Prefix cho biáº¿t loáº¡i vÃ  scope sá»­ dá»¥ng
```

| Prefix | DÃ¹ng cho | VÃ­ dá»¥ |
|--------|----------|-------|
| `activity_` | Activity layouts | `activity_main.xml` |
| `main_` | Fragment layouts (main tabs) | `main_schedule.xml` |
| `dialog_` | Dialog layouts | `dialog_add_alarm.xml` |
| `shared_` | Reusable components | `shared_item_alarm.xml` |
| `item_` | List item layouts | `item_sound.xml` |

**Khi nÃ o táº¡o shared layout:**
- Component Ä‘Æ°á»£c dÃ¹ng â‰¥ 2 nÆ¡i
- List item layouts dÃ¹ng chung
- Common headers, footers

### 2.1. Layout Sections - TÃ¡ch layout lá»›n thÃ nh sections

```
NguyÃªn táº¯c: Khi layout file > 200 lines hoáº·c cÃ³ nhiá»u sections rÃµ rÃ ng, tÃ¡ch thÃ nh cÃ¡c file nhá» vÃ  dÃ¹ng <include>
```

**Naming Pattern:**

| Layout Type | Section Pattern | VÃ­ dá»¥ |
|-------------|-----------------|-------|
| Fragment | `[fragment_name]_section_[name].xml` | `main_profile_section_header.xml`, `main_schedule_section_list.xml` |
| Activity | `[activity_name]_section_[name].xml` | `activity_settings_section_toolbar.xml` |
| Dialog | `[dialog_name]_section_[name].xml` | `dialog_alarm_section_time_picker.xml` |

> **LÆ°u Ã½:** Section file pháº£i cÃ³ prefix lÃ  tÃªn file parent Ä‘á»ƒ dá»… dÃ ng biáº¿t thuá»™c vá» layout nÃ o.

**VÃ­ dá»¥ tÃ¡ch `main_profile.xml`:**

```
TrÆ°á»›c: main_profile.xml (500+ lines)
â”œâ”€â”€ Header section
â”œâ”€â”€ App Settings section  
â”œâ”€â”€ Permissions section
â”œâ”€â”€ About section
â””â”€â”€ Footer section

Sau:
â”œâ”€â”€ main_profile.xml (container + includes)
â”œâ”€â”€ main_profile_section_header.xml
â”œâ”€â”€ main_profile_section_app_settings.xml
â”œâ”€â”€ main_profile_section_permissions.xml
â”œâ”€â”€ main_profile_section_about.xml
â””â”€â”€ main_profile_section_footer.xml
```

**1. Main layout (container):**

```xml
<!-- main_profile.xml -->
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="?attr/contentBackground">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Header -->
        <include layout="@layout/main_profile_section_header" />

        <!-- App Settings -->
        <include layout="@layout/main_profile_section_app_settings" />

        <!-- Permissions -->
        <include layout="@layout/main_profile_section_permissions" />

        <!-- About -->
        <include layout="@layout/main_profile_section_about" />

    </LinearLayout>
</ScrollView>
```

**2. Section layout:**

```xml
<!-- main_profile_section_app_settings.xml -->
<?xml version="1.0" encoding="utf-8"?>
<androidx.cardview.widget.CardView 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginBottom="@dimen/spacing_normal"
    app:cardBackgroundColor="?attr/cardBackground"
    app:cardCornerRadius="@dimen/card_corner_radius"
    app:cardElevation="@dimen/card_elevation">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">

        <!-- Section Title -->
        <TextView
                return Settings.canDrawOverlays(requireContext());
                
            case "accessibility":
                return isAccessibilityServiceEnabled();
                
            case "notification":
                NotificationManagerCompat nm = NotificationManagerCompat.from(requireContext());
                return nm.areNotificationsEnabled();
                
            case "battery_optimization":
                PowerManager pm = (PowerManager) requireContext().getSystemService(Context.POWER_SERVICE);
                return pm.isIgnoringBatteryOptimizations(requireContext().getPackageName());
                
            default:
                return false;
        }
    } else {
        return ContextCompat.checkSelfPermission(requireContext(), permission) 
            == PackageManager.PERMISSION_GRANTED;
    }
}

private boolean isAccessibilityServiceEnabled() {
    String serviceName = requireContext().getPackageName() + "/.YourAccessibilityService";
    String enabledServices = Settings.Secure.getString(
        requireContext().getContentResolver(),
        Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES);
    return enabledServices != null && enabledServices.contains(serviceName);
}
```

**4. Open permission settings:**

```java
private void openPermissionSettings(PermissionInfo permInfo) {
    Intent intent = null;
    
    if (permInfo.isSpecial) {
        switch (permInfo.permission) {
            case "overlay":
                intent = new Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION,
                    Uri.parse("package:" + requireContext().getPackageName()));
                break;
                
            case "accessibility":
                intent = new Intent(Settings.ACTION_ACCESSIBILITY_SETTINGS);
                break;
                
            case "notification":
                intent = new Intent(Settings.ACTION_APP_NOTIFICATION_SETTINGS);
                intent.putExtra(Settings.EXTRA_APP_PACKAGE, requireContext().getPackageName());
                break;
                
            case "battery_optimization":
                intent = new Intent(Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS,
                    Uri.parse("package:" + requireContext().getPackageName()));
                break;
        }
    } else {
        // Regular permission - open app settings
        intent = new Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS,
            Uri.parse("package:" + requireContext().getPackageName()));
    }
    
    if (intent != null) {
        startActivity(intent);
    }
}
```

**5. Request multiple regular permissions:**

```java
private void requestMissingPermissions() {
    List<String> permissionsToRequest = new ArrayList<>();
    
    for (PermissionInfo permInfo : getAppPermissions()) {
        if (!permInfo.isSpecial && 
            ContextCompat.checkSelfPermission(requireContext(), permInfo.permission) 
                != PackageManager.PERMISSION_GRANTED) {
            permissionsToRequest.add(permInfo.permission);
        }
    }
    
    if (!permissionsToRequest.isEmpty()) {
        ActivityCompat.requestPermissions(requireActivity(),
            permissionsToRequest.toArray(new String[0]),
            PERMISSION_REQUEST_CODE);
    }
}

@Override
public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, 
        @NonNull int[] grantResults) {
    super.onRequestPermissionsResult(requestCode, permissions, grantResults);
    if (requestCode == PERMISSION_REQUEST_CODE) {
        displayPermissionsStatus(); // Refresh UI
    }
}
```

### Permission Strings

```xml
<!-- values/strings.xml -->
<string name="permissions_title">Permissions</string>
<string name="grant_permissions">Grant Permissions</string>
<string name="permission_status">Permission Status</string>

<!-- Phone -->
<string name="permission_phone_name">Phone State</string>
<string name="permission_phone_desc">Detect incoming calls to block unwanted numbers</string>

<!-- Contacts -->
<string name="permission_contacts_name">Contacts</string>
<string name="permission_contacts_desc">Show caller name from contacts</string>

<!-- Overlay -->
<string name="permission_overlay_name">Display Over Apps</string>
<string name="permission_overlay_desc">Show caller info popup during calls</string>

<!-- Accessibility -->
<string name="permission_accessibility_name">Accessibility Service</string>
<string name="permission_accessibility_desc">Automatically dismiss alarm when gesture detected</string>

<!-- values-vi/strings.xml -->
<string name="permissions_title">Quyá»n á»©ng dá»¥ng</string>
<string name="grant_permissions">Cáº¥p quyá»n</string>
<string name="permission_status">Tráº¡ng thÃ¡i quyá»n</string>

<string name="permission_phone_name">Tráº¡ng thÃ¡i Ä‘iá»‡n thoáº¡i</string>
<string name="permission_phone_desc">PhÃ¡t hiá»‡n cuá»™c gá»i Ä‘áº¿n Ä‘á»ƒ cháº·n sá»‘ khÃ´ng mong muá»‘n</string>

<string name="permission_contacts_name">Danh báº¡</string>
<string name="permission_contacts_desc">Hiá»ƒn thá»‹ tÃªn ngÆ°á»i gá»i tá»« danh báº¡</string>

<string name="permission_overlay_name">Hiá»ƒn thá»‹ trÃªn á»©ng dá»¥ng</string>
<string name="permission_overlay_desc">Hiá»ƒn thá»‹ popup thÃ´ng tin ngÆ°á»i gá»i</string>

<string name="permission_accessibility_name">Dá»‹ch vá»¥ trá»£ nÄƒng</string>
<string name="permission_accessibility_desc">Tá»± Ä‘á»™ng táº¯t bÃ¡o thá»©c khi phÃ¡t hiá»‡n cá»­ chá»‰</string>
```

### Required Drawables

```
res/drawable/
â”œâ”€â”€ ic_check_circle.xml    # Checkmark icon (24dp, success color)
â”œâ”€â”€ ic_cancel.xml          # X icon (24dp, error color)
â””â”€â”€ ic_expand_more.xml     # Expand arrow (24dp)
```

### Refresh on Resume

```java
@Override
public void onResume() {
    super.onResume();
    // Refresh permissions when returning from settings
    displayPermissionsStatus();
}
```

### Collapsible Section Toggle

```java
private boolean isPermissionsExpanded = false;

private void togglePermissionsSection() {
    isPermissionsExpanded = !isPermissionsExpanded;
    
    permissionsContainer.setVisibility(
        isPermissionsExpanded ? View.VISIBLE : View.GONE);
    
    ivExpandCollapse.setRotation(isPermissionsExpanded ? 180f : 0f);
}
```

### ğŸ“‹ Permission Flow Overview

**Permissions trong app Ä‘Æ°á»£c hiá»ƒn thá»‹ á»Ÿ 2 nÆ¡i:**

| Vá»‹ trÃ­ | Khi nÃ o hiá»ƒn thá»‹ | Má»¥c Ä‘Ã­ch |
|--------|------------------|----------|
| **1. Terms Dialog** | Láº§n Ä‘áº§u tiÃªn user má»Ÿ app | Giáº£i thÃ­ch Táº¤T Cáº¢ quyá»n app cáº§n vÃ  lÃ½ do cáº§n quyá»n Ä‘Ã³ |
| **2. Profile Screen - Permission Section** | Báº¥t ká»³ lÃºc nÃ o user vÃ o Profile | Hiá»ƒn thá»‹ status (Granted/Denied) vÃ  cho phÃ©p cáº¥p quyá»n |

**Permission Flow:**

```
User má»Ÿ app láº§n Ä‘áº§u
    â†“
Terms Dialog hiá»ƒn thá»‹
    â”œâ”€ Icon + Permission Name + Reason (cho Táº¤T Cáº¢ permissions)
    â”œâ”€ User Ä‘á»c vÃ  accept terms
    â””â”€ Sau khi accept, KHÃ”NG tá»± Ä‘á»™ng request permissions
    
User vÃ o Profile Screen
    â†“
Permission Section hiá»ƒn thá»‹
    â”œâ”€ Má»—i permission cÃ³: Name, Description, Status
    â”œâ”€ Náº¿u Denied â†’ Hiá»‡n button "Grant Permission"
    â””â”€ Click button â†’ Má»Ÿ Settings Ä‘á»ƒ user cáº¥p quyá»n thá»§ cÃ´ng
    
User quay láº¡i Profile
    â†“
onResume() â†’ Refresh permissions status
```

**âš ï¸ Quan trá»ng:**
- Terms Dialog chá»‰ show **Má»˜T Láº¦N DUY NHáº¤T** khi first launch
- Terms Dialog **KHÃ”NG request permissions** - chá»‰ giáº£i thÃ­ch
- User pháº£i vÃ o Profile â†’ Permission Section â†’ Click "Grant" Ä‘á»ƒ cáº¥p quyá»n
- Má»—i permission cÃ³ **2 bá»™ strings riÃªng biá»‡t**:
  - Terms strings: `term_xxx_name`, `term_xxx_reason` (cho Terms Dialog)
  - Permission strings: `permission_xxx_name`, `permission_xxx_desc` (cho Profile)

### âš ï¸ Permission Synchronization Rule (QUAN TRá»ŒNG)

```
RULE: Khi thÃªm/xÃ³a/sá»­a quyá»n, PHáº¢I Ä‘á»“ng bá»™ á»Ÿ Táº¤T Cáº¢ 3 nÆ¡i:
1. AndroidManifest.xml - Khai bÃ¡o quyá»n
2. Terms Dialog (MainActivity) - Giáº£i thÃ­ch quyá»n cho user láº§n Ä‘áº§u
3. Permission Section (MainProfile) - Hiá»ƒn thá»‹ tráº¡ng thÃ¡i vÃ  cho phÃ©p cáº¥p quyá»n
```

**Checklist khi thÃªm quyá»n má»›i:**

| # | Vá»‹ trÃ­ | File | Action |
|---|--------|------|--------|
| 1 | **Manifest** | `AndroidManifest.xml` | ThÃªm `<uses-permission>` |
| 2 | **Terms Dialog** | `MainActivity.java` â†’ `getPermissionTerms()` | ThÃªm `PermissionTerm` má»›i |
| 3 | **Terms Strings** | `strings_terms.xml` (EN + VI) | ThÃªm `term_xxx_name` vÃ  `term_xxx_reason` |
| 4 | **Permission Section** | `MainProfile.java` â†’ `getAppPermissions()` | ThÃªm `PermissionInfo` má»›i |
| 5 | **Permission Strings** | `strings_profile.xml` (EN + VI) | ThÃªm `xxx_permission` vÃ  `xxx_permission_description` |
| 6 | **Check Logic** | `MainProfile.java` â†’ `checkPermission()` | ThÃªm case xá»­ lÃ½ (náº¿u special permission) |
| 7 | **Open Settings** | `MainProfile.java` â†’ `openPermissionSettings()` | ThÃªm Intent má»Ÿ settings (náº¿u special permission) |

**Mapping quyá»n phá»• biáº¿n:**

| Permission | Manifest | Special Key | Settings Intent |
|------------|----------|-------------|-----------------|
| Notification (Android 13+) | `POST_NOTIFICATIONS` | No | `requestPermissions()` |
| Exact Alarm (Android 12+) | `SCHEDULE_EXACT_ALARM` | `"exact_alarm"` | `ACTION_REQUEST_SCHEDULE_EXACT_ALARM` |
| Overlay | `SYSTEM_ALERT_WINDOW` | `"overlay"` | `ACTION_MANAGE_OVERLAY_PERMISSION` |
| Accessibility | *(no manifest)* | `"accessibility"` | `ACTION_ACCESSIBILITY_SETTINGS` |
| Battery Optimization | `REQUEST_IGNORE_BATTERY_OPTIMIZATIONS` | `"battery"` | `ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS` |
| Full Screen Intent | `USE_FULL_SCREEN_INTENT` | *(auto granted)* | N/A |

**VÃ­ dá»¥ thÃªm quyá»n Overlay:**

```java
// 1. AndroidManifest.xml
<uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />

// 2. MainActivity.java - getPermissionTerms()
new TermsDialog.PermissionTerm(
    R.drawable.ic_overlay,
    getString(R.string.term_overlay_name),
    getString(R.string.term_overlay_reason)
)

// 3. MainProfile.java - getAppPermissions()
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
    permissions.add(new PermissionInfo(
        getString(R.string.overlay_permission),
        getString(R.string.overlay_permission_description),
        "overlay",
        true  // isSpecial = true
    ));
}

// 4. MainProfile.java - checkPermission()
case "overlay":
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
        return Settings.canDrawOverlays(requireContext());
    }
    return true;

// 5. MainProfile.java - openPermissionSettings()
case "overlay":
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
        intent = new Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION,
            Uri.parse("package:" + requireContext().getPackageName()));
    }
    break;
```

**âš ï¸ LÆ°u Ã½ cho AI:**
- Khi user yÃªu cáº§u thÃªm tÃ­nh nÄƒng cáº§n quyá»n má»›i â†’ Kiá»ƒm tra vÃ  Ä‘á»“ng bá»™ cáº£ 3 nÆ¡i
- Khi review code â†’ Äáº£m báº£o permissions Ä‘á»“ng bá»™ giá»¯a Manifest, Terms vÃ  Profile
- Náº¿u thiáº¿u á»Ÿ báº¥t ká»³ nÆ¡i nÃ o â†’ BÃ¡o lá»—i vÃ  suggest fix

---

## ğŸ“± Bottom Navigation Rules

### Label Visibility Mode

**LUÃ”N** sá»­ dá»¥ng `labelVisibilityMode="selected"` cho Bottom Navigation Ä‘á»ƒ:
- Chá»‰ hiá»ƒn thá»‹ text label khi item Ä‘Æ°á»£c chá»n
- Giá»¯ UI clean vÃ  gá»n gÃ ng
- TÄƒng khÃ´ng gian cho icon
- Consistent vá»›i Material Design best practices

```xml
<com.google.android.material.bottomnavigation.BottomNavigationView
    android:id="@+id/bottomNavigation"
    android:layout_width="0dp"
    android:layout_height="70dp"
    android:background="@color/card_background"
    android:elevation="8dp"
    app:labelVisibilityMode="selected"
    app:menu="@menu/bottom_nav_menu"
    app:itemIconTint="@color/bottom_nav_color"
    app:itemTextColor="@color/bottom_nav_color"
    app:itemBackground="@drawable/bottom_nav_item_background"
    app:itemRippleColor="@color/button_ripple"
    app:itemIconSize="24dp"
    app:itemPaddingTop="8dp"
    app:itemPaddingBottom="8dp"
    app:layout_constraintBottom_toBottomOf="parent"
    app:layout_constraintStart_toStartOf="parent"
    app:layout_constraintEnd_toEndOf="parent" />
```

### âŒ KHÃ”NG dÃ¹ng

```xml
<!-- âŒ Hiá»ƒn thá»‹ táº¥t cáº£ labels -->
app:labelVisibilityMode="labeled"

<!-- âŒ KhÃ´ng hiá»ƒn thá»‹ label nÃ o -->
app:labelVisibilityMode="unlabeled"
```

### âœ… LUÃ”N dÃ¹ng

```xml
<!-- âœ… Chá»‰ hiá»ƒn thá»‹ label khi selected -->
app:labelVisibilityMode="selected"
```

### Required Resources

**1. Color Selector (`res/color/bottom_nav_color.xml`):**

```xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:color="@color/primary" android:state_checked="true" />
    <item android:color="@color/text_hint" />
</selector>
```

**2. Item Background (`res/drawable/bottom_nav_item_background.xml`):**

```xml
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_checked="true">
        <shape android:shape="rectangle">
            <solid android:color="@color/button_ripple" />
            <corners android:radius="12dp" />
        </shape>
    </item>
    <item>
        <shape android:shape="rectangle">
            <solid android:color="@android:color/transparent" />
        </shape>
    </item>
</selector>
```

---

## ğŸ¨ Theme & Settings

### Theme System Architecture

App há»— trá»£ Light/Dark mode vá»›i custom theme attributes Ä‘á»ƒ Ä‘áº£m báº£o consistency.

### âš ï¸ Required Files cho Theme (QUAN TRá»ŒNG)

Äá»ƒ theme hoáº¡t Ä‘á»™ng Ä‘Ãºng trong cáº£ Light vÃ  Dark mode, project **Báº®T BUá»˜C** pháº£i cÃ³ cÃ¡c files sau:

| File | ÄÆ°á»ng dáº«n | Má»¥c Ä‘Ã­ch |
|------|-----------|----------|
| `attrs.xml` | `values/attrs.xml` | Äá»‹nh nghÄ©a custom theme attributes |
| `styles_theme.xml` | `values/styles_theme.xml` | Light theme vá»›i NoActionBar |
| `styles_theme.xml` | `values-night/styles_theme.xml` | Dark theme |
| `colors_background.xml` | `values/colors_background.xml` | Background colors cho light mode |
| `colors_background.xml` | `values-night/colors_background.xml` | Background colors cho dark mode |
| `colors_text.xml` | `values/colors_text.xml` | Text colors cho light mode |
| `colors_text.xml` | `values-night/colors_text.xml` | Text colors cho dark mode |
| `colors_brand.xml` | `values/colors_brand.xml` | Pháº£i cÃ³ `primary` VÃ€ `primary_dark` |
| `dialog_background.xml` | `drawable/dialog_background.xml` | Dialog rounded corners background |

### âŒ Lá»—i thÆ°á»ng gáº·p khi thiáº¿u files

| Thiáº¿u file | Lá»—i | Háº­u quáº£ |
|------------|-----|---------|
| `attrs.xml` | Build error: attribute not found | Theme attributes nhÆ° `?attr/cardBackground` khÃ´ng hoáº¡t Ä‘á»™ng |
| `values-night/styles_theme.xml` | Dark mode khÃ´ng cÃ³ theme riÃªng | App dÃ¹ng light theme trong dark mode |
| `primary_dark` color | Build error: resource not found | Theme khÃ´ng compile Ä‘Æ°á»£c |
| `dialog_background.xml` | Build error | Dialog layouts bá»‹ lá»—i |

### Theme Style - PHáº¢I dÃ¹ng NoActionBar

```xml
<!-- âŒ SAI - Theme cÅ© vá»›i ActionBar -->
<style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar">

<!-- âœ… ÄÃšNG - Material Components vá»›i NoActionBar -->
<style name="AppTheme" parent="Theme.MaterialComponents.Light.NoActionBar">
```

**1. Custom Theme Attributes (`attrs.xml`):**

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <!-- Custom theme attributes for Light/Dark mode -->
    <attr name="headerBackground" format="color|reference" />
    <attr name="headerTextColor" format="color|reference" />
    <attr name="cardBackground" format="color|reference" />
    <attr name="contentBackground" format="color|reference" />
    <attr name="bottomNavBackground" format="color|reference" />
    <attr name="dividerColor" format="color|reference" />
</resources>
```

**2. Light Theme (`values/styles_theme.xml`):**

```xml
<style name="Theme.App" parent="Theme.MaterialComponents.Light.NoActionBar">
    <!-- Primary Colors -->
    <item name="colorPrimary">@color/primary</item>
    <item name="colorPrimaryDark">@color/primary_dark</item>
    <item name="colorAccent">@color/primary</item>
    
    <!-- Custom Attributes -->
    <item name="headerBackground">@color/primary</item>
    <item name="headerTextColor">@color/white</item>
    <item name="cardBackground">@color/card_background</item>
    <item name="contentBackground">@color/background_light</item>
    <item name="bottomNavBackground">@color/background_white</item>
    <item name="dividerColor">@color/divider</item>
</style>
```

**3. Dark Theme (`values-night/styles_theme.xml`):**

```xml
<style name="Theme.App" parent="Theme.MaterialComponents.NoActionBar">
    <!-- Custom Attributes for Dark Mode -->
    <item name="headerBackground">@color/background_dark</item>
    <item name="headerTextColor">@color/white</item>
    <item name="cardBackground">@color/card_background</item>
    <item name="contentBackground">@color/background_dark</item>
    <item name="bottomNavBackground">@color/card_background</item>
    <item name="dividerColor">@color/divider</item>
</style>
```

**4. Dark Color Overrides (`values-night/colors_*.xml`):**

```xml
<!-- values-night/colors_text.xml -->
<color name="text_primary">#FFFFFF</color>
<color name="text_secondary">#B0B0B0</color>
<color name="text_hint">#757575</color>

<!-- values-night/colors_background.xml -->
<color name="background_dark">#121212</color>
<color name="card_background">#1E1E1E</color>
```

### Theme-aware Colors trong Layout

#### âš ï¸ QUAN TRá»ŒNG: KhÃ´ng dÃ¹ng hardcoded dark colors

Äá»ƒ UI hoáº¡t Ä‘á»™ng Ä‘Ãºng trong cáº£ Light vÃ  Dark mode, **KHÃ”NG** sá»­ dá»¥ng colors cÃ³ suffix `_dark` cá»©ng trong layout.

```xml
<!-- âŒ SAI - Hardcoded dark colors, khÃ´ng Ä‘á»•i theo theme -->
<LinearLayout
    android:background="@color/background_dark">
    
    <CardView
        app:cardBackgroundColor="@color/card_background_dark">
        
        <TextView
            android:textColor="@color/white"/>
    </CardView>
</LinearLayout>
```

```xml
<!-- âœ… ÄÃšNG - Theme-aware colors, tá»± Ä‘á»™ng Ä‘á»•i theo Light/Dark mode -->
<LinearLayout
    android:background="@color/background_light">
    
    <CardView
        app:cardBackgroundColor="@color/card_background">
        
        <TextView
            android:textColor="@color/text_primary"/>
    </CardView>
</LinearLayout>
```

#### Báº£ng mapping Colors cho Light/Dark Mode

| Purpose | Light Mode Color | Dark Mode Color | Sá»­ dá»¥ng |
|---------|------------------|-----------------|---------|
| Main background | `background_light` (#F5F5F5) | `background_light` (#121212) | `@color/background_light` |
| Card background | `card_background` (#FFFFFF) | `card_background` (#2D2D2D) | `@color/card_background` |
| Primary text | `text_primary` (#212121) | `text_primary` (#FFFFFF) | `@color/text_primary` |
| Secondary text | `text_secondary` (#757575) | `text_secondary` (#B0B0B0) | `@color/text_secondary` |
| Divider | `divider` (#E0E0E0) | `divider` (#3D3D3D) | `@color/divider` |

**LÆ°u Ã½:** CÃ¹ng tÃªn color (`card_background`) nhÆ°ng giÃ¡ trá»‹ khÃ¡c nhau á»Ÿ `values/` vÃ  `values-night/`. Android tá»± Ä‘á»™ng chá»n Ä‘Ãºng giÃ¡ trá»‹.

#### Color Files Structure

```
res/
â”œâ”€â”€ values/                          # Light Mode (default)
â”‚   â”œâ”€â”€ colors_background.xml       # background_light=#F5F5F5, card_background=#FFFFFF
â”‚   â”œâ”€â”€ colors_text.xml             # text_primary=#212121
â”‚   â””â”€â”€ colors_ui.xml               # divider=#E0E0E0
â”‚
â””â”€â”€ values-night/                    # Dark Mode (override)
    â”œâ”€â”€ colors_background.xml       # background_light=#121212, card_background=#2D2D2D
    â”œâ”€â”€ colors_text.xml             # text_primary=#FFFFFF
    â””â”€â”€ colors_ui.xml               # divider=#3D3D3D
```

#### Khi nÃ o dÃ¹ng color nÃ o?

| Use Case | Color to Use |
|----------|--------------|
| Activity/Fragment background | `@color/background_light` |
| CardView background | `@color/card_background` |
| Dialog background | `@color/card_background` |
| BottomNavigationView | `@color/card_background` |
| List item divider | `@color/divider` |
| Main text content | `@color/text_primary` |
| Label/On-Off text | `@color/text_primary` |
| Hint text | `@color/text_hint` |
| Icon tint | `@color/text_primary` hoáº·c `@color/text_hint` |

### âš ï¸ CardView Rules (QUAN TRá»ŒNG cho Dark Mode)

CardView lÃ  thÃ nh pháº§n **dá»… bá»‹ lá»—i nháº¥t** khi lÃ m dark mode vÃ¬:
- CardView máº·c Ä‘á»‹nh cÃ³ background mÃ u tráº¯ng
- Náº¿u khÃ´ng set `cardBackgroundColor`, nÃ³ sáº½ KHÃ”NG thay Ä‘á»•i theo theme
- Káº¿t quáº£: Card tráº¯ng trÃªn ná»n Ä‘en = UI ráº¥t xáº¥u

#### Báº®T BUá»˜C cho má»i CardView

```xml
<!-- âŒ SAI - Thiáº¿u cardBackgroundColor, sáº½ TRáº®NG trong dark mode -->
<androidx.cardview.widget.CardView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:cardElevation="4dp"
    app:cardCornerRadius="8dp">

<!-- âŒ SAI - DÃ¹ng android:backgroundTint thay vÃ¬ app:cardBackgroundColor -->
<androidx.cardview.widget.CardView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:backgroundTint="@color/card_background">

<!-- âŒ SAI - Hardcode mÃ u tráº¯ng -->
<androidx.cardview.widget.CardView
    app:cardBackgroundColor="@android:color/white">

<!-- âœ… ÄÃšNG - Sá»­ dá»¥ng theme-aware color vá»›i app:cardBackgroundColor -->
<androidx.cardview.widget.CardView
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    app:cardElevation="@dimen/card_elevation"
    app:cardCornerRadius="@dimen/card_corner_radius"
    app:cardBackgroundColor="@color/card_background">
```

#### Sá»­ dá»¥ng Card Style

Tá»‘t hÆ¡n ná»¯a, Ä‘á»‹nh nghÄ©a style trong `styles_shared.xml` vÃ  sá»­ dá»¥ng:

```xml
<!-- values/styles_shared.xml -->
<style name="Card" parent="CardView">
    <item name="cardElevation">@dimen/card_elevation</item>
    <item name="cardCornerRadius">@dimen/card_corner_radius</item>
    <item name="cardBackgroundColor">@color/card_background</item>
</style>

<!-- Sá»­ dá»¥ng trong layout -->
<androidx.cardview.widget.CardView
    style="@style/Card"
    android:layout_width="match_parent"
    android:layout_height="wrap_content">
```

#### Checklist CardView

- [ ] **LUÃ”N** cÃ³ `app:cardBackgroundColor="@color/card_background"`
- [ ] KHÃ”NG dÃ¹ng `android:backgroundTint` cho CardView
- [ ] KHÃ”NG hardcode `@android:color/white`
- [ ] Náº¿u dÃ¹ng style, Ä‘áº£m báº£o style cÃ³ `cardBackgroundColor`
- [ ] Test cáº£ Light vÃ  Dark mode sau khi thÃªm CardView má»›i

### âš ï¸ Color Selector Files (QUAN TRá»ŒNG cho Dark Mode)

Color selector files (`res/color/*.xml`) dÃ¹ng cho `itemIconTint`, `itemTextColor`, `textColor` vá»›i states (checked, pressed, etc.). 

**Váº¥n Ä‘á»:** Náº¿u selector dÃ¹ng **hardcoded hex colors**, Dark Mode sáº½ KHÃ”NG hoáº¡t Ä‘á»™ng!

#### âŒ SAI - Hardcoded Colors trong Selector

```xml
<!-- res/color/bottom_nav_color.xml -->
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- âŒ Hardcoded hex colors - KHÃ”NG Ä‘á»•i theo Dark Mode -->
    <item android:color="#09A3E3" android:state_checked="true" />
    <item android:color="#757575" />
</selector>
```

#### âœ… ÄÃšNG - Color Resource References trong Selector

```xml
<!-- res/color/bottom_nav_color.xml -->
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- âœ… Reference colors - Tá»° Äá»˜NG Ä‘á»•i theo Dark Mode -->
    <item android:color="@color/primary" android:state_checked="true" />
    <item android:color="@color/text_hint" />
</selector>
```

#### Checklist Color Selector Files

- [ ] **KHÃ”NG** dÃ¹ng hardcoded hex colors (`#RRGGBB`)
- [ ] **LUÃ”N** dÃ¹ng color resource references (`@color/xxx`)
- [ ] Äáº£m báº£o colors Ä‘Æ°á»£c reference Ä‘Ã£ cÃ³ Ä‘á»‹nh nghÄ©a trong `values-night/`
- [ ] Files thÆ°á»ng gáº·p cáº§n kiá»ƒm tra:
  - `res/color/bottom_nav_color.xml`
  - `res/color/tab_text_color.xml`
  - `res/color/checkbox_tint.xml`
  - `res/color/button_text_color.xml`

#### Color Mapping cho Selectors

| Use Case | Checked/Selected State | Default State |
|----------|----------------------|---------------|
| Bottom Navigation | `@color/primary` | `@color/text_hint` |
| Tab Layout | `@color/primary` | `@color/text_secondary` |
| Checkbox/Radio | `@color/primary` | `@color/text_hint` |
| Button Text | `@color/white` | `@color/text_primary` |

#### Sá»­ dá»¥ng Theme Attrs trong Layout

```xml
<!-- DÃ¹ng ?attr/ thay vÃ¬ @color/ Ä‘á»ƒ support theme switching -->
<ScrollView
    android:background="?attr/contentBackground">
    
    <androidx.cardview.widget.CardView
        app:cardBackgroundColor="?attr/cardBackground">
        
        <View
            android:background="?attr/dividerColor" />
    </androidx.cardview.widget.CardView>
</ScrollView>
```

## ğŸ‘¤ MainProfile Fragment - Complete Implementation

### Overview

`MainProfile.java` lÃ  Fragment Báº®T BUá»˜C cho má»i app, hiá»ƒn thá»‹:
- User information (náº¿u cÃ³ login)
- App permissions vá»›i status vÃ  action
- Package name vÃ  version info
- App settings (Language, Dark Mode)
- Developer info (About section)

### MainProfile.java - Class Structure

```java
package com.appname;

import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.net.Uri;
import android.os.Bundle;
import android.provider.Settings;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.LinearLayout;
import android.widget.TextView;
import androidx.annotation.NonNull;
import androidx.annotation.Nullable;
import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatDelegate;
import androidx.appcompat.widget.SwitchCompat;
import androidx.core.content.ContextCompat;
import androidx.fragment.app.Fragment;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Locale;

/**
 * Profile Fragment - Settings, Permissions, About
 * 
 * @author Linh.BoDinh
 * @contact support@soft-linm.com
 * @website soft-linm.com
 */
public class MainProfile extends Fragment {
    
    // SharedPreferences
    private static final String PREF_NAME = "app_settings";
    private static final String KEY_DARK_MODE = "dark_mode";
    private static final String KEY_LANGUAGE = "language";
    
    // Views - User Info
    private TextView tvUserName;
    private TextView tvUserEmail;
    
    // Views - Permissions
    private LinearLayout permissionsContainer;
    
    // Views - App Info
    private TextView tvPackageName;
    private TextView tvVersion;
    
    // Views - Settings
    private SwitchCompat switchDarkMode;
    private LinearLayout layoutLanguage;
    private TextView tvCurrentLanguage;
    
    // Views - About
    private TextView tvDeveloper;
    private TextView tvContact;
    private TextView tvWebsite;
    private TextView tvReleaseDate;
    
    private SharedPreferences prefs;
    
    @Nullable
    @Override
    public View onCreateView(@NonNull LayoutInflater inflater, 
                             @Nullable ViewGroup container,
                             @Nullable Bundle savedInstanceState) {
        return inflater.inflate(R.layout.main_profile, container, false);
    }
    
    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);
        
        prefs = requireContext().getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);
        
        initViews(view);
        loadUserInfo();
        loadPermissions();
        loadAppInfo();
        loadSettings();
        loadAboutInfo();
        setupListeners();
    }
    
    @Override
    public void onResume() {
        super.onResume();
        // Refresh permissions status when returning from settings
        loadPermissions();
    }
    
    // ========== INITIALIZATION ==========
    
    private void initViews(View view) {
        // User Info
        tvUserName = view.findViewById(R.id.tvUserName);
        tvUserEmail = view.findViewById(R.id.tvUserEmail);
        
        // Permissions
        permissionsContainer = view.findViewById(R.id.permissionsContainer);
        
        // App Info
        tvPackageName = view.findViewById(R.id.tvPackageName);
        tvVersion = view.findViewById(R.id.tvVersion);
        
        // Settings
        switchDarkMode = view.findViewById(R.id.switchDarkMode);
        layoutLanguage = view.findViewById(R.id.layoutLanguage);
        tvCurrentLanguage = view.findViewById(R.id.tvCurrentLanguage);
        
        // About
        tvDeveloper = view.findViewById(R.id.tvDeveloper);
        tvContact = view.findViewById(R.id.tvContact);
        tvWebsite = view.findViewById(R.id.tvWebsite);
        tvReleaseDate = view.findViewById(R.id.tvReleaseDate);
    }
    
    // ========== USER INFO ==========
    
    private void loadUserInfo() {
        // TODO: Load from SharedPreferences or Firebase Auth
        // Example:
        // String userName = prefs.getString("user_name", "Guest");
        // tvUserName.setText(userName);
    }
    
    // ========== PERMISSIONS ==========
    
    private void loadPermissions() {
        permissionsContainer.removeAllViews();
        
        List<PermissionInfo> permissions = getAppPermissions();
        
        for (PermissionInfo permission : permissions) {
            View permissionView = createPermissionView(permission);
            permissionsContainer.addView(permissionView);
        }
    }
    
    private List<PermissionInfo> getAppPermissions() {
        List<PermissionInfo> permissions = new ArrayList<>();
        
        // Add app-specific permissions here
        // Example for common permissions:
        
        // Phone State Permission (if needed)
        // permissions.add(new PermissionInfo(
        //     getString(R.string.permission_phone_name),
        //     getString(R.string.permission_phone_desc),
        //     android.Manifest.permission.READ_PHONE_STATE,
        //     PermissionInfo.TYPE_NORMAL
        // ));
        
        // Notification Permission (Android 13+)
        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.TIRAMISU) {
            permissions.add(new PermissionInfo(
                getString(R.string.permission_notification_name),
                getString(R.string.permission_notification_desc),
                android.Manifest.permission.POST_NOTIFICATIONS,
                PermissionInfo.TYPE_NORMAL
            ));
        }
        
        return permissions;
    }
    
    private View createPermissionView(PermissionInfo permission) {
        View view = LayoutInflater.from(requireContext())
            .inflate(R.layout.item_permission, permissionsContainer, false);
        
        TextView tvName = view.findViewById(R.id.tvPermissionName);
        TextView tvDesc = view.findViewById(R.id.tvPermissionDesc);
        TextView tvStatus = view.findViewById(R.id.tvPermissionStatus);
        View btnAction = view.findViewById(R.id.btnPermissionAction);
        
        tvName.setText(permission.name);
        tvDesc.setText(permission.description);
        
        boolean granted = checkPermission(permission);
        
        if (granted) {
            tvStatus.setText(R.string.permission_granted);
            tvStatus.setTextColor(ContextCompat.getColor(requireContext(), R.color.success));
            btnAction.setVisibility(View.GONE);
        } else {
            tvStatus.setText(R.string.permission_denied);
            tvStatus.setTextColor(ContextCompat.getColor(requireContext(), R.color.error));
            btnAction.setVisibility(View.VISIBLE);
            btnAction.setOnClickListener(v -> openPermissionSettings(permission));
        }
        
        return view;
    }
    
    private boolean checkPermission(PermissionInfo permission) {
        if (permission.type == PermissionInfo.TYPE_NORMAL) {
            return ContextCompat.checkSelfPermission(requireContext(), 
                permission.permission) == PackageManager.PERMISSION_GRANTED;
        }
        // Add special permission checks here (e.g., SYSTEM_ALERT_WINDOW)
        return false;
    }
    
    private void openPermissionSettings(PermissionInfo permission) {
        Intent intent = new Intent(Settings.ACTION_APPLICATION_DETAILS_SETTINGS);
        Uri uri = Uri.fromParts("package", requireContext().getPackageName(), null);
        intent.setData(uri);
        startActivity(intent);
    }
    
    // ========== APP INFO ==========
    
    private void loadAppInfo() {
        try {
            PackageInfo pInfo = requireContext().getPackageManager()
                .getPackageInfo(requireContext().getPackageName(), 0);
            
            // Package name
            tvPackageName.setText(pInfo.packageName);
            
            // Version
            String version = pInfo.versionName + " (" + pInfo.versionCode + ")";
            tvVersion.setText(getString(R.string.version_format, version));
            
        } catch (PackageManager.NameNotFoundException e) {
            e.printStackTrace();
        }
    }
    
    // ========== SETTINGS ==========
    
    private void loadSettings() {
        // Dark Mode
        boolean isDarkMode = prefs.getBoolean(KEY_DARK_MODE, false);
        switchDarkMode.setChecked(isDarkMode);
        
        // Language
        String language = prefs.getString(KEY_LANGUAGE, "system");
        updateLanguageDisplay(language);
    }
    
    private void updateLanguageDisplay(String language) {
        String display;
        switch (language) {
            case "en":
                display = getString(R.string.language_english);
                break;
            case "vi":
                display = getString(R.string.language_vietnamese);
                break;
            default:
                display = getString(R.string.language_system);
                break;
        }
        tvCurrentLanguage.setText(display);
    }
    
    // ========== ABOUT INFO ==========
    
    private void loadAboutInfo() {
        // Developer
        tvDeveloper.setText(getString(R.string.developer_format, "Linh.BoDinh"));
        
        // Contact
        tvContact.setText(getString(R.string.contact_format, "support@soft-linm.com"));
        
        // Website
        tvWebsite.setText("soft-linm.com");
        
        // Release Date
        long buildTime = BuildConfig.BUILD_TIME;
        String releaseDate = new SimpleDateFormat("dd/MM/yyyy", Locale.getDefault())
            .format(new Date(buildTime));
        tvReleaseDate.setText(getString(R.string.release_date_format, releaseDate));
    }
    
    // ========== LISTENERS ==========
    
    private void setupListeners() {
        // Dark Mode Toggle
        switchDarkMode.setOnCheckedChangeListener((buttonView, isChecked) -> {
            prefs.edit().putBoolean(KEY_DARK_MODE, isChecked).apply();
            if (isChecked) {
                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
            } else {
                AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);
            }
        });
        
        // Language Selection
        layoutLanguage.setOnClickListener(v -> showLanguageDialog());
        
        // Website Click
        tvWebsite.setOnClickListener(v -> {
            Intent intent = new Intent(Intent.ACTION_VIEW, 
                Uri.parse("https://soft-linm.com"));
            startActivity(intent);
        });
        
        // Email Click
        tvContact.setOnClickListener(v -> {
            Intent intent = new Intent(Intent.ACTION_SENDTO);
            intent.setData(Uri.parse("mailto:support@soft-linm.com"));
            intent.putExtra(Intent.EXTRA_SUBJECT, getString(R.string.app_name) + " - Feedback");
            if (intent.resolveActivity(requireContext().getPackageManager()) != null) {
                startActivity(intent);
            }
        });
    }
    
    private void showLanguageDialog() {
        String[] languages = {
            getString(R.string.language_system),
            getString(R.string.language_english),
            getString(R.string.language_vietnamese)
        };
        String[] langCodes = {"system", "en", "vi"};
        
        String currentLang = prefs.getString(KEY_LANGUAGE, "system");
        int selectedIndex = 0;
        for (int i = 0; i < langCodes.length; i++) {
            if (langCodes[i].equals(currentLang)) {
                selectedIndex = i;
                break;
            }
        }
        
        new AlertDialog.Builder(requireContext())
            .setTitle(R.string.language)
            .setSingleChoiceItems(languages, selectedIndex, (dialog, which) -> {
                prefs.edit().putString(KEY_LANGUAGE, langCodes[which]).apply();
                requireActivity().recreate();
                dialog.dismiss();
            })
            .setNegativeButton(android.R.string.cancel, null)
            .show();
    }
    
    // ========== HELPER CLASSES ==========
    
    public static class PermissionInfo {
        public static final int TYPE_NORMAL = 0;
        public static final int TYPE_SPECIAL = 1;
        
        public String name;
        public String description;
        public String permission;
        public int type;
        
        public PermissionInfo(String name, String description, String permission, int type) {
            this.name = name;
            this.description = description;
            this.permission = permission;
            this.type = type;
        }
    }
}
```

### User Settings Implementation

**1. Application Class (`[AppName]App.java`):**

```java
public class [AppName]App extends Application {
    private static final String PREF_NAME = "app_settings";
    private static final String KEY_DARK_MODE = "dark_mode";

    @Override
    public void onCreate() {
        super.onCreate();
        applyTheme();
    }

    @Override
    protected void attachBaseContext(Context base) {
        super.attachBaseContext(LocaleHelper.applyLanguage(base));
    }

    private void applyTheme() {
        SharedPreferences prefs = getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);
        boolean isDarkMode = prefs.getBoolean(KEY_DARK_MODE, false);
        
        if (isDarkMode) {
            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
        } else {
            AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);
        }
    }
}
```

**2. LocaleHelper (`util/LocaleHelper.java`):**

```java
public class LocaleHelper {
    private static final String PREF_NAME = "app_settings";
    private static final String KEY_LANGUAGE = "language";

    public static Context applyLanguage(Context context) {
        String language = getLanguage(context);
        return applyLanguage(context, language);
    }

    public static Context applyLanguage(Context context, String language) {
        Locale locale;
        if ("system".equals(language)) {
            locale = Resources.getSystem().getConfiguration().getLocales().get(0);
        } else {
            locale = new Locale(language);
        }
        
        Locale.setDefault(locale);
        Configuration config = new Configuration(context.getResources().getConfiguration());
        config.setLocale(locale);
        return context.createConfigurationContext(config);
    }
}
```

**3. Activity Override:**

```java
@Override
protected void attachBaseContext(Context newBase) {
    super.attachBaseContext(LocaleHelper.applyLanguage(newBase));
}
```

**4. AndroidManifest.xml:**

```xml
<application
    android:name=".[AppName]App"
    ... >
```

### Settings UI in Profile

**Layout (`main_profile.xml`):**

```xml
<!-- App Settings Section -->
<androidx.cardview.widget.CardView
    app:cardBackgroundColor="?attr/cardBackground">
    
    <!-- Dark Mode Toggle -->
    <LinearLayout android:orientation="horizontal">
        <TextView android:text="@string/dark_mode" />
        <androidx.appcompat.widget.SwitchCompat
            android:id="@+id/switchDarkMode" />
    </LinearLayout>
    
    <!-- Language Selection -->
    <LinearLayout
        android:id="@+id/layoutLanguage"
        android:clickable="true">
        <TextView android:text="@string/language" />
        <TextView android:id="@+id/tvCurrentLanguage" />
    </LinearLayout>
</androidx.cardview.widget.CardView>
```

**Java Handler:**

```java
// Dark Mode Toggle
switchDarkMode.setOnCheckedChangeListener((buttonView, isChecked) -> {
    prefs.edit().putBoolean(KEY_DARK_MODE, isChecked).apply();
    if (isChecked) {
        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
    } else {
        AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_NO);
    }
});

// Language Selection Dialog
layoutLanguage.setOnClickListener(v -> {
    String[] languages = {"System Default", "English", "Tiáº¿ng Viá»‡t"};
    String[] langCodes = {"system", "en", "vi"};
    
    new AlertDialog.Builder(requireContext())
        .setTitle(R.string.language)
        .setSingleChoiceItems(languages, selectedIndex, (dialog, which) -> {
            prefs.edit().putString(KEY_LANGUAGE, langCodes[which]).apply();
            getActivity().recreate();
            dialog.dismiss();
        })
        .setNegativeButton(android.R.string.cancel, null)
        .show();
});
```

### Strings for Settings

```xml
<!-- values/strings_profile.xml -->
<string name="app_settings">App Settings</string>
<string name="dark_mode">Dark Mode</string>
<string name="dark_mode_description">Switch between light and dark theme</string>
<string name="language">Language</string>
<string name="language_system">System Default</string>
<string name="language_english">English</string>
<string name="language_vietnamese">Tiáº¿ng Viá»‡t</string>

<!-- values-vi/strings_profile.xml -->
<string name="app_settings">CÃ i Ä‘áº·t á»©ng dá»¥ng</string>
<string name="dark_mode">Cháº¿ Ä‘á»™ tá»‘i</string>
<string name="dark_mode_description">Chuyá»ƒn Ä‘á»•i giá»¯a giao diá»‡n sÃ¡ng vÃ  tá»‘i</string>
<string name="language">NgÃ´n ngá»¯</string>
<string name="language_system">Máº·c Ä‘á»‹nh há»‡ thá»‘ng</string>
<string name="language_english">English</string>
<string name="language_vietnamese">Tiáº¿ng Viá»‡t</string>
```

---

## ğŸ” Code Review & Detection Guide

### âš ï¸ REQUIRED: Review Hardcoded Values Before Submit

**RULE:** Má»i code submit PHáº¢I Ä‘Æ°á»£c review Ä‘á»ƒ phÃ¡t hiá»‡n hardcoded strings vÃ  colors.

### 1. Detect Hardcoded Strings in Layout XML

**TÃ¬m hardcoded text trong `android:text`:**
```powershell
# TÃ¬m táº¥t cáº£ android:text vá»›i hardcoded string (khÃ´ng pháº£i @string/)
Get-ChildItem -Path "app\src\main\res\layout" -Filter "*.xml" -Recurse | 
    Select-String 'android:text="[^@]' | 
    Select-Object -Property Path, LineNumber, Line

# Hoáº·c grep Ä‘Æ¡n giáº£n
grep -rn 'android:text="[^@]' app/src/main/res/layout/
```

**TÃ¬m hardcoded hint:**
```powershell
Get-ChildItem -Path "app\src\main\res\layout" -Filter "*.xml" -Recurse | 
    Select-String 'android:hint="[^@]' | 
    Select-Object -Property Path, LineNumber, Line
```

**TÃ¬m hardcoded contentDescription:**
```powershell
Get-ChildItem -Path "app\src\main\res\layout" -Filter "*.xml" -Recurse | 
    Select-String 'android:contentDescription="[^@]' | 
    Select-Object -Property Path, LineNumber, Line
```

**VÃ­ dá»¥ output:**
```
Path                           LineNumber Line
----                           ---------- ----
...layout\main_home.xml        42         android:text="Hello, User!"
...layout\dialog_confirm.xml   15         android:hint="Enter name"
```

**âŒ Hardcoded - Cáº¦N FIX:**
```xml
<TextView android:text="Hello, User!" />
<EditText android:hint="Enter name" />
<ImageButton android:contentDescription="Back button" />
```

**âœ… Correct - String Resources:**
```xml
<TextView android:text="@string/hello_user" />
<EditText android:hint="@string/hint_enter_name" />
<ImageButton android:contentDescription="@string/back" />
```

### 2. Detect Hardcoded Strings in Java Code

**TÃ¬m setText vá»›i hardcoded string:**
```powershell
# TÃ¬m setText("...") - hardcoded string
Get-ChildItem -Path "app\src\main\java" -Filter "*.java" -Recurse | 
    Select-String 'setText\s*\(\s*"' | 
    Select-Object -Property Path, LineNumber, Line

# TÃ¬m Toast.makeText vá»›i hardcoded string
Get-ChildItem -Path "app\src\main\java" -Filter "*.java" -Recurse | 
    Select-String 'Toast\.makeText\s*\([^,]+,\s*"' | 
    Select-Object -Property Path, LineNumber, Line
```

**VÃ­ dá»¥ output:**
```
Path                              LineNumber Line
----                              ---------- ----
...LoginActivity.java             89         tvTitle.setText("Welcome");
...LearnFragment.java             73         Toast.makeText(context, "No topics", LENGTH_SHORT);
```

**âŒ Hardcoded - Cáº¦N FIX:**
```java
tvTitle.setText("Welcome");
Toast.makeText(context, "No topics available", Toast.LENGTH_SHORT).show();
button.setContentDescription("Save button");
```

**âœ… Correct - String Resources:**
```java
tvTitle.setText(R.string.welcome);
tvTitle.setText(getString(R.string.welcome));
Toast.makeText(context, R.string.no_topics, Toast.LENGTH_SHORT).show();
Toast.makeText(context, getString(R.string.no_topics), Toast.LENGTH_SHORT).show();
button.setContentDescription(getString(R.string.save));
```

### 3. Detect Hardcoded Colors (Hex #RRGGBB)

**TÃ¬m hardcoded hex colors trong XML:**
```powershell
# TÃ¬m #RRGGBB hoáº·c #AARRGGBB trong layout
Get-ChildItem -Path "app\src\main\res" -Filter "*.xml" -Recurse | 
    Select-String '#[0-9A-Fa-f]{6,8}' | 
    Where-Object { $_.Line -notmatch '<!--' } |
    Select-Object -Property Path, LineNumber, Line

# Exclude comments
grep -rn '#[0-9A-Fa-f]\{6,8\}' app/src/main/res/ --include="*.xml" | grep -v '<!--'
```

**VÃ­ dá»¥ output:**
```
Path                              LineNumber Line
----                              ---------- ----
...main_home.xml                  25         android:background="#FFFFFF"
...dialog_confirm.xml             10         android:textColor="#212121"
```

**âŒ Hardcoded Colors - Cáº¦N FIX:**
```xml
<View android:background="#FFFFFF" />
<TextView android:textColor="#212121" />
<solid android:color="#FF5722" />
```

**âœ… Correct - Color Resources:**
```xml
<View android:background="@color/background_light" />
<TextView android:textColor="@color/text_primary" />
<solid android:color="@color/primary" />
```

### 4. Detect Hardcoded Dark Colors (Anti-pattern)

**TÃ¬m references Ä‘áº¿n *_dark colors (khÃ´ng nÃªn dÃ¹ng):**
```powershell
# TÃ¬m @color/xxx_dark trong layout
Get-ChildItem -Path "app\src\main\res\layout" -Filter "*.xml" -Recurse | 
    Select-String '@color/\w+_dark' | 
    Select-Object -Property Path, LineNumber, Line
```

**âŒ Dark Color References - Cáº¦N FIX:**
```xml
<View android:background="@color/background_dark" />
<CardView app:cardBackgroundColor="@color/card_background_dark" />
```

**âœ… Correct - Theme-aware Colors:**
```xml
<View android:background="@color/background_light" />
<CardView app:cardBackgroundColor="@color/card_background" />
```

### 5. Complete Review Checklist

**TrÆ°á»›c khi submit code, cháº¡y Táº¤T Cáº¢ commands sau:**

```powershell
# 1. Check hardcoded text in layouts
Write-Host "=== Checking hardcoded text in layouts ===" -ForegroundColor Yellow
Get-ChildItem -Path "app\src\main\res\layout" -Filter "*.xml" -Recurse | 
    Select-String 'android:(text|hint|contentDescription)="[^@]' | 
    Select-Object -Property Path, LineNumber, Line

# 2. Check hardcoded strings in Java
Write-Host "`n=== Checking hardcoded strings in Java ===" -ForegroundColor Yellow
Get-ChildItem -Path "app\src\main\java" -Filter "*.java" -Recurse | 
    Select-String '(setText|makeText|setContentDescription)\s*\([^,]*"' | 
    Select-Object -Property Path, LineNumber, Line

# 3. Check hardcoded hex colors
Write-Host "`n=== Checking hardcoded hex colors ===" -ForegroundColor Yellow
Get-ChildItem -Path "app\src\main\res" -Filter "*.xml" -Recurse | 
    Select-String '#[0-9A-Fa-f]{6,8}' | 
    Where-Object { $_.Line -notmatch '<!--' } |
    Select-Object -Property Path, LineNumber, Line

# 4. Check dark color references (anti-pattern)
Write-Host "`n=== Checking dark color references ===" -ForegroundColor Yellow
Get-ChildItem -Path "app\src\main\res\layout" -Filter "*.xml" -Recurse | 
    Select-String '@color/\w+_dark' | 
    Select-Object -Property Path, LineNumber, Line

Write-Host "`n=== Review Complete ===" -ForegroundColor Green
```

**Káº¿t quáº£ mong Ä‘á»£i:**
- âœ… **KhÃ´ng cÃ³ output** = KhÃ´ng cÃ³ hardcoded values
- âŒ **CÃ³ output** = Cáº¦N FIX trÆ°á»›c khi submit

### 6. AI Assistant Review Workflow

**Khi AI táº¡o/sá»­a code:**

| BÆ°á»›c | Action | Tool |
|------|--------|------|
| 1 | Táº¡o/sá»­a layout XML | `replace_string_in_file` |
| 2 | **Auto-check hardcoded text** | `grep_search` vá»›i pattern `android:text="[^@]` |
| 3 | Táº¡o/sá»­a Java code | `replace_string_in_file` |
| 4 | **Auto-check hardcoded strings** | `grep_search` vá»›i pattern `setText.*"` |
| 5 | **Verify colors** | `grep_search` vá»›i pattern `#[0-9A-Fa-f]{6,8}` |
| 6 | **Show findings to user for confirmation** | Message to user |
| 7 | User confirms which issues to fix | User response |
| 8 | Fix confirmed issues | `replace_string_in_file` |

**âš ï¸ AI PHáº¢I tá»± Ä‘á»™ng check sau má»—i láº§n edit file:**
- Sau khi edit layout â†’ Check hardcoded text
- Sau khi edit Java â†’ Check hardcoded strings
- Sau khi edit colors â†’ Check hex colors

### 6.1. Review Confirmation Process (REQUIRED)

**SAU KHI REVIEW, AI Báº®T BUá»˜C PHáº¢I:**

1. **Hiá»ƒn thá»‹ táº¥t cáº£ issues tÃ¬m Ä‘Æ°á»£c:**
   ```
   Found {X} issues requiring attention:
   
   ### Hardcoded Strings (Layout)
   - âŒ main_home.xml:42 - android:text="Hello, User!"
   - âŒ dialog_confirm.xml:15 - android:hint="Enter name"
   
   ### Hardcoded Strings (Java)
   - âŒ LoginActivity.java:89 - tvTitle.setText("Welcome");
   - âŒ LearnFragment.java:73 - Toast.makeText(context, "No topics", LENGTH_SHORT);
   
   ### Hardcoded Colors
   - âŒ main_profile.xml:25 - android:background="#FFFFFF"
   - âŒ colors.xml:10 - <color name="primary">#09A3E3</color> (OK in color definitions)
   ```

2. **YÃªu cáº§u user confirm:**
   ```
   Would you like me to fix these issues?
   - Type "yes" or "fix all" to fix all issues
   - Type "skip X" to skip specific issue numbers
   - Type "no" or "cancel" to skip fixes
   ```

3. **Match vá»›i user intent:**
   - Náº¿u user nÃ³i "cÃ³" / "ok" / "fix" / "sá»­a háº¿t" â†’ Fix táº¥t cáº£
   - Náº¿u user nÃ³i "skip 3,5" â†’ Fix táº¥t cáº£ trá»« issue #3 vÃ  #5
   - Náº¿u user nÃ³i "khÃ´ng" / "cancel" / "bá» qua" â†’ KhÃ´ng fix gÃ¬
   - Náº¿u user há»i chi tiáº¿t vá» issue â†’ Giáº£i thÃ­ch issue Ä‘Ã³

4. **Sau khi fix:**
   - Report sá»‘ lÆ°á»£ng issues Ä‘Ã£ fix
   - Re-run detection Ä‘á»ƒ verify khÃ´ng cÃ²n issues
   - Update progress file náº¿u cÃ³

**âš ï¸ KHÃ”NG tá»± Ä‘á»™ng fix mÃ  khÃ´ng há»i user trÆ°á»›c!**

**VÃ­ dá»¥ Workflow:**

```
AI: "Found 5 hardcoded strings:
     1. main_home.xml:42 - android:text='Hello'
     2. LoginActivity.java:89 - setText('Welcome')
     3. ...
     
     Fix all these issues?"

User: "skip 2" 

AI: â†’ Fix issues 1, 3, 4, 5
     â†’ Skip issue 2
     â†’ Report: "Fixed 4 out of 5 issues"
```

### 7. Common Exceptions (Allowed Hardcoded Values)

**CÃ¡c trÆ°á»ng há»£p Ä‘Æ°á»£c phÃ©p hardcode:**

| Case | Example | Reason |
|------|---------|--------|
| Layout dimensions (one-time use) | `android:layout_width="48dp"` | Specific to this view only |
| Boolean values | `android:enabled="true"` | Not translatable |
| Numeric values | `android:maxLines="2"` | Not translatable |
| Resource references | `android:src="@drawable/ic_back"` | Already using resources |
| Technical strings (Java) | `String TAG = "MainActivity"` | Log tags, keys - not user-facing |
| URL/Email constants | `String URL = "https://..."` | Configuration constants |

**âš ï¸ LÆ°u Ã½:**
- **User-facing text** â†’ KHÃ”NG BAO GIá»œ Ä‘Æ°á»£c hardcode
- **Colors** â†’ KHÃ”NG BAO GIá»œ Ä‘Æ°á»£c hardcode hex
- **Dimensions dÃ¹ng láº¡i** â†’ NÃªn extract to `@dimen/`

---

## âœ… Checklist cho AI

### Khi táº¡o Activity/Fragment má»›i

- [ ] Class name theo pattern `[Feature]Activity.java` / `Main[Feature].java`
- [ ] Layout file theo pattern `activity_[feature].xml` / `main_[feature].xml`
- [ ] ÄÄƒng kÃ½ Activity trong `AndroidManifest.xml`
- [ ] ThÃªm strings vÃ o **Cáº¢ 2 file**: `values/strings.xml` VÃ€ `values-vi/strings.xml`
- [ ] Follow class structure order

### Khi táº¡o Dialog

- [ ] Táº¡o layout file `dialog_[action].xml`
- [ ] KHÃ”NG dÃ¹ng AlertDialog.Builder vá»›i setTitle/setMessage
- [ ] Inflate layout vá»›i `dialog.setContentView()`
- [ ] Gá»i `DialogUtils.setDialogWidth()` sau `dialog.show()`
- [ ] ThÃªm strings vÃ o **Cáº¢ 2 file**: `values/strings.xml` VÃ€ `values-vi/strings.xml`

### Khi thÃªm Resource

- [ ] Color name theo semantic: `text_primary`, khÃ´ng pháº£i `blue`
- [ ] Dimension name theo type: `spacing_normal`, `text_size_large`
- [ ] String name theo context: `alarm_title`, `dialog_confirm`
- [ ] Style name theo component: `Button.Primary`, `Text.Title`

### Khi thÃªm/sá»­a String (Multi-language) âš ï¸ QUAN TRá»ŒNG

- [ ] ThÃªm string vÃ o `values/strings.xml` (English - default)
- [ ] ThÃªm translation vÃ o `values-vi/strings.xml` (Vietnamese)
- [ ] Äáº£m báº£o string names **GIá»NG NHAU** á»Ÿ cáº£ 2 file
- [ ] Sá»­ dá»¥ng snake_case: `alarm_title`, khÃ´ng pháº£i `alarmTitle`
- [ ] Prefix theo feature: `alarm_`, `dialog_`, `settings_`
- [ ] **Thá»© tá»± tá»« trong tÃªn**: DÃ¹ng `[subject]_[action]` (vÃ­ dá»¥: `topic_selected`, khÃ´ng pháº£i `selected_topic`)
- [ ] **KIá»‚M TRA tÃªn string trong code PHáº¢I KHá»šP vá»›i tÃªn trong XML** (build sáº½ lá»—i náº¿u sai)
- [ ] **KHÃ”NG hardcode text** trong Java code - dÃ¹ng `getString(R.string.xxx)`
- [ ] **KHÃ”NG hardcode text** trong layout - dÃ¹ng `@string/xxx`
- [ ] Toast messages dÃ¹ng: `Toast.makeText(context, R.string.xxx, ...)`
- [ ] Notification text dÃ¹ng: `getString(R.string.xxx)`
- [ ] Technical terms (vibration patterns...) cÃ³ thá»ƒ giá»¯ tiáº¿ng Anh cho cáº£ 2 ngÃ´n ngá»¯

### Khi lÃ m viá»‡c vá»›i Theme/Colors (Light/Dark Mode) âš ï¸ QUAN TRá»ŒNG

- [ ] **KHÃ”NG** dÃ¹ng hardcoded dark colors (`@color/background_dark`, `@color/card_background_dark`)
- [ ] Sá»­ dá»¥ng theme-aware colors (`@color/background_light`, `@color/card_background`)
- [ ] Background cá»§a screens: `@color/background_light`
- [ ] CardView background: `@color/card_background`
- [ ] Text colors: `@color/text_primary`, `@color/text_secondary`
- [ ] Dividers: `@color/divider`
- [ ] Kiá»ƒm tra cáº£ Light vÃ  Dark mode sau khi sá»­a layout

### Khi thÃªm CardView má»›i âš ï¸ QUAN TRá»ŒNG

- [ ] **Báº®T BUá»˜C** cÃ³ `app:cardBackgroundColor="@color/card_background"`
- [ ] KHÃ”NG dÃ¹ng `android:backgroundTint` cho CardView
- [ ] KHÃ”NG hardcode `@android:color/white`
- [ ] Náº¿u dÃ¹ng style, Ä‘áº£m báº£o style cÃ³ `cardBackgroundColor`
- [ ] Test cáº£ Light vÃ  Dark mode

### Khi táº¡o/sá»­a Color Selector Files âš ï¸ QUAN TRá»ŒNG

- [ ] **KHÃ”NG** dÃ¹ng hardcoded hex colors (`#RRGGBB`) trong selector
- [ ] **LUÃ”N** dÃ¹ng color resource references (`@color/xxx`)
- [ ] Kiá»ƒm tra cÃ¡c colors Ä‘Æ°á»£c reference Ä‘Ã£ cÃ³ trong `values-night/`
- [ ] Files cáº§n kiá»ƒm tra: `bottom_nav_color.xml`, `tab_text_color.xml`, `checkbox_tint.xml`
- [ ] Test cáº£ Light vÃ  Dark mode

### Khi táº¡o Project má»›i - Theme Setup Checklist

- [ ] Táº¡o `values/attrs.xml` vá»›i custom theme attributes
- [ ] Táº¡o `values/styles_theme.xml` vá»›i `Theme.MaterialComponents.Light.NoActionBar`
- [ ] Táº¡o `values-night/styles_theme.xml` vá»›i `Theme.MaterialComponents.NoActionBar`
- [ ] Äáº£m báº£o `colors_brand.xml` cÃ³ cáº£ `primary` VÃ€ `primary_dark`
- [ ] Táº¡o `drawable/dialog_background.xml` 
- [ ] Táº¡o color files trong cáº£ `values/` vÃ  `values-night/`
- [ ] Card style trong `styles_shared.xml` pháº£i cÃ³ `cardBackgroundColor`

### Khi táº¡o Project má»›i - Required Screens âš ï¸ Báº®T BUá»˜C

- [ ] **MainProfile.java / ProfileFragment.java** - Profile/Settings screen (REQUIRED)
- [ ] Hiá»ƒn thá»‹ thÃ´ng tin user (náº¿u cÃ³ login)
- [ ] Section quyá»n á»©ng dá»¥ng (permissions) vá»›i status vÃ  action button
- [ ] Package name vÃ  version info
- [ ] CÃ i Ä‘áº·t á»©ng dá»¥ng:
  - [ ] Language selector (System Default, English, Tiáº¿ng Viá»‡t)
  - [ ] Dark Mode toggle (Light/Dark/System)
- [ ] Developer info (About section):
  - [ ] Developer: `Linh.BoDinh`
  - [ ] Contact: `support@soft-linm.com`
  - [ ] Website: `soft-linm.com` (clickable)
  - [ ] Version tá»« `BuildConfig.VERSION_NAME`
  - [ ] Release date tá»« `BuildConfig.BUILD_TIME`
- [ ] Layout: `main_profile.xml` hoáº·c `fragment_profile.xml`
- [ ] Strings: ThÃªm vÃ o `values/strings.xml` vÃ  `values-vi/strings.xml`

### Khi táº¡o Profile/About Screen

- [ ] Hiá»ƒn thá»‹ developer info: `Linh.BoDinh`
- [ ] Hiá»ƒn thá»‹ contact: `support@soft-linm.com`
- [ ] Hiá»ƒn thá»‹ website: `soft-linm.com` vá»›i link clickable
- [ ] Hiá»ƒn thá»‹ version tá»« `BuildConfig.VERSION_NAME`
- [ ] Hiá»ƒn thá»‹ release date tá»« `BuildConfig.BUILD_TIME`
- [ ] ThÃªm `buildConfigField "long", "BUILD_TIME", System.currentTimeMillis() + "L"` vÃ o `build.gradle`
- [ ] ThÃªm strings vÃ o `values/strings.xml` vÃ  `values-vi/strings.xml`
- [ ] Intent má»Ÿ website: `Intent(Intent.ACTION_VIEW, Uri.parse("https://soft-linm.com"))`

### Khi sá»­a code

- [ ] Kiá»ƒm tra code duplicate â†’ tÃ¡ch Utils náº¿u cáº§n
- [ ] Kiá»ƒm tra layout duplicate â†’ táº¡o include layout náº¿u cáº§n
- [ ] Update comments náº¿u logic phá»©c táº¡p
- [ ] Giá»¯ consistent naming vá»›i existing code

### Khi thÃªm Model field

- [ ] ThÃªm field vÃ  getter/setter
- [ ] Update constructor náº¿u cáº§n
- [ ] Update Database: thÃªm column, update version, handle migration
- [ ] Update CRUD methods trong DatabaseHelper

### ğŸ”„ Khi User YÃªu Cáº§u Update/Change Code (QUAN TRá»ŒNG)

```
RULE: Khi thay Ä‘á»•i code, PHáº¢I kiá»ƒm tra vÃ  Ä‘á»“ng bá»™ Táº¤T Cáº¢ cÃ¡c file liÃªn quan
```

**Quy trÃ¬nh xá»­ lÃ½ yÃªu cáº§u thay Ä‘á»•i:**

| BÆ°á»›c | Action | MÃ´ táº£ |
|------|--------|-------|
| 1 | **Analyze** | PhÃ¢n tÃ­ch yÃªu cáº§u, xÃ¡c Ä‘á»‹nh scope thay Ä‘á»•i |
| 2 | **Search** | TÃ¬m táº¥t cáº£ file liÃªn quan (`grep_search`, `file_search`) |
| 3 | **Review** | Äá»c code hiá»‡n táº¡i Ä‘á»ƒ hiá»ƒu context |
| 4 | **Plan** | LÃªn danh sÃ¡ch Táº¤T Cáº¢ file cáº§n sá»­a |
| 5 | **Execute** | Thá»±c hiá»‡n thay Ä‘á»•i Ä‘á»“ng bá»™ |
| 6 | **Verify** | Build vÃ  kiá»ƒm tra lá»—i |

**Checklist Ä‘á»“ng bá»™ theo loáº¡i thay Ä‘á»•i:**

#### Thay Ä‘á»•i liÃªn quan Ä‘áº¿n Permission:
- [ ] `AndroidManifest.xml` - ThÃªm/xÃ³a `<uses-permission>`
- [ ] `MainActivity.java` â†’ `getPermissionTerms()` - Cáº­p nháº­t Terms Dialog
- [ ] `MainProfile.java` â†’ `getAppPermissions()` - Cáº­p nháº­t Permission Section
- [ ] `MainProfile.java` â†’ `checkPermission()` - ThÃªm/sá»­a logic check
- [ ] `MainProfile.java` â†’ `openPermissionSettings()` - ThÃªm/sá»­a Intent
- [ ] `strings_terms.xml` (EN + VI) - ThÃªm/sá»­a strings
- [ ] `strings_profile.xml` (EN + VI) - ThÃªm/sá»­a strings

#### Thay Ä‘á»•i liÃªn quan Ä‘áº¿n Settings/Preferences:
- [ ] `MainProfile.java` - ThÃªm constant `KEY_XXX`
- [ ] `MainProfile.java` â†’ `initViews()` - Bind view
- [ ] `MainProfile.java` â†’ `setupListeners()` - ThÃªm listener
- [ ] `MainProfile.java` â†’ `loadSettings()` - Load giÃ¡ trá»‹
- [ ] Layout file - ThÃªm UI element
- [ ] `strings_profile.xml` (EN + VI) - ThÃªm strings
- [ ] CÃ¡c file sá»­ dá»¥ng setting - Cáº­p nháº­t logic

#### Thay Ä‘á»•i liÃªn quan Ä‘áº¿n UI String:
- [ ] `values/strings_xxx.xml` - English
- [ ] `values-vi/strings_xxx.xml` - Vietnamese
- [ ] Java code - Äá»•i tá»« hardcode sang `getString(R.string.xxx)`
- [ ] Layout XML - Äá»•i tá»« hardcode sang `@string/xxx`

#### Thay Ä‘á»•i liÃªn quan Ä‘áº¿n Color/Theme:
- [ ] `values/colors_xxx.xml` - Light mode
- [ ] `values-night/colors_xxx.xml` - Dark mode
- [ ] Kiá»ƒm tra cáº£ Light vÃ  Dark mode

#### Thay Ä‘á»•i liÃªn quan Ä‘áº¿n Model/Database:
- [ ] Model class - ThÃªm field, getter/setter
- [ ] `DatabaseHelper.java` - Update DATABASE_VERSION
- [ ] `DatabaseHelper.java` â†’ `onCreate()` - Sá»­a CREATE TABLE
- [ ] `DatabaseHelper.java` â†’ `onUpgrade()` - ThÃªm migration
- [ ] `DatabaseHelper.java` - Sá»­a CRUD methods
- [ ] UI code - Hiá»ƒn thá»‹ field má»›i

#### Thay Ä‘á»•i liÃªn quan Ä‘áº¿n Feature Flag/Config:
- [ ] XÃ¡c Ä‘á»‹nh nÆ¡i lÆ°u config (SharedPreferences, Database, etc.)
- [ ] TÃ¬m Táº¤T Cáº¢ nÆ¡i sá»­ dá»¥ng config cÅ©
- [ ] Cáº­p nháº­t key name nháº¥t quÃ¡n
- [ ] XÃ³a code khÃ´ng dÃ¹ng (dead code)

**âš ï¸ Anti-patterns cáº§n trÃ¡nh:**

| âŒ Sai | âœ… ÄÃºng |
|--------|--------|
| Chá»‰ sá»­a 1 file, bá» qua file liÃªn quan | Sá»­a Ä‘á»“ng bá»™ táº¥t cáº£ file |
| Sá»­a code nhÆ°ng khÃ´ng sá»­a strings | Sá»­a cáº£ code vÃ  strings (EN + VI) |
| ThÃªm permission nhÆ°ng khÃ´ng thÃªm vÃ o Terms | Äá»“ng bá»™ Manifest + Terms + Profile |
| Äá»•i tÃªn constant nhÆ°ng khÃ´ng search usages | Search vÃ  replace táº¥t cáº£ usages |
| XÃ³a code nhÆ°ng Ä‘á»ƒ láº¡i strings/resources khÃ´ng dÃ¹ng | Cleanup táº¥t cáº£ dead resources |

**Template cÃ¢u há»i khi nháº­n yÃªu cáº§u:**

```
TrÆ°á»›c khi thá»±c hiá»‡n, AI nÃªn tá»± há»i:
1. Thay Ä‘á»•i nÃ y áº£nh hÆ°á»Ÿng Ä‘áº¿n nhá»¯ng file nÃ o?
2. CÃ³ string nÃ o cáº§n thÃªm/sá»­a khÃ´ng? (EN + VI)
3. CÃ³ permission nÃ o liÃªn quan khÃ´ng? (Manifest + Terms + Profile)
4. CÃ³ setting/preference nÃ o cáº§n Ä‘á»“ng bá»™ khÃ´ng?
5. CÃ³ code nÃ o cáº§n cleanup sau khi Ä‘á»•i khÃ´ng?
```

---

## ğŸ“– Quick Reference

### Common Patterns

```java
// Get context in Fragment
requireContext()

// Get activity in Fragment
requireActivity()

// Safe null check with Optional
if (object != null) { }

// Format time
String.format(Locale.getDefault(), "%02d:%02d", hour, minute)

// Calendar usage
Calendar calendar = Calendar.getInstance();
int hour = calendar.get(Calendar.HOUR_OF_DAY);
int minute = calendar.get(Calendar.MINUTE);
calendar.add(Calendar.MINUTE, 30);

// ActivityResultLauncher (modern way)
private ActivityResultLauncher<Intent> launcher = registerForActivityResult(
    new ActivityResultContracts.StartActivityForResult(),
    result -> {
        if (result.getResultCode() == Activity.RESULT_OK) {
            // Handle result
        }
    }
);
// Usage: launcher.launch(intent);

// SharedPreferences
SharedPreferences prefs = getSharedPreferences("app_prefs", MODE_PRIVATE);
prefs.edit().putBoolean("key", true).apply();
boolean value = prefs.getBoolean("key", false);
```

### Common Resources

```xml
<!-- Clickable background -->
android:background="?android:attr/selectableItemBackground"

<!-- Match parent width, wrap content height -->
android:layout_width="match_parent"
android:layout_height="wrap_content"

<!-- Center content -->
android:gravity="center"
android:layout_gravity="center"

<!-- Weight in LinearLayout -->
android:layout_width="0dp"
android:layout_weight="1"
```

### Deprecated APIs to Avoid

| âŒ Deprecated | âœ… Use Instead |
|--------------|----------------|
| `getResources().getColor(R.color.x)` | `ContextCompat.getColor(context, R.color.x)` |
| `getResources().getDrawable(R.drawable.x)` | `ContextCompat.getDrawable(context, R.drawable.x)` |
| `startActivityForResult()` | `ActivityResultLauncher` |
| `onActivityResult()` | `ActivityResultLauncher` callback |
| `getFragmentManager()` | `getSupportFragmentManager()` |
| `onAttach(Activity)` | `onAttach(Context)` |

---

## ğŸ’¾ Database Export/Import (Storage Access)

### Storage Strategy by Android Version

| Android Version | API Level | Strategy | Permission Required |
|----------------|-----------|----------|---------------------|
| Android 6-9 | 23-28 | Traditional File System | `WRITE_EXTERNAL_STORAGE` |
| Android 10-12 | 29-32 | Scoped Storage (MediaStore) | `READ_EXTERNAL_STORAGE` (optional) |
| Android 13+ | 33+ | Scoped Storage (MediaStore) | âŒ None |

### âš ï¸ CRITICAL: Database Name Consistency

**Báº®T BUá»˜C** sá»­ dá»¥ng Ä‘Ãºng tÃªn database trong toÃ n bá»™ code:

```java
// âœ… ÄÃšNG: Sá»­ dá»¥ng constant tá»« DatabaseHelper
public class DatabaseHelper extends SQLiteOpenHelper {
    private static final String DATABASE_NAME = "CallBlocker.db"; // Äá»‹nh nghÄ©a 1 láº§n
}

// âœ… ÄÃšNG: Export/Import sá»­ dá»¥ng Ä‘Ãºng tÃªn
private void exportDatabase() {
    // Sá»­ dá»¥ng CHÃNH XÃC tÃªn database nhÆ° trong DatabaseHelper
    File dbFile = getContext().getDatabasePath("CallBlocker.db");
    // ...
}

private void importDatabase(Uri uri) {
    // Sá»­ dá»¥ng CHÃNH XÃC tÃªn database nhÆ° trong DatabaseHelper
    File dbFile = getContext().getDatabasePath("CallBlocker.db");
    // ...
}

// âŒ SAI: Hardcode tÃªn khÃ¡c
File dbFile = getContext().getDatabasePath("call_blocker.db"); // SAI!
File dbFile = getContext().getDatabasePath("database.db"); // SAI!
```

**LÃ½ do:**
- `getDatabasePath()` tÃ¬m file theo tÃªn CHÃNH XÃC
- TÃªn sai â†’ File khÃ´ng tá»“n táº¡i â†’ Export/Import fail
- CÃ¡c app khÃ¡c copy code vá»›i tÃªn database khÃ¡c sáº½ bá»‹ lá»—i

**Best Practice:**
```java
// Option 1: Táº¡o public constant trong DatabaseHelper
public class DatabaseHelper extends SQLiteOpenHelper {
    public static final String DATABASE_NAME = "CallBlocker.db";
    // Sá»­ dá»¥ng: DatabaseHelper.DATABASE_NAME
}

// Option 2: Táº¡o helper method
public File getDatabaseFile(Context context) {
    return context.getDatabasePath(DATABASE_NAME);
}
```

### Implementation Rules

#### 1. **Close Database Before Export**

```java
private void exportDatabase() {
    try {
        // âš ï¸ CRITICAL: Get database path BEFORE closing
        // Database name MUST match DatabaseHelper.DATABASE_NAME
        // Example: if DatabaseHelper uses "CallBlocker.db", use "CallBlocker.db" here
        java.io.File dbFile = getContext().getDatabasePath("CallBlocker.db");
        
        // Check if database file exists
        if (!dbFile.exists()) {
            Toast.makeText(getContext(), "Database file not found: " + dbFile.getAbsolutePath(), 
                Toast.LENGTH_LONG).show();
            return;
        }
        
        // Checkpoint WAL file and close database connections
        if (databaseHelper != null) {
            SQLiteDatabase db = databaseHelper.getWritableDatabase();
            // Force checkpoint to merge WAL file into main database
            db.rawQuery("PRAGMA wal_checkpoint(FULL)", null).close();
            databaseHelper.close();
        }
        
        String timestamp = new java.text.SimpleDateFormat("yyyyMMdd_HHmmss", java.util.Locale.getDefault())
            .format(new java.util.Date());
        String fileName = "backup_" + timestamp + ".db";
        
        // Export logic based on Android version...
        
    } catch (Exception e) {
        e.printStackTrace();
        Toast.makeText(getContext(), "Export failed: " + e.getMessage(), Toast.LENGTH_LONG).show();
    } finally {
        // CRITICAL: Reopen database connection
        databaseHelper = new DatabaseHelper(getContext());
    }
}
```

**âš ï¸ LÃ½ do pháº£i close database:**
- Database file cÃ³ thá»ƒ Ä‘ang Ä‘Æ°á»£c lock bá»Ÿi SQLite
- WAL (Write-Ahead Logging) file cáº§n Ä‘Æ°á»£c checkpoint trÆ°á»›c
- TrÃ¡nh lá»—i "database is locked" hoáº·c "file not found"

**âš ï¸ Database Name Consistency:**
- **Báº®T BUá»˜C** dÃ¹ng Ä‘Ãºng tÃªn database nhÆ° trong `DatabaseHelper.DATABASE_NAME`
- Náº¿u DatabaseHelper khai bÃ¡o: `private static final String DATABASE_NAME = "CallBlocker.db";`
- ThÃ¬ `getDatabasePath("CallBlocker.db")` - ÄÃšNG âœ…
- KHÃ”NG dÃ¹ng: `getDatabasePath("call_blocker.db")` - SAI âŒ
- Sai tÃªn â†’ file khÃ´ng tá»“n táº¡i â†’ export/import fail

#### 2. **Android 10+ (Scoped Storage)**

```java
if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.Q) {
    // Use MediaStore API
    android.content.ContentValues values = new android.content.ContentValues();
    values.put(android.provider.MediaStore.MediaColumns.DISPLAY_NAME, fileName);
    values.put(android.provider.MediaStore.MediaColumns.MIME_TYPE, "application/octet-stream");
    values.put(android.provider.MediaStore.MediaColumns.RELATIVE_PATH, 
        android.os.Environment.DIRECTORY_DOWNLOADS + "/SmartCallBlock");
    
    android.net.Uri uri = getContext().getContentResolver().insert(
        android.provider.MediaStore.Downloads.EXTERNAL_CONTENT_URI, values);
    
    if (uri != null) {
        java.io.OutputStream outputStream = getContext().getContentResolver().openOutputStream(uri);
        if (outputStream != null) {
            java.io.FileInputStream fis = new java.io.FileInputStream(dbFile);
            
            byte[] buffer = new byte[8192]; // 8KB buffer for better performance
            int length;
            while ((length = fis.read(buffer)) > 0) {
                outputStream.write(buffer, 0, length);
            }
            
            outputStream.flush();
            outputStream.close();
            fis.close();
            
            Toast.makeText(getContext(), "Exported to Downloads/SmartCallBlock/" + fileName, 
                Toast.LENGTH_LONG).show();
        }
    }
}
```

**Lá»£i Ã­ch:**
- âœ… KhÃ´ng cáº§n runtime permission trÃªn Android 10+
- âœ… File Ä‘Æ°á»£c lÆ°u vÃ o Downloads folder (user-accessible)
- âœ… App uninstall khÃ´ng xÃ³a file backup

#### 3. **Android 6-9 (Traditional Storage)**

```java
else {
    // Check permission first
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M &&
        ContextCompat.checkSelfPermission(getContext(), 
            Manifest.permission.WRITE_EXTERNAL_STORAGE) != PackageManager.PERMISSION_GRANTED) {
        ActivityCompat.requestPermissions(getActivity(), 
            new String[]{Manifest.permission.WRITE_EXTERNAL_STORAGE}, 300);
        return;
    }
    
    // Use traditional file system
    java.io.File exportDir = new java.io.File(
        android.os.Environment.getExternalStoragePublicDirectory(
            android.os.Environment.DIRECTORY_DOWNLOADS), "SmartCallBlock");
    
    if (!exportDir.exists()) {
        exportDir.mkdirs();
    }
    
    java.io.File exportFile = new java.io.File(exportDir, fileName);
    
    java.io.FileInputStream fis = new java.io.FileInputStream(dbFile);
    java.io.FileOutputStream fos = new java.io.FileOutputStream(exportFile);
    
    byte[] buffer = new byte[8192];
    int length;
    while ((length = fis.read(buffer)) > 0) {
        fos.write(buffer, 0, length);
    }
    
    fos.flush();
    fos.close();
    fis.close();
    
    Toast.makeText(getContext(), "Exported to:\n" + exportFile.getAbsolutePath(), 
        Toast.LENGTH_LONG).show();
}
```

#### 4. **Import Database**

```java
private void importDatabase(Uri uri) {
    try {
        // âš ï¸ CRITICAL: Database name MUST match DatabaseHelper.DATABASE_NAME
        // Example: if DatabaseHelper uses "CallBlocker.db", use "CallBlocker.db" here
        // DO NOT hardcode different name like "call_blocker.db"
        java.io.File dbFile = getContext().getDatabasePath("CallBlocker.db");
        
        // Close current database
        if (databaseHelper != null) {
            databaseHelper.close();
        }
        
        java.io.InputStream inputStream = getContext().getContentResolver().openInputStream(uri);
        java.io.FileOutputStream fos = new java.io.FileOutputStream(dbFile);
        
        byte[] buffer = new byte[8192];
        int length;
        while ((length = inputStream.read(buffer)) > 0) {
            fos.write(buffer, 0, length);
        }
        
        fos.flush();
        fos.close();
        inputStream.close();
        
        Toast.makeText(getContext(), "Database imported successfully", Toast.LENGTH_LONG).show();
        
        // Restart activity to reload data
        getActivity().recreate();
        
    } catch (Exception e) {
        e.printStackTrace();
        Toast.makeText(getContext(), "Import failed: " + e.getMessage(), Toast.LENGTH_LONG).show();
    } finally {
        // Reopen database
        databaseHelper = new DatabaseHelper(getContext());
    }
}
```

#### 5. **File Picker for Import**

```java
private void showImportDialog() {
    // Show confirmation dialog first
    // ...
    
    // Launch file picker
    Intent intent = new Intent(Intent.ACTION_OPEN_DOCUMENT);
    intent.addCategory(Intent.CATEGORY_OPENABLE);
    intent.setType("*/*"); // Accept all file types
    startActivityForResult(intent, 200);
}

@Override
public void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (requestCode == 200 && resultCode == Activity.RESULT_OK && data != null) {
        Uri uri = data.getData();
        if (uri != null) {
            importDatabase(uri);
        }
    }
}
```

### Manifest Permissions

```xml
<!-- Storage permissions for database export/import -->
<!-- Android 6-12: Required for traditional storage access -->
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" 
    android:maxSdkVersion="32" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" 
    android:maxSdkVersion="28" />

<!-- Android 10+: Request legacy storage for compatibility -->
<application
    android:requestLegacyExternalStorage="true"
    ... >
</application>
```

**âš ï¸ LÆ°u Ã½:**
- `maxSdkVersion="32"` â†’ Permission chá»‰ request trÃªn Android 12 trá»Ÿ xuá»‘ng
- `maxSdkVersion="28"` â†’ WRITE chá»‰ cáº§n Ä‘áº¿n Android 9
- Android 13+ khÃ´ng cáº§n permission cho MediaStore Downloads

### UI/UX Best Practices

#### 1. **Dynamic Permission Display**

```java
// Build permissions list based on Android version
java.util.ArrayList<PermissionInfo> permissionsList = new java.util.ArrayList<>();

// Add storage permission only for Android 6-12
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M && 
    Build.VERSION.SDK_INT <= Build.VERSION_CODES.S_V2) {
    permissionsList.add(new PermissionInfo(
        "Storage Access",
        "Required to export/import database files",
        Manifest.permission.READ_EXTERNAL_STORAGE,
        false
    ));
}
```

#### 2. **Info Message for Users**

```xml
<!-- Layout: Info message vá» storage location -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@color/background_light"
    android:padding="@dimen/spacing_medium">
    
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="â„¹ï¸" />
    
    <TextView
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="@string/storage_info"
        android:textColor="@color/text_secondary"
        android:textSize="@dimen/text_size_small" />
</LinearLayout>
```

```xml
<!-- strings.xml -->
<string name="storage_info">Files are saved to Downloads/SmartCallBlock folder. No storage permission needed on Android 10+</string>

<!-- strings-vi.xml -->
<string name="storage_info">File Ä‘Æ°á»£c lÆ°u vÃ o thÆ° má»¥c Downloads/SmartCallBlock. KhÃ´ng cáº§n quyá»n lÆ°u trá»¯ trÃªn Android 10+</string>
```

### Common Issues & Solutions

| Issue | Cause | Solution |
|-------|-------|----------|
| "Database file not found" on export | Wrong database name or WAL not checkpointed | Use correct DATABASE_NAME, checkpoint WAL before close |
| Import success but no data loads | Wrong database filename imported to wrong location | Verify `getDatabasePath()` uses same name as DatabaseHelper |
| "Database is locked" error | Database still open during file operations | Close DB before export, reopen in finally block |
| Export creates empty file | Didn't checkpoint WAL file | Run `PRAGMA wal_checkpoint(FULL)` before close |
| Import works but app crashes | Database schema mismatch | Validate backup file version matches app version |
| Storage permission denied on Android 9 | Missing runtime permission check | Check WRITE_EXTERNAL_STORAGE before export |

### Database Export/Import Checklist

**Export:**
- [ ] Get database path BEFORE closing connection
- [ ] Verify database file exists before attempting export
- [ ] Checkpoint WAL file: `PRAGMA wal_checkpoint(FULL)`
- [ ] Close database connection
- [ ] Use 8KB buffer for file copy (better performance)
- [ ] Reopen database in finally block
- [ ] Use correct database filename (match DATABASE_NAME constant)

**Import:**
- [ ] Show confirmation dialog (warn about data overwrite)
- [ ] Close current database connection before overwrite
- [ ] Verify imported file is valid SQLite database
- [ ] Use correct database filename (match DATABASE_NAME constant)
- [ ] Reopen database after import
- [ ] Recreate activity to reload UI data
- [ ] Handle exceptions with user-friendly messages

**Version Compatibility:**
- [ ] Check Android version for permission requirements
- [ ] Use MediaStore for Android 10+
- [ ] Use traditional storage for Android 6-9
- [ ] Display appropriate storage permission in UI
- [ ] Test on multiple Android versions (9, 10, 13+)

**UI/UX:**
- [ ] Show storage info message for user guidance
- [ ] Dynamic permission display based on Android version
- [ ] Timestamp in backup filename
- [ ] Toast with file location after export
- [ ] Suggest app restart after import

---
| "Export failed: /data/user/0/..." | Database file locked | Close database before export |
| "Permission denied" on Android 13 | Requesting deprecated permission | Use MediaStore API, no permission needed |
| "File not found" after export | Wrong path or storage scope | Use MediaStore for Android 10+ |
| Import crashes app | Database locked during import | Close database, then import, then reopen |
| Exported file not visible | Wrong MIME type or path | Use `application/octet-stream` and `DIRECTORY_DOWNLOADS` |

### Testing Checklist

- [ ] Test export on Android 9 (API 28) - vá»›i permission
- [ ] Test export on Android 10-12 (API 29-32) - vá»›i/khÃ´ng permission
- [ ] Test export on Android 13+ (API 33+) - khÃ´ng permission
- [ ] Verify file location: Downloads/SmartCallBlock/backup_*.db
- [ ] Test import from file picker
- [ ] Verify app doesn't crash after import
- [ ] Check data integrity after import/export

---

## ğŸ“ Logging & Debugging

### Logging Strategy

App sá»­ dá»¥ng **2-tier logging system**:
1. **Android Logcat** - Debug logs cho development
2. **Database Logs** - User-facing call history (cÃ³ thá»ƒ táº¯t)

### 1. Android Logcat (Development Logs)

#### Tag Naming Convention

```java
private static final String TAG = "ComponentName";
```

| Component Type | Tag Pattern | Example |
|---------------|-------------|---------|
| Activity | `ActivityName` | `MainActivity`, `SettingsActivity` |
| Fragment | `FragmentName` | `MainHome`, `MainProfile` |
| Service | `ServiceName` | `CallOverlayService`, `CallBlockerReceiver` |
| Helper | `HelperName` | `DatabaseHelper`, `NotificationHelper` |

#### Log Levels

```java
// Debug - Detailed flow information
Log.d(TAG, "Method called with param: " + value);

// Info - Important state changes
Log.i(TAG, "User action completed successfully");

// Warning - Recoverable errors
Log.w(TAG, "Missing optional data, using default");

// Error - Errors that need attention
Log.e(TAG, "Failed to process: " + e.getMessage());

// Verbose - Extremely detailed (rarely used)
Log.v(TAG, "Loop iteration: " + i);
```

#### When to Log

| Scenario | Level | Example |
|----------|-------|---------|
| Method entry/exit | `d` | `Log.d(TAG, "showOverlay() called")` |
| State changes | `d` | `Log.d(TAG, "Call state changed: IDLE")` |
| User actions | `d` | `Log.d(TAG, "Blocking call from: " + number)` |
| Success operations | `i` | `Log.i(TAG, "Database exported successfully")` |
| Caught exceptions | `e` | `Log.e(TAG, "Error: " + e.getMessage())` |
| Permission denials | `e` | `Log.e(TAG, "No overlay permission")` |

#### Example Usage

```java
public class CallOverlayService extends Service {
    private static final String TAG = "CallOverlayService";
    
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.d(TAG, "onStartCommand called");
        
        String incomingNumber = intent.getStringExtra("phone_number");
        if (incomingNumber != null) {
            Log.d(TAG, "Incoming number: " + incomingNumber);
            showOverlay(incomingNumber);
        } else {
            Log.e(TAG, "No phone number provided");
        }
        
        return START_NOT_STICKY;
    }
    
    private void showOverlay(String number) {
        Log.d(TAG, "showOverlay() called");
        
        if (!Settings.canDrawOverlays(this)) {
            Log.e(TAG, "No overlay permission");
            return;
        }
        
        try {
            // Create overlay...
            Log.d(TAG, "Overlay view added successfully");
        } catch (Exception e) {
            Log.e(TAG, "Error adding overlay: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
```

### 2. Database Call Logs (User-Facing)

#### Enable/Disable Logging

```java
// DatabaseHelper.java
private static final String KEY_LOG_ENABLED = "log_enabled";

public void setLogEnabled(boolean enabled) {
    SharedPreferences prefs = context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);
    prefs.edit().putBoolean(KEY_LOG_ENABLED, enabled).apply();
}

public boolean isLogEnabled() {
    SharedPreferences prefs = context.getSharedPreferences(PREFS_NAME, Context.MODE_PRIVATE);
    return prefs.getBoolean(KEY_LOG_ENABLED, true); // Default enabled
}
```

#### Log Blocked Calls

```java
public void logBlockedCall(String phoneNumber, int blockedNumberId, String blockType) {
    // Check if logging is enabled
    if (!isLogEnabled()) {
        return; // Skip logging
    }
    
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues values = new ContentValues();
    values.put(COLUMN_LOG_PHONE, phoneNumber);
    values.put(COLUMN_LOG_DATE, System.currentTimeMillis() / 1000); // Unix timestamp
    values.put(COLUMN_LOG_BLOCKED_ID, blockedNumberId);
    values.put(COLUMN_LOG_BLOCK_TYPE, blockType != null ? blockType : "exact");
    
    db.insert(TABLE_CALL_LOGS, null, values);
    
    // Increment block count
    if (blockedNumberId > 0) {
        db.execSQL("UPDATE " + TABLE_BLOCKED + " SET " + COLUMN_BLOCK_COUNT + 
            " = " + COLUMN_BLOCK_COUNT + " + 1 WHERE " + COLUMN_ID + " = ?", 
            new String[]{String.valueOf(blockedNumberId)});
    }
}
```

#### Usage in Receiver/Service

```java
public class CallBlockerReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        String phoneNumber = intent.getStringExtra(TelephonyManager.EXTRA_INCOMING_NUMBER);
        
        if (shouldBlockCall(phoneNumber)) {
            // Log to logcat
            Log.d(TAG, "Blocking call from: " + phoneNumber);
            
            // Log to database (if enabled)
            DatabaseHelper db = new DatabaseHelper(context);
            db.logBlockedCall(phoneNumber, blockedId, blockType);
            
            // Block the call...
        }
    }
}
```

### 3. LogViewerActivity (Runtime Logs)

Activity Ä‘á»ƒ view app logs real-time trong app (debug feature).

#### Implementation

```java
public class LogViewerActivity extends AppCompatActivity {
    private static final String TAG = "LogViewerActivity";
    private TextView tvLogs;
    private ScrollView scrollView;
    private Handler handler;
    private static final int MAX_LINES = 500;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_log_viewer);
        
        tvLogs = findViewById(R.id.tvLogs);
        scrollView = findViewById(R.id.scrollView);
        
        // Auto-refresh every 2 seconds
        handler = new Handler(Looper.getMainLooper());
        handler.postDelayed(updateRunnable, 2000);
        
        refreshLogs();
    }
    
    private void refreshLogs() {
        new Thread(() -> {
            try {
                List<String> logs = new ArrayList<>();
                
                // Get logcat for app tags only
                Process process = Runtime.getRuntime().exec(new String[]{
                    "logcat", "-d", "-v", "time",
                    "CallOverlayService:D",
                    "CallBlockerReceiver:D",
                    "MainActivityNew:D",
                    "MainAddBlock:D",
                    "*:S" // Suppress other logs
                });
                
                BufferedReader reader = new BufferedReader(
                    new InputStreamReader(process.getInputStream()));
                
                String line;
                while ((line = reader.readLine()) != null) {
                    logs.add(line);
                }
                
                // Keep only last MAX_LINES
                if (logs.size() > MAX_LINES) {
                    logs = logs.subList(logs.size() - MAX_LINES, logs.size());
                }
                
                // Update UI
                runOnUiThread(() -> {
                    tvLogs.setText(String.join("\n", logs));
                    scrollView.post(() -> scrollView.fullScroll(View.FOCUS_DOWN));
                });
                
            } catch (Exception e) {
                Log.e(TAG, "Error reading logs: " + e.getMessage());
            }
        }).start();
    }
}
```

#### Layout

```xml
<!-- activity_log_viewer.xml -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="@dimen/spacing_normal">
    
    <!-- Buttons -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal">
        
        <Button
            android:id="@+id/btnRefresh"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Refresh" />
        
        <Button
            android:id="@+id/btnClear"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Clear" />
    </LinearLayout>
    
    <!-- Logs ScrollView -->
    <ScrollView
        android:id="@+id/scrollView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@color/card_background"
        android:padding="@dimen/spacing_small">
        
        <TextView
            android:id="@+id/tvLogs"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:fontFamily="monospace"
            android:textSize="10sp"
            android:textColor="@color/text_primary" />
    </ScrollView>
</LinearLayout>
```

### UI Controls for Logging

#### Toggle Switch in Profile

```xml
<!-- Enable/Disable call logging -->
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:gravity="center_vertical">
    
    <LinearLayout
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:orientation="vertical">
        
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Enable Call Logging"
            android:textColor="@color/text_primary"
            android:textSize="@dimen/text_size_medium"
            android:textStyle="bold" />
        
        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Track blocked call history"
            android:textColor="@color/text_secondary"
            android:textSize="@dimen/text_size_small" />
    </LinearLayout>
    
    <androidx.appcompat.widget.SwitchCompat
        android:id="@+id/switchEnableLog"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />
</LinearLayout>
```

```java
// Fragment implementation
SwitchCompat switchEnableLog = view.findViewById(R.id.switchEnableLog);

// Load current setting
boolean isLogEnabled = databaseHelper.isLogEnabled();
switchEnableLog.setChecked(isLogEnabled);

// Toggle listener
switchEnableLog.setOnCheckedChangeListener((buttonView, isChecked) -> {
    databaseHelper.setLogEnabled(isChecked);
    String message = isChecked ? "Call logging enabled" : "Call logging disabled";
    Toast.makeText(getContext(), message, Toast.LENGTH_SHORT).show();
});
```

### Best Practices

#### 1. **KHÃ”NG log sensitive data**

```java
// âŒ BAD - Logs full phone number
Log.d(TAG, "Calling: 0123456789");

// âœ… GOOD - Mask sensitive info
Log.d(TAG, "Calling: 012****789");

// âœ… GOOD - Log action only
Log.d(TAG, "Initiating outbound call");
```

#### 2. **Use meaningful messages**

```java
// âŒ BAD - Unclear
Log.d(TAG, "Done");

// âœ… GOOD - Clear context
Log.d(TAG, "Database export completed successfully");
```

#### 3. **Include exception details**

```java
// âŒ BAD - Missing details
catch (Exception e) {
    Log.e(TAG, "Error");
}

// âœ… GOOD - Full context
catch (Exception e) {
    Log.e(TAG, "Failed to export database: " + e.getMessage());
    e.printStackTrace(); // Full stack trace in logcat
}
```

#### 4. **Clean up logs in production**

```java
// Use BuildConfig to disable verbose logs in release
if (BuildConfig.DEBUG) {
    Log.d(TAG, "Debug info: " + debugData);
}

// Or use ProGuard to strip logs:
// -assumenosideeffects class android.util.Log {
//     public static *** d(...);
//     public static *** v(...);
// }
```

### Debug Section in Profile

```xml
<!-- Debug Tools Card (only show in debug builds) -->
<androidx.cardview.widget.CardView
    android:id="@+id/cardDebugTools"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:visibility="gone"> <!-- Show only if BuildConfig.DEBUG -->
    
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="@dimen/spacing_normal">
        
        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="ğŸ› Debug Tools"
            android:textStyle="bold" />
        
        <Button
            android:id="@+id/btnViewLogs"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="View App Logs" />
    </LinearLayout>
</androidx.cardview.widget.CardView>
```

```java
// Show debug section only in debug builds
if (BuildConfig.DEBUG) {
    cardDebugTools.setVisibility(View.VISIBLE);
    btnViewLogs.setOnClickListener(v -> {
        Intent intent = new Intent(getContext(), LogViewerActivity.class);
        startActivity(intent);
    });
}
```

### Logging Checklist

- [ ] Use appropriate TAG for each component
- [ ] Use correct log level (d/i/w/e)
- [ ] KHÃ”NG log sensitive user data
- [ ] Include exception messages and stack traces
- [ ] Provide clear, actionable log messages
- [ ] Check `isLogEnabled()` before database logging
- [ ] Implement toggle switch for user control
- [ ] Strip debug logs in production builds

---

## âš ï¸ LÆ°u Ã½ quan trá»ng cho AI

### âš ï¸ Common Runtime Crash Causes (Review Checklist)

> Nhá»¯ng lá»—i nÃ y KHÃ”NG bÃ¡o lÃºc compile nhÆ°ng gÃ¢y crash khi cháº¡y app. **Báº®T BUá»˜C kiá»ƒm tra trÆ°á»›c khi hoÃ n thÃ nh task.**

#### 1. Custom Attributes chÆ°a Ä‘á»‹nh nghÄ©a

**Váº¥n Ä‘á»:** Sá»­ dá»¥ng `?attr/customAttr` trong layout nhÆ°ng chÆ°a Ä‘á»‹nh nghÄ©a trong `attrs.xml` vÃ  theme.

```xml
<!-- âŒ CRASH náº¿u iconTint chÆ°a Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a -->
<ImageView app:tint="?attr/iconTint" />
```

**Kiá»ƒm tra:**
1. Attribute cÃ³ trong `values/attrs.xml`?
2. GiÃ¡ trá»‹ Ä‘Æ°á»£c set trong `styles_theme.xml` (Light)?
3. GiÃ¡ trá»‹ Ä‘Æ°á»£c set trong `values-night/styles_theme.xml` (Dark)?

```xml
<!-- attrs.xml -->
<attr name="iconTint" format="color|reference" />

<!-- styles_theme.xml (Light) -->
<item name="iconTint">@color/text_hint</item>

<!-- values-night/styles_theme.xml (Dark) -->
<item name="iconTint">@color/text_hint</item>
```

#### 2. Button background dÃ¹ng color thay vÃ¬ drawable

**Váº¥n Ä‘á»:** Má»™t sá»‘ devices crash khi Button cÃ³ `android:background="@color/xxx"`.

```xml
<!-- âŒ CÃ³ thá»ƒ crash trÃªn má»™t sá»‘ devices -->
<style name="Button.Primary">
    <item name="android:background">@color/primary</item>
</style>

<!-- âœ… ÄÃšNG - DÃ¹ng drawable -->
<style name="Button.Primary">
    <item name="android:background">@drawable/button_primary</item>
</style>
```

#### 3. Duplicate imports trong Java

**Váº¥n Ä‘á»:** Import cÃ¹ng má»™t class 2 láº§n cÃ³ thá»ƒ gÃ¢y lá»—i compile hoáº·c runtime issues.

```java
// âŒ SAI - Duplicate
import android.view.LayoutInflater;
import android.view.LayoutInflater;

// âœ… ÄÃšNG - Chá»‰ 1 láº§n
import android.view.LayoutInflater;
```

#### 4. Fragment lifecycle - NullPointerException

**Váº¥n Ä‘á»:** Gá»i `requireContext()` hoáº·c access View trong Fragment khi chÆ°a attached hoáº·c Ä‘Ã£ detached.

```java
// âŒ SAI - CÃ³ thá»ƒ crash náº¿u fragment chÆ°a attached
@Override
public void onResume() {
    super.onResume();
    updatePermissionStatus(); // Crash náº¿u view chÆ°a ready
}

// âœ… ÄÃšNG - Kiá»ƒm tra trÆ°á»›c
@Override
public void onResume() {
    super.onResume();
    if (permissionsContainer != null && isAdded()) {
        updatePermissionStatus();
    }
}
```

#### 5. Missing resources trong layout

**Váº¥n Ä‘á»:** Layout reference resources khÃ´ng tá»“n táº¡i.

**Checklist:**
- `@string/xxx` - String cÃ³ trong strings*.xml?
- `@dimen/xxx` - Dimen cÃ³ trong dimens*.xml?
- `@color/xxx` - Color cÃ³ trong colors*.xml?
- `@drawable/xxx` - Drawable file tá»“n táº¡i?
- `@style/xxx` - Style Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a?

#### 6. Theme attributes trong sub-themes

**Váº¥n Ä‘á»:** Táº¡o sub-theme (AlarmRing, Dialog) nhÆ°ng khÃ´ng set Ä‘á»§ custom attributes.

```xml
<!-- âŒ SAI - AlarmRing theme khÃ´ng cÃ³ iconTint -->
<style name="Theme.App.AlarmRing" parent="...">
    <!-- Missing iconTint, cardBackground, etc. -->
</style>

<!-- âœ… ÄÃšNG - Set Ä‘á»§ custom attributes hoáº·c káº¿ thá»«a tá»« base -->
<style name="Theme.App.AlarmRing" parent="Theme.App">
    <!-- Override only what's needed -->
</style>
```

---

### Quy táº¯c chung

1. **Resource files cÃ³ thá»ƒ Ä‘Ã£ split**: Náº¿u project lá»›n, cÃ¡c file gá»‘c (`colors.xml`, `dimens.xml`, `strings.xml`) cÃ³ thá»ƒ chá»‰ chá»©a comment/reference, ná»™i dung thá»±c á»Ÿ cÃ¡c file `*_category.xml`. Kiá»ƒm tra trÆ°á»›c khi thÃªm.

2. **Shared/Layout components**: CÃ¡c file `layout_*.xml`, `shared_*.xml` Ä‘Æ°á»£c dÃ¹ng láº¡i nhiá»u nÆ¡i. **Cáº©n tháº­n khi sá»­a** - thay Ä‘á»•i sáº½ áº£nh hÆ°á»Ÿng táº¥t cáº£ nÆ¡i dÃ¹ng.

3. **DialogUtils lÃ  báº¯t buá»™c**: LuÃ´n gá»i `DialogUtils.setDialogWidth()` sau `dialog.show()` Ä‘á»ƒ Ä‘áº£m báº£o dialog width consistent.

4. **KHÃ”NG hardcode values trong layout - Æ¯u tiÃªn @style/, @dimen/, @color/**:
   - âŒ KHÃ”NG: `android:textSize="16sp"` `android:textColor="#212121"` `android:padding="16dp"`
   - âœ… ÄÃšNG: `@style/Text.Title` `@dimen/spacing_normal` `@color/text_primary`
   - âŒ KHÃ”NG: `android:background="#FFFFFF"` `android:textColor="#000000"`
   - âœ… ÄÃšNG: `@color/card_background` `@color/text_primary`
   
   **LÃ½ do:**
   - Hardcode values gÃ¢y khÃ³ maintain vÃ  khÃ´ng support theme switching
   - Theme-aware colors tá»± Ä‘á»™ng Ä‘á»•i khi switch Light/Dark mode
   - Centralized resources dá»… update toÃ n bá»™ app
   
   **Khi nÃ o Ä‘Æ°á»£c hardcode:**
   - System colors: `@android:color/white`, `@android:color/transparent`
   - Fixed dimensions trong drawable: `<size android:height="24dp"/>`
   - Icon tint values trong drawable resources

5. **KHÃ”NG hardcode strings trong Java**: LuÃ´n dÃ¹ng:
   - `getString(R.string.xxx)` trong Activity/Fragment
   - `context.getString(R.string.xxx)` trong non-UI classes
   - `R.string.xxx` cho Toast, Snackbar, Notification
   - âŒ KHÃ”NG: `Toast.makeText(context, "Success", ...)` 
   - âœ… ÄÃšNG: `Toast.makeText(context, R.string.success_message, ...)`

6. **Theme-aware colors Báº®T BUá»˜C**: 
   - âŒ KHÃ”NG dÃ¹ng: `@color/background_dark`, `@color/card_background_dark`, `@color/text_primary_dark`
   - âœ… ÄÃšNG: `@color/background_light`, `@color/card_background`, `@color/text_primary`
   - System tá»± map sang values-night/ khi dark mode enabled
   - **LUÃ”N** Ä‘á»‹nh nghÄ©a color trong cáº£ `values/` vÃ  `values-night/`
   - Test cáº£ Light vÃ  Dark mode sau khi sá»­a layout

7. **Multi-language Support lÃ  Báº®T BUá»˜C**:
   - Khi thÃªm string resource, **LUÃ”N** thÃªm vÃ o cáº£:
     - `values/strings*.xml` (English - default)
     - `values-vi/strings*.xml` (Vietnamese)
   - âŒ KHÃ”NG hardcode: `setText("Hello")` hoáº·c `android:text="Hello"`
   - âœ… ÄÃšNG: `setText(R.string.greeting)` hoáº·c `android:text="@string/greeting"`
   - Technical terms cÃ³ thá»ƒ giá»¯ tiáº¿ng Anh cho cáº£ 2 ngÃ´n ngá»¯

8. **Technical terms giá»¯ tiáº¿ng Anh**: Vibration patterns, ringtone names, log messages... giá»¯ nguyÃªn tiáº¿ng Anh cho cáº£ 2 ngÃ´n ngá»¯.

9. **ThÃªm resource má»›i**: Äáº·t vÃ o file category phÃ¹ há»£p náº¿u project Ä‘Ã£ split:
   - Colors â†’ `colors_brand.xml`, `colors_text.xml`, `colors_background.xml`, `colors_ui.xml`

---

## ğŸ¨ Theme Color Editor (theme.html)

### Má»¥c Ä‘Ã­ch

File `docs/theme.html` lÃ  interactive color theme editor cho phÃ©p:
- **Preview táº¥t cáº£ colors** trong app (Light & Dark mode)
- **Edit colors trá»±c quan** vá»›i color picker
- **Export XML code** Ä‘á»ƒ copy vÃ o project
- **Compare Light/Dark** colors side-by-side
- **Test theme consistency** trÆ°á»›c khi apply vÃ o code

### Cáº¥u trÃºc File

```
docs/
â”œâ”€â”€ theme.html              # Interactive color editor
â””â”€â”€ BUILD_GUIDE.md          # Build documentation
```

### Ná»™i dung theme.html

File bao gá»“m:

**1. Color Categories (4 sections):**
- **Brand Colors**: Primary, primary_dark, primary_light
- **Background Colors**: All background vÃ  card colors
- **Text Colors**: text_primary, text_secondary, text_hint, etc.
- **UI Component Colors**: Button, status, badge, divider, overlay colors

**2. Interactive Features:**
- Color picker input (visual)
- Hex code input (manual)
- Light/Dark mode side-by-side comparison
- Real-time preview
- Copy XML button for each section

**3. Export Functions:**
- Export Light Mode XML
- Export Dark Mode XML
- Copy to Clipboard
- Download as file

### âš ï¸ REQUIRED: Metadata Tracking trong theme.html

**Báº®T BUá»˜C** - File theme.html PHáº¢I cÃ³ metadata Ä‘á»ƒ AI tracking changes:

**1. File-level Metadata (á»Ÿ Ä‘áº§u body):**

```html
<div class="metadata-section">
    <h3>ğŸ“‹ File Metadata</h3>
    <table class="metadata-table">
        <tr>
            <td><strong>Last Updated:</strong></td>
            <td id="last-updated">2024-12-11 14:30:00</td>
        </tr>
        <tr>
            <td><strong>Version:</strong></td>
            <td id="version">1.0 (Baseline)</td>
        </tr>
        <tr>
            <td><strong>Total Colors:</strong></td>
            <td id="total-colors">36</td>
        </tr>
        <tr>
            <td><strong>Status:</strong></td>
            <td id="status">ğŸŸ¢ Baseline - All colors initial version</td>
        </tr>
    </table>
</div>
```

**2. Color-level Metadata (thÃªm cá»™t trong table):**

```html
<table class="color-table">
    <thead>
        <tr>
            <th>Component</th>
            <th>Light Mode</th>
            <th>Dark Mode</th>
            <th>Created Date</th>      <!-- âœ… REQUIRED -->
            <th>Last Modified</th>     <!-- âœ… REQUIRED -->
            <th>Status</th>             <!-- âœ… REQUIRED -->
        </tr>
    </thead>
    <tbody id="brand-colors">
        <tr data-name="primary" data-created="2024-12-11" data-modified="2024-12-11" data-status="baseline">
            <td class="component-name">primary</td>
            <td>
                <div class="color-input">
                    <input type="color" value="#09A3E3" data-mode="light">
                    <input type="text" value="#09A3E3" data-mode="light">
                </div>
            </td>
            <td>
                <div class="color-input">
                    <input type="color" value="#29B6F6" data-mode="dark">
                    <input type="text" value="#29B6F6" data-mode="dark">
                </div>
            </td>
            <td class="date-cell">2024-12-11</td>           <!-- Created Date -->
            <td class="date-cell">2024-12-11</td>           <!-- Last Modified -->
            <td class="status-cell">
                <span class="badge badge-baseline">Baseline</span>
            </td>
        </tr>
    </tbody>
</table>
```

**3. Status Badges:**

```css
.badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
}

.badge-baseline { background: #E3F5FC; color: #0288D1; }
.badge-new { background: #C8E6C9; color: #2E7D32; }
.badge-modified { background: #FFF9C4; color: #F57C00; }
.badge-deprecated { background: #FFCDD2; color: #C62828; }
```

**4. Status Values:**

| Status | Badge | Ã nghÄ©a | Khi nÃ o dÃ¹ng |
|--------|-------|---------|--------------|
| `baseline` | ğŸ”µ Baseline | Color ban Ä‘áº§u, chÆ°a thay Ä‘á»•i | Láº§n táº¡o file Ä‘áº§u tiÃªn |
| `new` | ğŸŸ¢ New | Color má»›i thÃªm | Khi add color má»›i |
| `modified` | ğŸŸ¡ Modified | Color Ä‘Ã£ sá»­a value | Khi change hex value |
| `deprecated` | ğŸ”´ Deprecated | Color khÃ´ng dÃ¹ng ná»¯a | Khi plan xÃ³a color |

**5. AI Workflow khi Generate/Update:**

```
Step 1: Check if theme.html exists
    â”œâ”€ EXISTS â†’ Read metadata
    â”‚   â”œâ”€ Parse last-updated date
    â”‚   â”œâ”€ Parse color data-created, data-modified
    â”‚   â””â”€ Determine what changed
    â”‚
    â””â”€ NOT EXISTS â†’ Generate new (all baseline)
        â””â”€ Set all colors status = "baseline"
        â””â”€ Set created/modified = today

Step 2: Compare with current color resources
    â”œâ”€ Scan values/colors*.xml
    â”œâ”€ Compare with theme.html data
    â””â”€ Detect changes:
        â”œâ”€ New colors â†’ status="new"
        â”œâ”€ Changed hex â†’ status="modified", update modified date
        â”œâ”€ Removed colors â†’ status="deprecated" (keep in HTML for history)
        â””â”€ Unchanged â†’ keep current status

Step 3: Generate/Update HTML
    â”œâ”€ Update last-updated to current datetime
    â”œâ”€ Update version (increment if changes detected)
    â”œâ”€ Update total-colors count
    â”œâ”€ Add/Update color rows with metadata
    â””â”€ Generate status summary

Step 4: Add change log section
    â””â”€ Document what changed in this update
```

**6. Change Log Section (á»Ÿ cuá»‘i file):**

```html
<div class="changelog-section">
    <h3>ğŸ“œ Change History</h3>
    <div class="changelog-entry">
        <h4>Version 1.1 - 2024-12-15</h4>
        <ul>
            <li>âœ… Added: <code>button_warning</code> (#FF9800)</li>
            <li>ğŸ”„ Modified: <code>primary</code> from #09A3E3 â†’ #0891CC</li>
            <li>âŒ Deprecated: <code>old_accent</code></li>
        </ul>
    </div>
    <div class="changelog-entry">
        <h4>Version 1.0 - 2024-12-11</h4>
        <ul>
            <li>ğŸ‰ Initial baseline - 36 colors</li>
        </ul>
    </div>
</div>
```

**7. Example: First Generation (Baseline):**

```html
<!-- File Metadata -->
<div class="metadata-section">
    <table class="metadata-table">
        <tr>
            <td><strong>Last Updated:</strong></td>
            <td>2024-12-11 14:30:00</td>
        </tr>
        <tr>
            <td><strong>Version:</strong></td>
            <td>1.0 (Baseline)</td>
        </tr>
        <tr>
            <td><strong>Status:</strong></td>
            <td>ğŸŸ¢ Baseline - All colors initial version</td>
        </tr>
    </table>
</div>

<!-- All colors have: -->
data-created="2024-12-11"
data-modified="2024-12-11"
data-status="baseline"
```

**8. Example: After Adding New Color:**

```html
<!-- File Metadata -->
<div class="metadata-section">
    <table class="metadata-table">
        <tr>
            <td><strong>Last Updated:</strong></td>
            <td>2024-12-15 10:15:00</td>  <!-- Updated -->
        </tr>
        <tr>
            <td><strong>Version:</strong></td>
            <td>1.1</td>  <!-- Incremented -->
        </tr>
        <tr>
            <td><strong>Status:</strong></td>
            <td>ğŸŸ¡ 1 new color added</td>  <!-- Changed -->
        </tr>
    </table>
</div>

<!-- New color row: -->
<tr data-name="button_warning" 
    data-created="2024-12-15"      <!-- Today -->
    data-modified="2024-12-15" 
    data-status="new">              <!-- New status -->
    <td>button_warning</td>
    <td>...</td>
    <td>...</td>
    <td>2024-12-15</td>
    <td>2024-12-15</td>
    <td><span class="badge badge-new">New</span></td>
</tr>
```

**9. AI Detection Logic:**

```javascript
// When AI re-generates theme.html:

// 1. Read existing theme.html
const existingColors = parseExistingThemeHTML('docs/theme.html');

// 2. Read current color resources
const currentColors = parseColorXML('values/colors*.xml', 'values-night/colors*.xml');

// 3. Compare and categorize
const changes = {
    new: [],      // Colors in XML but not in HTML
    modified: [], // Colors with different hex values
    unchanged: [], // Colors same as before
    deprecated: [] // Colors in HTML but not in XML
};

currentColors.forEach(color => {
    const existing = existingColors.find(c => c.name === color.name);
    
    if (!existing) {
        changes.new.push({
            ...color,
            created: TODAY,
            modified: TODAY,
            status: 'new'
        });
    } else if (existing.light !== color.light || existing.dark !== color.dark) {
        changes.modified.push({
            ...color,
            created: existing.created,  // Keep original
            modified: TODAY,            // Update
            status: 'modified'
        });
    } else {
        changes.unchanged.push({
            ...color,
            created: existing.created,
            modified: existing.modified,
            status: existing.status  // Keep current
        });
    }
});

// 4. Generate new HTML with metadata
generateThemeHTML(changes);
```

**10. Benefits of Metadata Tracking:**

âœ… **For AI:**
- Know when file was last updated
- Compare current colors vs last known state
- Detect what changed since last generation
- Avoid unnecessary re-generation if no changes
- Provide accurate change summary to user

âœ… **For Developer:**
- Track color evolution over time
- See when each color was introduced
- Identify recently changed colors
- Plan color deprecation strategy
- Maintain color history

âœ… **For Team:**
- Document design system changes
- Review color modifications
- Rollback if needed (with history)
- Audit color usage

---

### Format HTML Structure

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>App Name - Theme Color Editor</title>
    <style>
        /* Styling cho interactive editor */
        .color-table { /* Table hiá»ƒn thá»‹ colors */ }
        .color-input { /* Color picker + text input */ }
        .metadata-section { /* File metadata display */ }
        .date-cell { /* Date columns */ }
        .status-cell { /* Status badges */ }
        button { /* Export buttons */ }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ App Name - Theme Color Editor</h1>
        
        <!-- âš ï¸ REQUIRED: File Metadata -->
        <div class="metadata-section">
            <h3>ğŸ“‹ File Metadata</h3>
            <table class="metadata-table">
                <tr>
                    <td><strong>Last Updated:</strong></td>
                    <td id="last-updated">2024-12-11 14:30:00</td>
                </tr>
                <tr>
                    <td><strong>Version:</strong></td>
                    <td id="version">1.0 (Baseline)</td>
                </tr>
                <tr>
                    <td><strong>Total Colors:</strong></td>
                    <td id="total-colors">36</td>
                </tr>
                <tr>
                    <td><strong>Status:</strong></td>
                    <td id="status">ğŸŸ¢ Baseline - All colors initial version</td>
                </tr>
            </table>
        </div>
        
        <!-- Brand Colors Section -->
        <div class="section">
            <h2 class="section-title">Brand Colors</h2>
            <table class="color-table">
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Light Mode</th>
                        <th>Dark Mode</th>
                        <th>Created</th>        <!-- âš ï¸ REQUIRED -->
                        <th>Modified</th>       <!-- âš ï¸ REQUIRED -->
                        <th>Status</th>         <!-- âš ï¸ REQUIRED -->
                    </tr>
                </thead>
                <tbody id="brand-colors">
                    <tr data-name="primary" 
                        data-created="2024-12-11" 
                        data-modified="2024-12-11" 
                        data-status="baseline">
                        <td class="component-name">primary</td>
                        <td>
                            <div class="color-input">
                                <input type="color" value="#09A3E3" data-mode="light">
                                <input type="text" value="#09A3E3" data-mode="light">
                            </div>
                        </td>
                        <td>
                            <div class="color-input">
                                <input type="color" value="#29B6F6" data-mode="dark">
                                <input type="text" value="#29B6F6" data-mode="dark">
                            </div>
                        </td>
                        <td class="date-cell">2024-12-11</td>
                        <td class="date-cell">2024-12-11</td>
                        <td class="status-cell">
                            <span class="badge badge-baseline">Baseline</span>
                        </td>
                    </tr>
                    <!-- More colors... -->
                </tbody>
            </table>
        </div>
        
        <!-- Background Colors Section -->
        <!-- Text Colors Section -->
        <!-- UI Component Colors Section -->
        
        <!-- Export Section -->
        <div class="export-section">
            <h3>ğŸ“¥ Export Colors</h3>
            <div class="export-buttons">
                <button onclick="exportLightMode()">Export Light Mode XML</button>
                <button onclick="exportDarkMode()">Export Dark Mode XML</button>
                <button onclick="copyAllColors()">Copy All to Clipboard</button>
                <button onclick="copyPrompt()" class="btn-secondary">ğŸ“‹ Copy Prompt for AI</button>
            </div>
            <textarea id="export-output" readonly></textarea>
        </div>
    </div>
    
    <script>
        // JavaScript functions cho interactive editing
        
        // Sync color picker with text input
        document.querySelectorAll('input[type="color"]').forEach(input => {
            input.addEventListener('input', (e) => {
                const textInput = e.target.nextElementSibling;
                textInput.value = e.target.value.toUpperCase();
            });
        });
        
        // Sync text input with color picker
        document.querySelectorAll('input[type="text"]').forEach(input => {
            input.addEventListener('input', (e) => {
                const colorInput = e.target.previousElementSibling;
                if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
                    colorInput.value = e.target.value;
                }
            });
        });
        
        // Export Light Mode XML
        function exportLightMode() {
            const colors = [];
            document.querySelectorAll('tbody tr').forEach(row => {
                const name = row.dataset.name;
                const lightInput = row.querySelector('input[data-mode="light"][type="text"]');
                if (name && lightInput) {
                    colors.push(`    <color name="${name}">${lightInput.value}</color>`);
                }
            });
            
            const xml = `<?xml version="1.0" encoding="utf-8"?>
<resources>
${colors.join('\n')}
</resources>`;
            
            document.getElementById('export-output').value = xml;
        }
        
        // Export Dark Mode XML
        function exportDarkMode() {
            const colors = [];
            document.querySelectorAll('tbody tr').forEach(row => {
                const name = row.dataset.name;
                const darkInput = row.querySelector('input[data-mode="dark"][type="text"]');
                if (name && darkInput) {
                    colors.push(`    <color name="${name}">${darkInput.value}</color>`);
                }
            });
            
            const xml = `<?xml version="1.0" encoding="utf-8"?>
<resources>
${colors.join('\n')}
</resources>`;
            
            document.getElementById('export-output').value = xml;
        }
        
        // Copy to clipboard
        function copyAllColors() {
            const output = document.getElementById('export-output');
            output.select();
            document.execCommand('copy');
            alert('Copied to clipboard!');
        }
        
        // Copy prompt for AI to update colors in Android app
        function copyPrompt() {
            const appName = document.querySelector('h1').textContent.match(/- (.+) -/)[1];
            
            // Collect all edited colors
            const colors = [];
            document.querySelectorAll('tbody tr').forEach(row => {
                const name = row.dataset.name;
                const lightValue = row.querySelector('input[data-mode="light"][type="text"]').value;
                const darkValue = row.querySelector('input[data-mode="dark"][type="text"]').value;
                colors.push({ name, light: lightValue, dark: darkValue });
            });
            
            const prompt = `Update colors for ${appName} app:

1. Update these colors in values/colors*.xml (Light Mode):
${colors.map(c => `   - ${c.name}: ${c.light}`).join('\n')}

2. Update these colors in values-night/colors*.xml (Dark Mode):
${colors.map(c => `   - ${c.name}: ${c.dark}`).join('\n')}

3. Update theme.html: change input values to match new colors

Apply changes to Android project and theme.html file.`;
            
            navigator.clipboard.writeText(prompt).then(() => {
                alert('âœ… Prompt copied!\n\nPaste to AI to:\n- Update colors in XML files\n- Update input values in theme.html');
            });
        }
    </script>
</body>
</html>
```

### ğŸ¤– AI Workflow: Generate/Update theme.html

**Khi nÃ o cáº§n generate/update:**
1. Project má»›i - táº¡o láº§n Ä‘áº§u
2. ThÃªm color má»›i vÃ o resources
3. Rename color resources
4. User yÃªu cáº§u "update theme.html" hoáº·c "generate color editor"

**Steps Ä‘á»ƒ generate theme.html:**

```
Step 1: Scan all color files
    â”œâ”€ Read values/colors*.xml
    â”œâ”€ Read values-night/colors*.xml
    â””â”€ Parse all <color name="xxx">#RRGGBB</color>

Step 2: Group colors by category
    â”œâ”€ Brand: primary, primary_dark, primary_light
    â”œâ”€ Background: background_*, card_*, dialog_*
    â”œâ”€ Text: text_*, muted_text
    â””â”€ UI: button_*, error, warning, success, divider, badge_*, etc.

Step 3: Match Light & Dark mode values
    â”œâ”€ For each color in values/
    â”œâ”€ Find matching color in values-night/
    â””â”€ If not found in dark mode â†’ use light mode value

Step 4: Generate HTML structure
    â”œâ”€ Create table for each category
    â”œâ”€ Each row = 1 color with Light/Dark inputs
    â””â”€ Add interactive JavaScript

Step 5: Include export functions
    â”œâ”€ exportLightMode() â†’ XML for values/
    â”œâ”€ exportDarkMode() â†’ XML for values-night/
    â””â”€ copyAllColors() â†’ Copy to clipboard

Step 6: Save to docs/theme.html
```

**Command to run (if script exists):**
```bash
# Náº¿u cÃ³ Python script
python scripts/generate-theme-html.py

# Hoáº·c manual generation by AI
"Generate theme.html from color resources"
```

### Color Extraction Logic

**1. Parse XML colors:**
```javascript
// Regex to extract color names and values
const colorPattern = /<color name="([^"]+)">([^<]+)<\/color>/g;

// Example matches:
// <color name="primary">#09A3E3</color>
// â†’ name: "primary", value: "#09A3E3"
```

**2. Categorize by naming pattern:**
```javascript
function categorizeColor(name) {
    if (name.startsWith('primary')) return 'brand';
    if (name.includes('background') || name.includes('card')) return 'background';
    if (name.startsWith('text_') || name === 'muted_text') return 'text';
    return 'ui'; // button_, error, warning, divider, etc.
}
```

**3. Match Light/Dark pairs:**
```javascript
const lightColors = parseXML('values/colors*.xml');
const darkColors = parseXML('values-night/colors*.xml');

const pairs = lightColors.map(color => ({
    name: color.name,
    light: color.value,
    dark: darkColors.find(c => c.name === color.name)?.value || color.value
}));
```

### Usage Instructions (in HTML file)

ThÃªm section hÆ°á»›ng dáº«n trong HTML:

```html
<div class="instructions">
    <h3>ğŸ“– How to Use</h3>
    <ol>
        <li>Edit colors using color picker or hex input</li>
        <li>Changes sync automatically between picker and text</li>
        <li>Click "Export Light Mode XML" or "Export Dark Mode XML"</li>
        <li>Copy generated XML code</li>
        <li>Paste into <code>values/colors*.xml</code> or <code>values-night/colors*.xml</code></li>
        <li>Build and test app to verify colors</li>
    </ol>
    
    <h4>âš ï¸ Important Notes</h4>
    <ul>
        <li>Always define colors in BOTH Light and Dark mode</li>
        <li>Test color contrast for accessibility</li>
        <li>Keep similar color intensity across themes</li>
        <li>Use theme attributes in layouts: <code>?attr/colorPrimary</code></li>
    </ul>
</div>
```

### Example Output Format

**Export Light Mode XML:**
```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <!-- Brand Colors -->
    <color name="primary">#09A3E3</color>
    <color name="primary_dark">#0891CC</color>
    <color name="primary_light">#ACDEF2</color>
    
    <!-- Background Colors -->
    <color name="background_light">#FAFAFA</color>
    <color name="background_white">#FFFFFF</color>
    <color name="card_background">#FFFFFF</color>
    
    <!-- Text Colors -->
    <color name="text_primary">#212121</color>
    <color name="text_secondary">#333333</color>
    
    <!-- UI Component Colors -->
    <color name="button_danger">#F44336</color>
    <color name="divider">#E0E0E0</color>
</resources>
```

**Export Dark Mode XML:**
```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <!-- Brand Colors -->
    <color name="primary">#29B6F6</color>
    <color name="primary_dark">#0288D1</color>
    <color name="primary_light">#4FC3F7</color>
    
    <!-- Background Colors -->
    <color name="background_light">#121212</color>
    <color name="background_white">#1E1E1E</color>
    <color name="card_background">#2D2D2D</color>
    
    <!-- Text Colors -->
    <color name="text_primary">#FFFFFF</color>
    <color name="text_secondary">#E0E0E0</color>
    
    <!-- UI Component Colors -->
    <color name="button_danger">#F44336</color>
    <color name="divider">#424242</color>
</resources>
```

### File Location Requirements

```
âœ… CORRECT: docs/theme.html
âŒ WRONG: theme.html (in root)
âŒ WRONG: app/src/main/res/theme.html
âŒ WRONG: tools/theme.html
```

**LÃ½ do:** 
- `docs/` folder chá»©a documentation files
- KhÃ´ng commit vÃ o `app/src/` (khÃ´ng pháº£i source code)
- Consistent vá»›i `docs/BUILD_GUIDE.md`, `docs/SETUP_GUIDE.md`

### Maintenance

**Khi cáº§n update theme.html:**
1. New colors added â†’ Re-generate Ä‘á»ƒ include new colors
2. Colors renamed â†’ Update color names in HTML
3. Categories changed â†’ Re-organize sections
4. Theme values changed â†’ Update default values in HTML

**AI Command:**
```
"Update docs/theme.html with latest colors from resources"
"Generate theme.html for this project"
"Add new color [color_name] to theme editor"
```

### Integration vá»›i Java Code

Náº¿u cáº§n generate programmatically, cÃ³ thá»ƒ táº¡o utility:

```java
// ColorExtractor.java (optional - for automation)
public class ColorExtractor {
    public static void generateThemeHTML(Context context) {
        // Parse colors from resources
        // Generate HTML file
        // Save to docs/theme.html
    }
}
```

NhÆ°ng thÆ°á»ng **manual generation by AI** lÃ  Ä‘á»§ vÃ¬:
- Colors khÃ´ng thay Ä‘á»•i thÆ°á»ng xuyÃªn
- AI cÃ³ thá»ƒ re-generate nhanh khi cáº§n
- KhÃ´ng cáº§n thÃªm code complexity

---
   - Strings â†’ `strings_dialog.xml`, `strings_alarm.xml`, `strings_app.xml`...
   - Dimens â†’ `dimens_text.xml`, `dimens_spacing.xml`
   - Styles â†’ `styles_text.xml`, `styles_button.xml`

10. **Database naming consistency**: 
    - **Báº®T BUá»˜C** sá»­ dá»¥ng Ä‘Ãºng tÃªn database trong export/import
    - Sá»­ dá»¥ng constant tá»« DatabaseHelper: `DatabaseHelper.DATABASE_NAME`
    - KHÃ”NG hardcode tÃªn database khÃ¡c trong code export/import
    - Verify: `getDatabasePath()` PHáº¢I dÃ¹ng chÃ­nh xÃ¡c tÃªn database

11. **Naming consistency**: Giá»¯ consistent vá»›i naming Ä‘Ã£ cÃ³ trong project. Äá»c existing code trÆ°á»›c khi Ä‘áº·t tÃªn má»›i.

12. **Fragment Communication & Data Refresh (Báº®T BUá»˜C)**:
    
    **Váº¥n Ä‘á»:** Khi thÃªm/sá»­a/xÃ³a data á»Ÿ Fragment A (VD: MainAddBlock), quay láº¡i Fragment B (VD: MainList) thÃ¬ list KHÃ”NG tá»± Ä‘á»™ng refresh.
    
    **NguyÃªn nhÃ¢n:** Fragment lifecycle - `onCreateView()` chá»‰ cháº¡y láº§n Ä‘áº§u, khÃ´ng cháº¡y láº¡i khi navigate back.
    
    **âœ… GIáº¢I PHÃP Báº®T BUá»˜C - Pattern chuáº©n:**
    
    **A. Trong MainActivity (Communication Hub):**
    ```java
    public class MainActivity extends AppCompatActivity {
        private boolean needsListRefresh = false;  // Flag Ä‘á»ƒ track data changes
        
        // Public method cho fragments gá»i khi cÃ³ data change
        public void markDataChanged() {
            needsListRefresh = true;
        }
        
        // Public method Ä‘á»ƒ navigate vÃ  trigger refresh
        public void switchToListFragment() {
            // Create new instance Ä‘á»ƒ force refresh
            MainList listFragment = new MainList();
            
            getSupportFragmentManager()
                .beginTransaction()
                .replace(R.id.fragmentContainer, listFragment)
                .commit();
            
            // Select trong bottom nav
            bottomNavigation.setSelectedItemId(R.id.nav_list);
        }
        
        // Hoáº·c dÃ¹ng bottom navigation listener
        bottomNavigation.setOnItemSelectedListener(item -> {
            Fragment fragment = null;
            int itemId = item.getItemId();
            
            if (itemId == R.id.nav_list) {
                fragment = new MainList();
                // Reset flag khi vÃ o list
                needsListRefresh = false;
            }
            // ... other fragments
            
            if (fragment != null) {
                loadFragment(fragment);
                return true;
            }
            return false;
        });
    }
    ```
    
    **B. Trong Fragment thay Ä‘á»•i data (VD: MainAddBlock, dialog add/edit):**
    ```java
    public class MainAddBlock extends Fragment {
        
        private void addBlockedNumber() {
            // ... add logic
            databaseHelper.insert(blockedNumber);
            
            // âœ… Báº®T BUá»˜C: Notify MainActivity cÃ³ data change
            if (getActivity() instanceof MainActivity) {
                ((MainActivity) getActivity()).markDataChanged();
            }
            
            // Optional: Auto switch to list after add
            if (getActivity() instanceof MainActivity) {
                ((MainActivity) getActivity()).switchToListFragment();
            }
            
            Toast.makeText(getContext(), R.string.blocked_number_added, 
                Toast.LENGTH_SHORT).show();
        }
    }
    ```
    
    **C. Trong Fragment hiá»ƒn thá»‹ list:**
    ```java
    public class MainList extends Fragment {
        private RecyclerView recyclerView;
        private BlockedNumberAdapter adapter;
        private List<BlockedNumber> blockedNumbers;
        
        @Override
        public View onCreateView(...) {
            View view = inflater.inflate(R.layout.main_list, container, false);
            
            recyclerView = view.findViewById(R.id.recyclerView);
            
            // âœ… Setup RecyclerView
            adapter = new BlockedNumberAdapter(blockedNumbers, this::onItemClick);
            recyclerView.setAdapter(adapter);
            
            // âœ… Load data
            loadBlockedNumbers();
            
            return view;
        }
        
        @Override
        public void onResume() {
            super.onResume();
            // âœ… LUÃ”N refresh khi fragment resume
            // Äáº£m báº£o data má»›i nháº¥t khi quay láº¡i
            loadBlockedNumbers();
        }
        
        private void loadBlockedNumbers() {
            blockedNumbers = databaseHelper.getAllBlockedNumbers();
            adapter.updateData(blockedNumbers);
            
            // Optional: Show empty state
            if (blockedNumbers.isEmpty()) {
                tvEmpty.setVisibility(View.VISIBLE);
                recyclerView.setVisibility(View.GONE);
            } else {
                tvEmpty.setVisibility(View.GONE);
                recyclerView.setVisibility(View.VISIBLE);
            }
        }
        
        // Method cho adapter gá»i khi xÃ³a item
        public void onItemDeleted() {
            loadBlockedNumbers();  // Refresh sau khi xÃ³a
        }
    }
    ```
    
    **D. Trong Adapter khi xÃ³a item:**
    ```java
    public class BlockedNumberAdapter extends RecyclerView.Adapter {
        
        private void deleteItem(int position) {
            BlockedNumber item = blockedNumbers.get(position);
            
            // Delete from database
            databaseHelper.delete(item.getId());
            
            // Update list
            blockedNumbers.remove(position);
            notifyItemRemoved(position);
            notifyItemRangeChanged(position, blockedNumbers.size());
            
            // âœ… Notify fragment to refresh if needed
            if (fragment != null) {
                fragment.onItemDeleted();
            }
            
            Toast.makeText(context, R.string.deleted, Toast.LENGTH_SHORT).show();
        }
    }
    ```
    
    **E. Trong Dialog khi add/edit:**
    ```java
    public class AddBlockDialog extends DialogFragment {
        
        private void saveAndDismiss() {
            // Save to database
            databaseHelper.insert(blockedNumber);
            
            // âœ… Notify activity cÃ³ data change
            if (getActivity() instanceof MainActivity) {
                ((MainActivity) getActivity()).markDataChanged();
            }
            
            dismiss();
        }
    }
    ```
    
    **ğŸ“‹ CHECKLIST - AI pháº£i verify:**
    
    | Check | Location | Code Pattern |
    |-------|----------|--------------|
    | âœ… Flag tracking | MainActivity | `boolean needsListRefresh = false;` |
    | âœ… Mark method | MainActivity | `markDataChanged()` public method |
    | âœ… Call mark after insert | Fragment/Dialog | `((MainActivity) getActivity()).markDataChanged()` |
    | âœ… Call mark after update | Fragment/Dialog | `((MainActivity) getActivity()).markDataChanged()` |
    | âœ… Call mark after delete | Adapter | `((MainActivity) getActivity()).markDataChanged()` |
    | âœ… Refresh in onResume | List Fragment | `loadData()` in `onResume()` |
    | âœ… Adapter update method | Adapter | `updateData(List<T> newData)` + `notifyDataSetChanged()` |
    | âœ… Empty state handling | List Fragment | Show/hide empty view |
    
    **âš ï¸ COMMON MISTAKES (TrÃ¡nh):**
    ```java
    // âŒ WRONG: Chá»‰ load trong onCreateView
    @Override
    public View onCreateView(...) {
        loadData();  // Chá»‰ cháº¡y 1 láº§n
        return view;
    }
    
    // âœ… CORRECT: Load cáº£ trong onResume
    @Override
    public void onResume() {
        super.onResume();
        loadData();  // Cháº¡y má»—i khi quay láº¡i
    }
    
    // âŒ WRONG: KhÃ´ng notify sau khi thay Ä‘á»•i data
    databaseHelper.insert(item);
    // QuÃªn call markDataChanged()
    
    // âœ… CORRECT: LuÃ´n notify
    databaseHelper.insert(item);
    ((MainActivity) getActivity()).markDataChanged();
    
    // âŒ WRONG: Adapter khÃ´ng cÃ³ update method
    adapter = new Adapter(oldList);
    // KhÃ´ng cÃ³ cÃ¡ch update
    
    // âœ… CORRECT: CÃ³ update method
    adapter.updateData(newList);
    ```
    
    **ğŸ¯ KHI NÃ€O ÃP Dá»¤NG:**
    - âœ… App cÃ³ bottom navigation vá»›i multiple fragments
    - âœ… Fragment A thÃªm/sá»­a/xÃ³a data
    - âœ… Fragment B hiá»ƒn thá»‹ danh sÃ¡ch data Ä‘Ã³
    - âœ… Cáº§n real-time sync giá»¯a cÃ¡c screens
    - âœ… User expect data má»›i nháº¥t khi quay láº¡i mÃ n hÃ¬nh
    
    **Alternative Pattern (cho simple cases):**
    ```java
    // Náº¿u chá»‰ cÃ³ 1 list fragment, cÃ³ thá»ƒ dÃ¹ng onResume Ä‘Æ¡n giáº£n:
    @Override
    public void onResume() {
        super.onResume();
        refreshList();
    }
    ```

### File Splitting - Quy trÃ¬nh cho AI

**LUÃ”N SPLIT** Ä‘á»ƒ clean architecture, khÃ´ng phá»¥ thuá»™c sá»‘ lÆ°á»£ng items.

```
1. Äá»ŒC FILE: XÃ¡c Ä‘á»‹nh cÃ¡c prefix/nhÃ³m semantic
2. Táº O FILES Má»šI theo category:
   - colors â†’ colors_brand.xml, colors_text.xml, colors_ui.xml
   - dimens â†’ dimens_text.xml, dimens_spacing.xml
   - strings â†’ strings_[feature].xml (alarm, dialog, profile...)
   - styles â†’ styles_shared.xml, styles_button.xml, styles_dialog.xml
3. DI CHUYá»‚N items vÃ o file phÃ¹ há»£p
4. FILE Gá»C giá»¯ items misc/chung
5. BUILD VERIFY
6. Cáº¬P NHáº¬T values-vi/ náº¿u lÃ  strings
```

### Khi nÃ o cáº§n há»i láº¡i user?

- KhÃ´ng cháº¯c file nÃ o lÃ  legacy/deprecated
- Project structure khÃ¡c vá»›i standard
- KhÃ´ng tÃ¬m tháº¥y Utils class Ä‘Ã£ cÃ³
- Cáº§n táº¡o nhiá»u files má»›i cho feature lá»›n

---

*Last updated: December 2024*
